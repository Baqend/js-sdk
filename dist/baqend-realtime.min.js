/*! baqend 2.12.3 | Copyright (c) 2015 Baqend GmbH | MIT */

!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.DB=a()}}(function(){var a,b={};return b.typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},b.classCallCheck=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},b.createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),b.defaults=function(a,b){for(var c=Object.getOwnPropertyNames(b),d=0;d<c.length;d++){var e=c[d],f=Object.getOwnPropertyDescriptor(b,e);f&&f.configurable&&void 0===a[e]&&Object.defineProperty(a,e,f)}return a},b.inherits=function(a,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):b.defaults(a,c))},b.possibleConstructorReturn=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b},function(){function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){return e(b[g][1][a]||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}return a}()({1:[function(a,c,d){"use strict";var e=a(68),f=function(){function a(c){b.classCallCheck(this,a),this.read=new e(c),this.write=new e(c)}return a.prototype.clear=function(){this.read.clear(),this.write.clear()},a.prototype.copy=function(a){return this.read.copy(a.read),this.write.copy(a.write),this},a.prototype.isPublicReadAllowed=function(){return this.read.isPublicAllowed()},a.prototype.setPublicReadAllowed=function(){return this.read.setPublicAllowed()},a.prototype.isReadAllowed=function(a){return this.read.isAllowed(a)},a.prototype.isReadDenied=function(a){return this.read.isDenied(a)},a.prototype.allowReadAccess=function(a){return e.prototype.allowAccess.apply(this.read,arguments),this},a.prototype.denyReadAccess=function(a){return e.prototype.denyAccess.apply(this.read,arguments),this},a.prototype.deleteReadAccess=function(a){return e.prototype.deleteAccess.apply(this.read,arguments),this},a.prototype.isPublicWriteAllowed=function(){return this.write.isPublicAllowed()},a.prototype.setPublicWriteAllowed=function(){return this.write.setPublicAllowed()},a.prototype.isWriteAllowed=function(a){return this.write.isAllowed(a)},a.prototype.isWriteDenied=function(a){return this.write.isDenied(a)},a.prototype.allowWriteAccess=function(a){return e.prototype.allowAccess.apply(this.write,arguments),this},a.prototype.denyWriteAccess=function(a){return e.prototype.denyAccess.apply(this.write,arguments),this},a.prototype.deleteWriteAccess=function(a){return e.prototype.deleteAccess.apply(this.write,arguments),this},a.prototype.toJSON=function(){return{read:this.read.toJSON(),write:this.write.toJSON()}},a.prototype.fromJSON=function(a){this.read.fromJSON(a.read||{}),this.write.fromJSON(a.write||{})},a}();c.exports=f},{68:68}],2:[function(a,c,d){"use strict";var e=a(35),f=a(33),g=a(20),h=a(75),i=a(62),j=a(19),k=a(4),l=a(66),m=a(25),n=a(21),o=m.StatusCode,p=function(a){function c(d){b.classCallCheck(this,c);var e=b.possibleConstructorReturn(this,a.call(this));return e.log=h.Logger.create(e),e._connector=null,e._entities=null,e.entityManagerFactory=d,e.metamodel=d.metamodel,e.code=d.code,e.modules=null,e.me=null,e.deviceMe=null,e.tokenStorage=null,e.bloomFilter=null,e.cacheWhiteList=null,e.cacheBlackList=null,e.bloomFilterRefresh=60,e._bloomFilterLock=new h.Lockable,e}return b.inherits(c,a),b.createClass(c,[{key:"isOpen",get:function(){return!!this._connector}},{key:"token",get:function(){return this.tokenStorage.token},set:function(a){this.tokenStorage.update(a)}},{key:"isCachingDisabled",get:function(){return!this.bloomFilter}},{key:"isDeviceRegistered",get:function(){return!!this.deviceMe}}]),c.prototype.connected=function(a,b,c){this._connector=a,this.tokenStorage=c,this.bloomFilterRefresh=this.entityManagerFactory.staleness,this._entities={},this.File=g.FileFactory.create(this),this._createObjectFactory(this.metamodel.embeddables),this._createObjectFactory(this.metamodel.entities),this.transaction=new k(this),this.modules=new h.Modules(this,a),b&&(b.device&&this.updateDevice(b.device),b.user&&c.token&&this._updateUser(b.user,!0),this.bloomFilterRefresh>0&&b.bloomFilter&&h.atob&&!h.isNode&&this.updateBloomFilter(b.bloomFilter))},c.prototype._createObjectFactory=function(a){var b=this;Object.keys(a).forEach(function(a){var c=b.metamodel.managedType(a),d=c.name;b[d]?(c.typeConstructor=b[d],Object.defineProperty(b,d,{value:c.createObjectFactory(b)})):Object.defineProperty(b,d,{get:function(){return Object.defineProperty(this,d,{value:c.createObjectFactory(this)}),this[d]},set:function(a){c.typeConstructor=a},configurable:!0})},this)},c.prototype.send=function(a,b){var c=this;a.tokenStorage=this.tokenStorage;var d=this._connector.send(a);return b||(d=d.catch(function(a){throw a.status==o.BAD_CREDENTIALS&&c._logout(),a})),d},c.prototype.getReference=function(a,b){var c=void 0,d=void 0;b?(d=this.metamodel.entity(a),c=0==b.indexOf("/db/")?b:d.ref+"/"+encodeURIComponent(b)):"string"==typeof a?(c=a,d=this.metamodel.entity(c.substring(0,c.indexOf("/",4)))):d=this.metamodel.entity(a);var e=this._entities[c];if(!e){e=d.create();var f=l.get(e);c&&(f.id=c),f.setUnavailable(),this._attach(e)}return e},c.prototype.createQueryBuilder=function(a){return new i.Builder(this,a)},c.prototype.clear=function(){this._entities={}},c.prototype.close=function(){return this._connector=null,this.clear()},c.prototype.contains=function(a){return!!a&&this._entities[a.id]===a},c.prototype.containsById=function(a){return!(!a||!this._entities[a.id])},c.prototype.detach=function(a){var b=this;return l.get(a).withLock(function(){return b.removeReference(a),Promise.resolve(a)})},c.prototype.resolveDepth=function(a,b){var c=this;if(!b||!b.depth)return Promise.resolve(a);b.resolved=b.resolved||[];var d=[],e=Object.assign({},b,{depth:!0===b.depth||b.depth-1});return this.getSubEntities(a,1).forEach(function(a){null==a||~b.resolved.indexOf(a)||(b.resolved.push(a),d.push(c.load(a.id,null,e)))}),Promise.all(d).then(function(){return a})},c.prototype.load=function(a,b,c){var d=this;c=c||{};var f=this.getReference(a,b),g=l.get(f);if(!c.refresh&&c.local&&g.isAvailable)return this.resolveDepth(f,c);var h=new e.GetObject(g.bucket,g.key);return this.ensureCacheHeader(f.id,h,c.refresh),this.send(h).then(function(e){return f.version>e.entity.version?(c.refresh=!0,d.load(a,b,c)):(d.addToWhiteList(e.entity.id),e.status!=o.NOT_MODIFIED&&g.setJson(e.entity,{persisting:!0}),d.resolveDepth(f,c))},function(a){if(a.status==o.OBJECT_NOT_FOUND)return d.removeReference(f),g.setRemoved(),null;throw a})},c.prototype.insert=function(a,b){var c=this;b=b||{};var d=void 0;return this._save(a,b,function(a,b){if(a.version)throw new f.PersistentError("Existing objects can't be inserted.");return d=!a.id,new e.CreateObject(a.bucket,b)}).then(function(b){return d&&c._attach(a),b})},c.prototype.update=function(a,b){return b=b||{},this._save(a,b,function(a,c){if(!a.version)throw new f.PersistentError("New objects can't be inserted.");return b.force?(delete c.version,new e.ReplaceObject(a.bucket,a.key,c).ifMatch("*")):new e.ReplaceObject(a.bucket,a.key,c).ifMatch(a.version)})},c.prototype.save=function(a,b,c){b=b||{};var d=function(a,c){if(b.force){if(!a.id)throw new f.PersistentError("New special objects can't be forcedly saved.");return delete c.version,new e.ReplaceObject(a.bucket,a.key,c)}return a.version?new e.ReplaceObject(a.bucket,a.key,c).ifMatch(a.version):new e.CreateObject(a.bucket,c)};return c?this._locklessSave(a,b,d):this._save(a,b,d)},c.prototype.optimisticSave=function(a,b){var c=this;return l.get(a).withLock(function(){return c._optimisticSave(a,b)})},c.prototype._optimisticSave=function(a,b){var c=this,d=!1,e=function(){d=!0},f=Promise.resolve(b(a,e));return d?Promise.resolve(a):f.then(function(){return c.save(a,{},!0).catch(function(d){if(412==d.status)return c.refresh(a,{}).then(function(){return c._optimisticSave(a,b)});throw d})})},c.prototype._locklessSave=function(a,b,c){var d=this;this.attach(a);var e=l.get(a),f=void 0,g=void 0;if(e.isAvailable&&(g=e.getJson({persisting:!0})),e.isDirty){b.refresh||e.setPersistent();var h=this.send(c(e,g)).then(function(c){return e.setJson(c.entity,{persisting:b.refresh,onlyMetadata:!b.refresh}),a},function(b){if(b.status==o.OBJECT_NOT_FOUND)return d.removeReference(a),e.setRemoved(),null;throw e.setDirty(),b});f=[h]}else f=[Promise.resolve(a)];var i=Object.assign({},b);return i.depth=0,this.getSubEntities(a,b.depth).forEach(function(a){f.push(d._save(a,i,c))}),Promise.all(f).then(function(){return a})},c.prototype._save=function(a,b,c){var d=this;this.ensureBloomFilterFreshness();var e=l.get(a);return e.version&&this.addToBlackList(a.id),e.withLock(function(){return d._locklessSave(a,b,c)})},c.prototype.getSubEntities=function(a,b,c,d){var e=this;if(c=c||[],!b)return c;d=d||a;for(var f=l.get(a),g=f.type.references(),h=Array.isArray(g),i=0,g=h?g:g[Symbol.iterator]();;){var j;if(h){if(i>=g.length)break;j=g[i++]}else{if(i=g.next(),i.done)break;j=i.value}var k=j;this.getSubEntitiesByPath(a,k.path).forEach(function(a){~c.indexOf(a)||a==d||(c.push(a),c=e.getSubEntities(a,!0===b?b:b-1,c,d))})}return c},c.prototype.getSubEntitiesByPath=function(a,b){var c=this,d=[a];return b.forEach(function(a){var b=[];d.forEach(function(d){var e=d[a];if(e){var f=c.metamodel.managedType(d.constructor).getAttribute(a);if(f.isCollection)for(var g=e.entries(),h=Array.isArray(g),i=0,g=h?g:g[Symbol.iterator]();;){var j;if(h){if(i>=g.length)break;j=g[i++]}else{if(i=g.next(),i.done)break;j=i.value}var k=j;b.push(k[1]),f.keyType&&f.keyType.isEntity&&b.push(k[0])}else b.push(e)}}),d=b}),d},c.prototype.delete=function(a,b){var c=this;b=b||{},this.attach(a);var d=l.get(a);return d.withLock(function(){if(!d.version&&!b.force)throw new f.IllegalEntityError(a);var g=new e.DeleteObject(d.bucket,d.key);c.addToBlackList(a.id),b.force||g.ifMatch(d.version);var h=[c.send(g).then(function(){return c.removeReference(a),d.setRemoved(),a})],i=Object.assign({},b);return i.depth=0,c.getSubEntities(a,b.depth).forEach(function(a){h.push(c.delete(a,i))}),Promise.all(h).then(function(){return a})})},c.prototype.flush=function(a,b){},c.prototype.persist=function(a){this.attach(a)},c.prototype.refresh=function(a,b){return b=b||{},b.refresh=!0,this.load(a.id,null,b)},c.prototype.attach=function(a){if(!this.contains(a)){if(!this.metamodel.entity(a.constructor))throw new f.IllegalEntityError(a);if(this.containsById(a))throw new f.EntityExistsError(a);this._attach(a)}},c.prototype._attach=function(a){var b=l.get(a);if(b.isAttached){if(b.db!=this)throw new f.EntityExistsError(a)}else b.db=this;b.id||"User"!=b.type.name&&"Role"!=b.type.name&&"logs.AppLog"!=b.type.name&&(b.id="/db/"+b.type.name+"/"+h.uuid()),b.id&&(this._entities[b.id]=a)},c.prototype.removeReference=function(a){var b=l.get(a);if(!b)throw new f.IllegalEntityError(a);delete this._entities[b.id]},c.prototype.register=function(a,b,c){var d=this,g=c>j.LoginOption.NO_LOGIN;if(this.me&&g)throw new f.PersistentError("User is already logged in.");return this.withLock(function(){var f=new e.Register({user:a,password:b,login:g});return d._userRequest(f,c)})},c.prototype.login=function(a,b,c){var d=this;if(this.me)throw new f.PersistentError("User is already logged in.");return this.withLock(function(){var f=new e.Login({username:a,password:b});return d._userRequest(f,c)})},c.prototype.logout=function(){var a=this;return this.withLock(function(){return a.send(new e.Logout).then(a._logout.bind(a))})},c.prototype.loginWithOAuth=function(a,b,c){if(this.me)throw new f.PersistentError("User is already logged in.");c=Object.assign({title:"Login with "+a,timeout:3e5,state:{},loginOption:!0},c),c.redirect&&Object.assign(c.state,{redirect:c.redirect,loginOption:c.loginOption});var d=void 0;if(!m[a+"OAuth"])throw new Error("OAuth provider "+a+" not supported.");if(d=new m[a+"OAuth"](b,c.scope,JSON.stringify(c.state)),d.addRedirectOrigin(this._connector.origin+this._connector.basePath),c.redirect){return-1!=document.URL.indexOf("http://")||-1!=document.URL.indexOf("https://")?open(d.request.path,"_self"):open(d.request.path,"_system"),new Promise(function(a){})}var e=this._userRequest(d,c.loginOption);open(d.request.path,c.title,"width="+c.width+",height="+c.height);return new Promise(function(a,b){var d=setTimeout(function(){b(new f.PersistentError("OAuth login timeout."))},c.timeout);e.then(a,b).then(function(){clearTimeout(d)})})},c.prototype.renew=function(a){var b=this;return this.withLock(function(){var c=new e.Me;return b._userRequest(c,a)})},c.prototype.newPassword=function(a,b,c){var d=this;return this.withLock(function(){var f=new e.NewPassword({username:a,password:b,newPassword:c});return d.send(f,!0).then(function(a){return d._updateUser(a.entity)})})},c.prototype.newPasswordWithToken=function(a,b,c){var d=this;return this.withLock(function(){return d._userRequest(new e.NewPassword({token:a,newPassword:b}),c)})},c.prototype.resetPassword=function(a){return this.send(new e.ResetPassword({username:a}))},c.prototype.changeUsername=function(a,b,c){return this.send(new e.ChangeUsername({username:a,newUsername:b,password:c}))},c.prototype._updateUser=function(a,b){var c=this.getReference(a.id);return l.get(c).setJson(a,{persisting:!0}),b&&(this.me=c),c},c.prototype._logout=function(){this.me=null,this.token=null},c.prototype._userRequest=function(a,b){var c=this;void 0===b&&(b=!0);var d=b>j.LoginOption.NO_LOGIN;return d&&(this.tokenStorage.temporary=b<j.LoginOption.PERSIST_LOGIN),this.send(a,!d).then(function(a){if(a.entity)return c._updateUser(a.entity,d)},function(a){if(a.status==o.OBJECT_NOT_FOUND)return d&&c._logout(),null;throw a})},c.prototype.registerDevice=function(a,b,c){var d=this,f=new e.DeviceRegister({subscription:b,device:c,devicetype:a});return f.withCredentials=!0,this.send(f).then(function(a){return d.updateDevice(a.entity)})},c.prototype.updateDevice=function(a){var b=this.getReference(a.id);return l.get(b).setJson(a,{persisting:!0}),this.deviceMe=b,b},c.prototype.checkDeviceRegistration=function(){var a=this;return this.send(new e.DeviceRegistered).then(function(){return a.isDeviceRegistered=!0},function(b){if(b.status==o.OBJECT_NOT_FOUND)return a.isDeviceRegistered=!1;throw b})},c.prototype.pushDevice=function(a){return this.send(new e.DevicePush(a))},c.prototype.validate=function(a){for(var b=l.get(a).type,c=new h.ValidationResult,d=b.attributes(),e=void 0;!(e=d.next()).done;){var f=new h.Validator(e.value.name,a);c.fields[f.key]=f}var g=b.validationCode;return g&&g(c.fields),c},c.prototype.addToWhiteList=function(a){this.isCachingDisabled||(this.bloomFilter.contains(a)&&this.cacheWhiteList.add(a),this.cacheBlackList.delete(a))},c.prototype.addToBlackList=function(a){this.isCachingDisabled||(this.bloomFilter.contains(a)||this.cacheBlackList.add(a),this.cacheWhiteList.delete(a))},c.prototype.refreshBloomFilter=function(){var a=this;if(this.isCachingDisabled)return Promise.resolve();var b=new e.GetBloomFilter;return b.noCache(),this.send(b).then(function(b){return a.updateBloomFilter(b.entity),a.bloomFilter})},c.prototype.updateBloomFilter=function(a){this.bloomFilter=new n(a),this.cacheWhiteList=new Set,this.cacheBlackList=new Set},c.prototype.ensureBloomFilterFreshness=function(){var a=this;if(!this.isCachingDisabled){var b=(new Date).getTime(),c=1e3*this.bloomFilterRefresh;this._bloomFilterLock.isReady&&b-this.bloomFilter.creation>c&&this._bloomFilterLock.withLock(function(){return a.refreshBloomFilter()})}},c.prototype.mustRevalidate=function(a){if(h.isNode)return!1;this.ensureBloomFilterFreshness();var b=this.isCachingDisabled||!this._bloomFilterLock.isReady;return b=b||!this.cacheWhiteList.has(a)&&(this.cacheBlackList.has(a)||this.bloomFilter.contains(a))},c.prototype.ensureCacheHeader=function(a,b,c){(c=c||this.mustRevalidate(a))&&b.noCache()},c.prototype.createURL=function(a,b){var c=this._connector.basePath+a,d=!1;return b&&this.me?(c=this.tokenStorage.signPath(c),d=!0):c=c.split("/").map(encodeURIComponent).join("/"),this.mustRevalidate(a)&&(c=c+(d?"&":"?")+"BCB"),this._connector.origin+c},c.prototype.requestAPIToken=function(a,b){var c=this._getUserReference(a,b),d=new e.UserToken(c.key);return this.send(d).then(function(a){return a.entity})},c.prototype.revokeAllTokens=function(a,b){var c=this._getUserReference(a,b),d=new e.RevokeUserToken(c.key);return this.send(d)},c.prototype._getUserReference=function(a,b){return"string"==typeof b?this.getReference(a,b):b},c}(h.Lockable);p.prototype.List=Array,p.prototype.Set=Set,p.prototype.Map=Map,p.prototype.GeoPoint=a(5),c.exports=p},{19:19,20:20,21:21,25:25,33:33,35:35,4:4,5:5,62:62,66:66,75:75}],3:[function(a,c,d){"use strict";var e=a(35),f=a(51),g=a(75),h=(a(22),a(23)),i=a(2),j=function(a){function c(d){b.classCallCheck(this,c);var f=b.possibleConstructorReturn(this,a.call(this));d=Object(d)instanceof String?{host:d}:d||{},f._connector=null,f.metamodel=f.createMetamodel(),f.code=new g.Code(f.metamodel,f),f.tokenStorageFactory=g.TokenStorage.WEB_STORAGE||g.TokenStorage.GLOBAL,f.configure(d);var h=!0,i=new Promise(function(a){f._connected=a});return d.host?f.connect(d.host,d.port,d.secure,d.basePath):h=!1,f.tokenStorage||(h=!1,i=i.then(function(){return f.tokenStorageFactory.create(f._connector.origin)}).then(function(a){f.tokenStorage=a})),d.schema?(f._connectData=d,f.metamodel.init(d.schema)):(h=!1,i=i.then(function(){var a=new e.Connect;return a.withCredentials=!0,0===f.staleness&&a.noCache(),f.send(a)}).then(function(a){f._connectData=a.entity,void 0===f.staleness&&(f.staleness=f._connectData.bloomFilterRefresh||60),f.metamodel.isInitialized||f.metamodel.init(f._connectData.schema),f.tokenStorage.update(f._connectData.token)})),h||f.withLock(function(){return i},!0),f}return b.inherits(c,a),c.prototype._connected=function(){},c.prototype.configure=function(a){if(this._connector)throw new Error("The EntityManagerFactory can only be configured before is is connected.");a.tokenStorage&&(this.tokenStorage=a.tokenStorage),a.tokenStorageFactory&&(this.tokenStorageFactory=a.tokenStorageFactory),void 0!==a.staleness&&(this.staleness=a.staleness)},c.prototype.connect=function(a,b,c,d){if(this._connector)throw new Error("The EntityManagerFactory is already connected.");return Object(b)instanceof Boolean&&(c=b,b=0),this._connector=h.create(a,b,c,d),this._connected(),this.ready()},c.prototype.createMetamodel=function(){return new f.Metamodel(this)},c.prototype.createEntityManager=function(a){var b=this,c=new i(this);return this.isReady?c.connected(this._connector,this._connectData,a?this.tokenStorage:new g.TokenStorage(this._connector.origin)):c.withLock(function(){return b.ready().then(function(){c.connected(b._connector,b._connectData,a?b.tokenStorage:new g.TokenStorage(b._connector.origin))})},!0),c},c.prototype.send=function(a){return a.tokenStorage||(a.tokenStorage=this.tokenStorage),this._connector.send(a)},c}(g.Lockable);c.exports=j},{2:2,22:22,23:23,35:35,51:51,75:75}],4:[function(a,c,d){"use strict";var e=a(35),f=a(33),g=function(){function a(c){b.classCallCheck(this,a),this._connector=c.connector,this.entityManager=c,this.tid=null,this.rollbackOnly=!1,this.readSet=null,this.changeSet=null}return b.createClass(a,[{key:"isActive",get:function(){return Boolean(this.tid)}}]),a.prototype.begin=function(a,b){return this.yield().then(function(){var a=this.send(new e.PostTransaction).done(function(a){this.tid=a.tid,this.rollbackOnly=!1,this.readSet={},this.changeSet={}});return this.wait(a)}).then(a,b)},a.prototype.commit=function(a,b){return this.yield().then(function(){return this.getRollbackOnly()?this.rollback().then(function(){throw new f.RollbackError}):this.wait(this.entityManager.flush()).then(function(){var a=[];for(var b in this.readSet)a.push({oid:b,version:this.readSet[b]});var c=this.send(new e.PutTransactionCommitted(this.tid,a));return this.wait(c).then(function(a){this.tid=null,this.readSet=null,this.changeSet=null;var b=a.oids;for(var c in b){var d=b[c],e=this.entityManager.entities[c];if(e){var f=util.Metadata.get(e);"DELETED"==d||f.isDeleted?this.entityManager.removeReference(e):f.setJsonValue(f.type.version,d)}}})})}).then(a,b)},a.prototype.getRollbackOnly=function(){return this.rollbackOnly},a.prototype.rollback=function(a,b){return this.yield().then(function(){var a=this.send(new e.PutTransactionAborted(this.tid));this.wait(a).then(function(){return this.tid=null,this.readSet=null,this.changeSet=null,this.entityManager.clear()},function(){return this.entityManager.clear()})}).then(a,b)},a.prototype.setRollbackOnly=function(a,b){return this.yield().done(function(){this.rollbackOnly=!0})},a.prototype.isRead=function(a){return this.isActive&&a in this.readSet},a.prototype.setRead=function(a,b){this.isActive&&!this.isChanged(a)&&(this.readSet[a]=b)},a.prototype.isChanged=function(a){return this.isActive&&a in this.changeSet},a.prototype.setChanged=function(a){this.isActive&&(delete this.readSet[a],this.changeSet[a]=!0)},a}();c.exports=g},{33:33,35:35}],5:[function(a,c,d){"use strict";var e=function(){function a(c,d){b.classCallCheck(this,a);var e=void 0,f=void 0;if(Object(c)instanceof String){var g=c.indexOf(";");e=c.substring(0,g),f=c.substring(g+1)}else Object(c)instanceof Number?(e=c,f=d):Object(c)instanceof Array?(e=c[0],f=c[1]):c instanceof Object?(e=c.latitude,f=c.longitude):(e=0,f=0);if(this.longitude=f,this.latitude=e,this.latitude<-90||this.latitude>90)throw new Error("Latitude "+this.latitude+" is not in bound of -90 <= latitude <= 90");if(this.longitude<-180||this.longitude>180)throw new Error("Longitude "+this.longitude+" is not in bound of -180 <= longitude <= 180")}return a.current=function(){return new Promise(function(b,c){navigator.geolocation.getCurrentPosition(function(c){b(new a(c.coords.latitude,c.coords.longitude))},function(a){c(a)})})},a.prototype.kilometersTo=function(b){return Number((a.EARTH_RADIUS_IN_KILOMETERS*this.radiansTo(b)).toFixed(3))},a.prototype.milesTo=function(b){return Number((a.EARTH_RADIUS_IN_MILES*this.radiansTo(b)).toFixed(3))},a.prototype.radiansTo=function(b){var c=this,d=b,e=c.latitude*a.DEG_TO_RAD,f=d.latitude*a.DEG_TO_RAD,g=(d.longitude-c.longitude)*a.DEG_TO_RAD;return Math.acos(Math.sin(e)*Math.sin(f)+Math.cos(e)*Math.cos(f)*Math.cos(g))},a.prototype.toString=function(){return this.latitude+";"+this.longitude},a.prototype.toJSON=function(){return{latitude:this.latitude,longitude:this.longitude}},a}();e.DEG_TO_RAD=Math.PI/180,e.EARTH_RADIUS_IN_KILOMETERS=6371,e.EARTH_RADIUS_IN_MILES=3956,c.exports=e},{}],6:[function(a,b,c){"use strict";var d=a(3),e=a(2);e.prototype.binding=a(20),e.prototype.connector=a(27),e.prototype.error=a(33),e.prototype.message=a(35),e.prototype.metamodel=a(51),e.prototype.util=a(75),e.prototype.caching=a(22),e.prototype.query=a(62),e.prototype.partialupdate=a(55),e.prototype.EntityManager=a(2),e.prototype.EntityManagerFactory=a(3),e.prototype.EntityTransaction=a(4),e.prototype.Acl=a(1);var f=new d,g=f.createEntityManager(!0);g.configure=function(a){return f.configure(a),this},g.connect=function(a,b,c,d){return b instanceof Function&&(d=c,c=b,b=void 0),f.connect(a,b),this.ready(c,d)},c=b.exports=g,c.db=g,c.default=g},{1:1,2:2,20:20,22:22,27:27,3:3,33:33,35:35,4:4,51:51,55:55,62:62,75:75}],7:[function(a,c,d){"use strict";var e=function(){function a(){b.classCallCheck(this,a)}return a.prototype.getValue=function(a,b){return a[b.name]},a.prototype.setValue=function(a,b,c){a[b.name]=c},a}();c.exports=e},{}],8:[function(a,b,c){"use strict";var d=a(11),e=a(35),f=d.extend({get me(){return this._db.deviceMe},get isRegistered(){return this._db.isDeviceRegistered},loadWebPushKey:function(){var a=new e.VAPIDPublicKey;return a.responseType("arraybuffer"),this._db.send(a).then(function(a){return a.entity})},register:function(a,b,c,d,e){return c instanceof Function&&(e=d,d=c,c=null),"string"==typeof b&&(b={token:b}),this._db.registerDevice(a,b,c).then(d,e)},push:function(a,b,c){return this._db.pushDevice(a).then(b,c)}});f.PushMessage=a(69),b.exports=f},{11:11,35:35,69:69}],9:[function(a,c,d){"use strict";var e=(a(66),a(64),function(){function a(){b.classCallCheck(this,a)}return a.prototype.createProxy=function(a){return function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c}(a)},a.prototype.getIdentifier=function(a){return a.__baqendId__},a.prototype.setIdentifier=function(a,b){Object.defineProperty(a,"__baqendId__",{value:b})},a.prototype.enhance=function(a,b){if(b.__baqendType__!=a){if(b.hasOwnProperty("__baqendType__"))throw new Error("Type is already used by a different manager");Object.defineProperty(b,"__baqendType__",{value:a}),this.setIdentifier(b,a.ref),this.enhancePrototype(b.prototype,a)}},a.prototype.enhancePrototype=function(a,b){if(a.toString===Object.prototype.toString&&Object.defineProperty(a,"toString",{value:function(){return this._metadata.id||this._metadata.bucket},enumerable:!1}),b.superType&&"Object"==b.superType.name)for(var c=b.superType.declaredAttributes,d=Array.isArray(c),e=0,c=d?c:c[Symbol.iterator]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{if(e=c.next(),e.done)break;f=e.value}var g=f;g.isMetadata||this.enhanceProperty(a,g)}for(var h=b.declaredAttributes,i=Array.isArray(h),j=0,h=i?h:h[Symbol.iterator]();;){var k;if(i){if(j>=h.length)break;k=h[j++]}else{if(j=h.next(),j.done)break;k=j.value}var l=k;this.enhanceProperty(a,l)}},a.prototype.enhanceProperty=function(a,b){var c="$"+b.name;Object.defineProperty(a,b.name,{get:function(){var a=this._metadata;return a.readAccess(),a[c]},set:function(a){var b=this._metadata;b.writeAccess(),b[c]=a},configurable:!0,enumerable:!0})},a}());c.exports=e},{64:64,66:66}],10:[function(a,c,d){"use strict";var e=a(15),f=a(52),g=function(a){function c(d){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.call(this,d))}return b.inherits(c,a),c}(e);Object.defineProperties(g.prototype,{id:{get:function(){return this._metadata.id},set:function(a){if(this._metadata.id)throw new Error("The id can't be set twice: "+a);a+="",0==a.indexOf("/db/"+this._metadata.bucket+"/")?this._metadata.id=a:this.key=a},enumerable:!0},key:{get:function(){return this._metadata.key},set:function(a){this._metadata.key=a}},version:{get:function(){return this._metadata.version},enumerable:!0},acl:{get:function(){return this._metadata.acl},enumerable:!0},ready:{value:function(a){return this._metadata.ready(a)}},attach:{value:function(a){a.attach(this)}},save:{value:function(a,b,c){return a instanceof Function&&(c=b,b=a,a={}),this._metadata.db.save(this,a).then(b,c)}},insert:{value:function(a,b,c){return a instanceof Function&&(c=b,b=a,a={}),this._metadata.db.insert(this,a).then(b,c)}},update:{value:function(a,b,c){return a instanceof Function&&(c=b,b=a,a={}),this._metadata.db.update(this,a).then(b,c)}},load:{value:function(a,b,c){return a instanceof Function&&(c=b,b=a,a={}),a=a||{},a.local=!0,this._metadata.db.load(this.id,null,a).then(b,c)}},delete:{value:function(a,b,c){return a instanceof Function&&(c=b,b=a,a={}),this._metadata.db.delete(this,a).then(b,c)}},optimisticSave:{value:function(a,b,c){return this._metadata.db.optimisticSave(this,a).then(b,c)}},attr:{value:function(){throw new Error("Attr is not yet implemented.")}},validate:{value:function(){return this._metadata.db.validate(this)}},partialUpdate:{value:function(a){return new f(this,a)}},getReferencing:{value:function(a){var b=this,c=this._metadata.db,d=this._metadata.type.getReferencing(c,a),e=Array.from(d).map(function(a){var d=a[0],e=c.createQueryBuilder(d.typeConstructor),f=a[1],g=[];return f.forEach(function(a){g.push(e.equal(a,b))}),(1==g.length?g[0]:e.or(g)).resultList()});return Promise.all(e).then(function(a){return a.filter(function(a){return!!a.length})}).then(function(a){return[].concat.apply([],a)})}},toJSON:{value:function(a){return"boolean"==typeof a&&(a={excludeMetadata:a}),"object"!==(void 0===a?"undefined":b.typeof(a))&&(a={}),this._metadata.getJson(a)}}}),c.exports=g},{15:15,52:52}],11:[function(a,b,c){"use strict";var d=a(16),e=(a(66),d.extend({load:function(a,b,c,d){return b instanceof Function&&(d=c,c=b,b={}),this._db.load(this._managedType.typeConstructor,a,b).then(c,d)},ref:function(a){return this._db.getReference(this._managedType.ref,a)},fromJSON:function(a){var b=this._db.getReference(this._managedType.typeConstructor,a.id);return this._managedType.fromJsonValue(null,a,b)},find:function(){return this._db.createQueryBuilder(this._managedType.typeConstructor)},partialUpdate:function(a,b){return this.ref(a).partialUpdate(b)}}));b.exports=e},{16:16,66:66}],12:[function(a,b,c){"use strict";function d(a){for(var b,c=1;b=arguments[c];++c)for(var d=Object.getOwnPropertyNames(b),e=Array.isArray(d),f=0,d=e?d:d[Symbol.iterator]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{if(f=d.next(),f.done)break;g=f.value}var h=g;Object.defineProperty(a,h,Object.getOwnPropertyDescriptor(b,h))}return a}var e=d({extend:function(a){return d({},this,a)},create:function(a){var b=function(a){return b.newInstance(arguments)};return d(b,this),b.prototype=a.prototype,b._type=a,b},new:function(){return this.newInstance(arguments)},newInstance:function(a){return a&&0!=a.length?new this._type(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9]):new this._type}});b.exports=e},{}],13:[function(a,c,d){"use strict";var e=a(33),f=a(1),g=a(77).uuid,h=a(35),i=a(25).StatusCode,j="/file",k=j.length,l=function(){function a(c){if(b.classCallCheck(this,a),c=c||{},this._available=!1,Object(c)instanceof String){var d=c;if(-1==d.indexOf("/","/file/".length)||0!=d.indexOf("/file/"))throw new Error("Invalid file reference "+d);this._id=d}else if(c.id)this._id=c.id,this._setMetadata(c);else{var e=void 0;if(c.path)e=c.path;else{var f=c.parent||"/www";if("/"!=f.charAt(f.length-1)&&(f+="/"),f.length<3)throw new Error("Invalid parent name: "+f);var h=c.name||c.data&&c.data.name||g();e=f+h}if("/"!=e.charAt(0)&&(e="/"+e),-1!=e.indexOf("//")||e.length<3)throw new Error("Invalid path: "+e);this._id=j+e,this._setMetadata(c)}this.isFolder="/"==this._id.charAt(this._id.length-1)}return b.createClass(a,[{key:"id",get:function(){return this._id}},{key:"url",get:function(){if(this.isFolder)throw new Error("Url can not be created for folders.");return this._url||(this._url=this._db.createURL(this.id,"www"!=this.bucket)),this._url}},{key:"name",get:function(){return this._name||(this._name=this._id.substring(this._id.lastIndexOf("/",this._id.length-2)+1)),this._name}},{key:"mimeType",get:function(){if(this.isFolder)throw new Error("A folder has no mimeType");return this._checkAvailable(),this._mimeType}},{key:"acl",get:function(){return this._checkAvailable(),this._acl}},{key:"lastModified",get:function(){if(this.isFolder)throw new Error("A folder has no lastModified");return this._checkAvailable(),this._lastModified}},{key:"createdAt",get:function(){
if(this.isFolder)throw new Error("A folder has no creation date");return this._checkAvailable(),this._createdAt}},{key:"eTag",get:function(){if(this.isFolder)throw new Error("A folder has no eTag");return this._checkAvailable(),this._eTag}},{key:"headers",get:function(){if(this.isFolder)throw new Error("A folder has no custom headers");return this._checkAvailable(),this._headers}},{key:"size",get:function(){if(this.isFolder)throw new Error("A folder has no size");return this._checkAvailable(),this._size}},{key:"bucket",get:function(){return this.id.substring(k+1,this.id.indexOf("/",k+1))}},{key:"key",get:function(){return this.id.substring(this.id.indexOf("/",k+1)+1)}},{key:"path",get:function(){return this.id.substring(k)}},{key:"parent",get:function(){return this.id.substring(k,this.id.lastIndexOf("/",this.id.length-2))}},{key:"isMetadataLoaded",get:function(){return this._available}}]),a.prototype.upload=function(a,b,c){var d=this;if(a=a||{},this.isFolder)throw new Error("A folder cannot be uploaded");this._setMetadata(a);var e=new h.UploadFile(this.bucket,this.key).entity(this._data,this._type).acl(this._acl);return e.progress(a.progress),this._size&&e.contentLength(this._size),this._mimeType&&e.mimeType(this._mimeType),this._headers&&e.customHeaders(this._headers),this._conditional(e,a),this._db.addToBlackList(this.id),this._db.send(e).then(function(a){return d._data=null,d._type=null,d.fromJSON(a.entity),d}).then(b,c)},a.prototype.download=function(a,b,c){var d=this;if(a=a||{},this.isFolder)throw new Error("A folder cannot be downloaded");var e=a.type||"blob",f=new h.DownloadFile(this.bucket,this.key).responseType(e);return this._db.ensureCacheHeader(this.id,f,a.refresh),this._db.send(f).then(function(a){return d._db.addToWhiteList(d.id),d._fromHeaders(a.headers),a.entity},function(a){if(a.status==i.OBJECT_NOT_FOUND)return null;throw a}).then(b,c)},a.prototype.delete=function(a,b,c){var d=this;a=a||{};var e=new h.DeleteFile(this.bucket,this.key);return this._conditional(e,a),this.isFolder||this._db.addToBlackList(this.id),this._db.send(e).then(function(a){return d.isFolder?a.entity.map(function(a){return d._db.File(a)}):d}).then(b,c)},a.prototype._conditional=function(a,b){b.force||(this._lastModified&&a.ifUnmodifiedSince(this._lastModified),this._eTag&&a.ifMatch(this._eTag),this._lastModified||this._eTag||a.ifNoneMatch("*"))},a.prototype.loadMetadata=function(a,b,c){var d=this;if(a=a||{},this.isFolder)throw new Error("A folder has no matadata");var e=new h.GetFileMetadata(this.bucket,this.key);return this._db.ensureCacheHeader(this.id,e,a.refresh),this._db.send(e).then(function(a){return d._fromHeaders(a.headers),d},function(a){if(a.status==i.OBJECT_NOT_FOUND)return null;throw a}).then(b,c)},a.prototype.saveMetadata=function(a,b,c){var d=this;a=a||{};var e=this.toJSON(),f=new h.UpdateFileMetadata(this.bucket,this.key).entity(e);return this._conditional(f,a),this._db.send(f).then(function(a){return d.fromJSON(a.entity),d}).then(b,c)},a.prototype._setMetadata=function(a){var b=a.data,c=a.type,d=a.eTag,e=a.acl,g=a.size,h=a.mimeType,i=a.lastModified,j=a.createdAt,k=a.headers;if(b){if("undefined"!=typeof Blob&&b instanceof Blob)h=h||b.type;else if("data-url"==c){var l=b.match(/^data:(.+?)(;base64)?,.*$/);h=h||l[1]}this._data=b,this._type=c,this._size=g,this._mimeType=h,this._acl=e||this._acl||new f,this._available=!0}else this._available=!1;this._eTag=d||this._eTag,i&&(this._lastModified=new Date(i)),j&&(this._createdAt=new Date(j)),k&&(this._headers=k)},a.prototype._fromHeaders=function(a){this.fromJSON({eTag:a.etag?a.etag.substring(1,a.etag.length-1):null,lastModified:a["last-modified"],createdAt:a["baqend-created-at"],mimeType:a["content-type"],acl:a["baqend-acl"]&&JSON.parse(a["baqend-acl"]),contentLength:+a["baqend-size"],headers:a["baqend-custom-headers"]&&JSON.parse(a["baqend-custom-headers"])})},a.prototype.fromJSON=function(a){if(a.id&&this.id!==a.id)throw new Error("This file id "+this.id+" does not match the given json id "+a.id);a.mimeType&&(this._mimeType=a.mimeType),a.lastModified&&(this._lastModified=new Date(a.lastModified)),a.createdAt&&(this._createdAt=new Date(a.createdAt)),a.eTag&&(this._eTag=a.eTag),this._acl=this._acl||new f,a.acl&&this._acl.fromJSON(a.acl),a.contentLength&&(this._size=a.contentLength),a.headers&&(this._headers=a.headers),this._available=!0},a.prototype.toJSON=function(){var a={id:this._id,mimeType:this._mimeType,eTag:this._eTag,acl:this._acl.toJSON(),contentLength:this._size};return this._lastModified&&(a.lastModified=this._lastModified.toISOString()),this._createdAt&&(a.createdAt=this._createdAt.toISOString()),this._headers&&(a.headers=this._headers),a},a.prototype._checkAvailable=function(){if(!this._available)throw new e.PersistentError("The file metadata of "+this.id+" is not available.")},a}();c.exports=l},{1:1,25:25,33:33,35:35,77:77}],14:[function(a,b,c){"use strict";var d=a(12),e=a(13),f=a(35),g=a(68),h=d.extend({create:function(a){var b=d.create.call(this,e);return b._db=a,b},newInstance:function(a){var b=d.newInstance.call(this,a);return b._db=this._db,b},fromJSON:function(a){var b=this.newInstance([a.id]);return b.fromJSON(a),b},saveMetadata:function(a,b,c,d){var e=new f.SetFileBucketMetadata(a,b);return this._db.send(e).then(c,d)},loadMetadata:function(a,b,c,d){b=b||{};var e=new f.GetFileBucketMetadata(a);return this._db.send(e).then(function(a){var b={};return g.BASE_PERMISSIONS.forEach(function(c){b[c]=g.fromJSON(a.entity[c]||{})}),b},function(a){if(a.status==StatusCode.OBJECT_NOT_FOUND)return null;throw a}).then(c,d)},listBuckets:function(a,b){var c=this;return this._db.send(new f.ListBuckets).then(function(a){return a.entity.map(function(a){return c.new(a+"/")})}).then(a,b)},listFiles:function(a,b,c,d,e){var g=this;Object(a)instanceof String&&("/"!=a.charAt(a.length-1)&&(a+="/"),a=this.new({path:a}));var h=a.key,i=a.bucket;return b=b?b.key:null,this._db.send(new f.ListFiles(i,h,b,c)).then(function(a){return a.entity.map(function(a){return g.new(a)})}).then(d,e)}});b.exports=h},{12:12,13:13,35:35,68:68}],15:[function(a,c,d){"use strict";var e=a(66),f=function(){function a(c){b.classCallCheck(this,a),a.init(this,c)}return a.init=function(a,b){var c=a.constructor.__baqendType__;c&&Object.defineProperty(a,"_metadata",{value:e.create(c,a),configurable:!0}),b&&Object.assign(a,b)},a.extend=function(b){return b.prototype=Object.create(this.prototype,{constructor:{value:b,configurable:!0,writable:!0}}),b.extend=a.extend,b},a}();Object.defineProperties(f.prototype,{toJSON:{value:function(){return this._metadata.type.toJsonValue(this._metadata,this,{})}}}),c.exports=f},{66:66}],16:[function(a,b,c){"use strict";var d=a(12),e=(a(15),d.extend({create:function(a,b){var c=d.create.call(this,a.typeConstructor);return c.methods=c.prototype,c._managedType=a,c._db=b,c},newInstance:function(a){var b=a?d.newInstance.call(this,a):this._managedType.create(a);return b._metadata.db=this._db,b},fromJSON:function(a){var b=this.newInstance(),c=b._metadata;return this._managedType.fromJsonValue(c,a,b,{})},addMethods:function(a){Object.assign(this.methods,a)},addMethod:function(a,b){this.methods[a]=b}}));b.exports=e},{12:12,15:15}],17:[function(a,c,d){"use strict";var e=a(10),f=a(18),g=function(a){function c(d){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.call(this,d))}return b.inherits(c,a),c}(e);Object.defineProperties(g.prototype,{hasUser:{value:function(a){return this.users&&this.users.has(a)}},addUser:{value:function(a){if(!(a instanceof f))throw new Error("Only user instances can be added to a role.");this.users||(this.users=new Set),this.users.add(a)}},removeUser:{value:function(a){if(!(a instanceof f))throw new Error("Only user instances can be removed from a role.");this.users&&this.users.delete(a)}}}),c.exports=g},{10:10,18:18}],18:[function(a,c,d){"use strict";var e=a(10),f=function(a){function c(d){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.call(this,d))}return b.inherits(c,a),c}(e);Object.defineProperties(f.prototype,{newPassword:{value:function(a,b,c,d){return this._metadata.db.newPassword(this.username,a,b).then(c,d)}},changeUsername:{value:function(a,b,c,d){return this._metadata.db.changeUsername(this.username,a,b).then(c,d)}},requestAPIToken:{value:function(a,b){return this._metadata.db.requestAPIToken(this.constructor,this).then(a,b)}}}),c.exports=f},{10:10}],19:[function(a,b,c){"use strict";var d=a(11),e=d.extend({get me(){return this._db.me},register:function(a,b,c,d,e){return c instanceof Function&&(e=d,d=c,c=!0),a=Object(a)instanceof String?this.fromJSON({username:a}):a,this._db.register(a,b,void 0===c||c).then(d,e)},login:function(a,b,c,d,e){return c instanceof Function&&(e=d,d=c,c=!0),this._db.login(a,b,void 0===c||c).then(d,e)},loginWithToken:function(a,b,c,d){return b instanceof Function&&(d=c,c=b,b=!0),this._db.token=a,this._db.renew(b).then(c,d)},logout:function(a,b){return this._db.logout().then(a,b)},newPassword:function(a,b,c,d,e){if("string"!=typeof c){var f=arguments,g=f[0],h=f[1],i=f[2],j=f[3],k=f[4];return i instanceof Function&&(k=j,j=i,i=!0),this._db.newPasswordWithToken(g,h,i).then(j,k)}return this._db.newPassword(a,b,c).then(d,e)},resetPassword:function(a,b,c){return this._db.resetPassword(a).then(b,c)},changeUsername:function(a,b,c,d,e){return this._db.changeUsername(a,b,c,d,e)},requestAPIToken:function(a,b,c){return this._db.requestAPIToken(this._managedType.typeConstructor,a).then(b,c)},revokeAllTokens:function(a,b,c){return this._db.revokeAllTokens(this._managedType.typeConstructor,a).then(b,c)}});e.LoginOption={NO_LOGIN:-1,SESSION_LOGIN:0,PERSIST_LOGIN:1},e.DefaultOptions={google:{width:585,height:545,scope:"email"},facebook:{width:1140,height:640,scope:"email"},github:{width:1040,height:580,scope:"user:email"},twitter:{width:740,height:730},linkedin:{width:630,height:530,scope:""}},["Google","Facebook","GitHub","Twitter","LinkedIn"].forEach(function(a){e["loginWith"+a]=function(b,c,d,f){return c instanceof Function&&(f=d,d=c,c={}),c=Object.assign({},e.DefaultOptions[a.toLowerCase()],c||{}),this._db.loginWithOAuth(a,b,c).then(d,f)}}),b.exports=e},{11:11}],20:[function(a,b,c){"use strict";c.Accessor=a(7),c.Enhancer=a(9),c.Factory=a(12),c.ManagedFactory=a(16),c.EntityFactory=a(11),c.UserFactory=a(19),c.DeviceFactory=a(8),c.FileFactory=a(14),c.Managed=a(15),c.Entity=a(10),c.Role=a(17),c.User=a(18),c.File=a(13)},{10:10,11:11,12:12,13:13,14:14,15:15,16:16,17:17,18:18,19:19,7:7,8:8,9:9}],21:[function(a,c,d){"use strict";var e=a(73).atob,f=function(){function a(c){b.classCallCheck(this,a),this.bytes=e(c.b),this.bits=c.m,this.hashes=c.h,this.creation=Date.now()}return a.prototype.contains=function(b){for(var c=a._getHashes(b,this.bits,this.hashes),d=Array.isArray(c),e=0,c=d?c:c[Symbol.iterator]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{if(e=c.next(),e.done)break;f=e.value}var g=f;if(!this._isSet(g))return!1}return!0},a.prototype._isSet=function(a){var b=Math.floor(a/8),c=1<<a%8;return 0!=(this.bytes.charCodeAt(b)&c)},a._getHashes=function(b,c,d){for(var e=new Array(this.hashes),f=a._murmur3(0,b),g=a._murmur3(f,b),h=0;h<d;h++)e[h]=(f+h*g)%c;return e},a._murmur3=function(a,b){var c=3&b.length,d=b.length-c,e=3432918353,f=461845907,g=void 0,h=void 0,i=void 0,j=void 0;for(g=a,j=0;j<d;)i=255&b.charCodeAt(j)|(255&b.charCodeAt(++j))<<8|(255&b.charCodeAt(++j))<<16|(255&b.charCodeAt(++j))<<24,++j,i=(65535&i)*e+(((i>>>16)*e&65535)<<16)&4294967295,i=i<<15|i>>>17,i=(65535&i)*f+(((i>>>16)*f&65535)<<16)&4294967295,g^=i,g=g<<13|g>>>19,h=5*(65535&g)+((5*(g>>>16)&65535)<<16)&4294967295,g=27492+(65535&h)+((58964+(h>>>16)&65535)<<16);switch(i=0,c){case 3:i^=(255&b.charCodeAt(j+2))<<16;case 2:i^=(255&b.charCodeAt(j+1))<<8;case 1:i^=255&b.charCodeAt(j),i=(65535&i)*e+(((i>>>16)*e&65535)<<16)&4294967295,i=i<<15|i>>>17,i=(65535&i)*f+(((i>>>16)*f&65535)<<16)&4294967295,g^=i}return g^=b.length,g^=g>>>16,g=2246822507*(65535&g)+((2246822507*(g>>>16)&65535)<<16)&4294967295,g^=g>>>13,g=3266489909*(65535&g)+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0},a}();c.exports=f},{73:73}],22:[function(a,b,c){"use strict";c.BloomFilter=a(21)},{21:21}],23:[function(a,c,d){"use strict";var e=a(31),f=(a(35),function(){function a(c,d,e,f){b.classCallCheck(this,a),this.host=c,this.port=d,this.secure=e,this.basePath=f,this.origin=a.toUri(c,d,e,"")}return a.create=function(b,c,d,e){if("undefined"!=typeof location&&(b||(b=location.hostname,c=Number(location.port)),void 0===d&&(d="https:"==location.protocol)),d=!!d,void 0===e&&(e=a.DEFAULT_BASE_PATH),-1!=b.indexOf("/")){var f=/^(https?):\/\/([^\/:]+|\[[^\]]+])(:(\d*))?(\/\w+)?\/?$/.exec(b);if(!f)throw new Error("The connection uri host "+b+" seems not to be valid");d="https"==f[1],b=f[2].replace(/(\[|])/g,""),c=f[4],e=f[5]||""}else"localhost"!=b&&/^[a-z0-9-]*$/.test(b)&&(b+=a.HTTP_DOMAIN);c||(c=d?443:80);var g=a.toUri(b,c,d,e),h=this.connections[g];if(!h){for(var i=this.connectors.length-1;i>=0;--i){var j=this.connectors[i];if(j.isUsable&&j.isUsable(b,c,d,e)){h=new j(b,c,d,e);break}}if(!h)throw new Error("No connector is usable for the requested connection.");this.connections[g]=h}return h},a.toUri=function(a,b,c,d){var e=(c?"https://":"http://")+(-1!=a.indexOf(":")?"["+a+"]":a);return e+=c&&443!=b||!c&&80!=b?":"+b:"",e+=d},a.prototype.send=function(a){var b=this,c={status:0};return new Promise(function(c){b.prepareRequest(a),b.doSend(a,a.request,c)}).then(function(a){return c=a}).then(function(){return b.prepareResponse(a,c)}).then(function(){return a.doReceive(c),c}).catch(function(a){throw c.entity=null,e.of(a)})},a.prototype.doSend=function(a,b,c){},a.prototype.prepareRequest=function(a){if(!a.mimeType()){var b=a.request.type;"json"==b?a.mimeType("application/json;charset=utf-8"):"text"==b&&a.mimeType("text/plain;charset=utf-8")}this.toFormat(a);var c=void 0;switch(a.responseType()){case"json":c="application/json";break;case"text":c="text/*";break;default:c="application/json,text/*;q=0.5,*/*;q=0.1"}if(a.accept()||a.accept(c),this.gzip){var d=a.ifNoneMatch();d&&'""'!==d&&"*"!=d&&a.ifNoneMatch(d.slice(0,-1)+'--gzip"')}if("/connect"==a.request.path)a.request.path=a.tokenStorage.signPath(this.basePath+a.request.path).substring(this.basePath.length),a.cacheControl()&&(a.request.path+=(a.tokenStorage.token?"&":"?")+"BCB");else if(a.tokenStorage){var e=a.tokenStorage.token;e&&a.header("authorization","BAT "+e)}},a.prototype.toFormat=function(a){},a.prototype.prepareResponse=function(a,b){var c=this;b.status=1223==b.status?204:b.status;var d=void 0,e=b.headers||{},f=204==b.status?null:b.entity;if(f&&(!(d=a.responseType())||b.status>=400)){var g=e["content-type"]||e["Content-Type"];g&&g.indexOf("application/json")>-1&&(d="json")}if(e.etag&&(e.etag=e.etag.replace("--gzip","")),a.tokenStorage){var h=e["baqend-authorization-token"]||e["Baqend-Authorization-Token"];h&&a.tokenStorage.update(h)}return new Promise(function(a){a(f&&c.fromFormat(b,f,d))}).then(function(d){b.entity=d,-1!=a.request.path.indexOf("/connect")&&d&&(c.gzip=!!d.gzip)},function(a){throw new Error("Response was not valid "+d+": "+a.message)})},a.prototype.fromFormat=function(a,b,c){},a}());Object.assign(f,{DEFAULT_BASE_PATH:"/v1",HTTP_DOMAIN:".app.baqend.com",RESPONSE_HEADERS:["baqend-authorization-token","content-type","baqend-size","baqend-acl","etag","last-modified","baqend-created-at","baqend-custom-headers"],connectors:[],connections:{},gzip:!1}),c.exports=f},{31:31,35:35}],24:[function(a,c,d){"use strict";var e=a(23),f=a(26),g=function(a){function c(d,e,f,g){b.classCallCheck(this,c);var h=b.possibleConstructorReturn(this,a.call(this,d,e,f,g));return h.mid=0,h.messages={},h.doReceive=h.doReceive.bind(h),addEventListener("message",h.doReceive,!1),h}return b.inherits(c,a),c.isUsable=function(a,b,c){if("undefined"==typeof location||"undefined"==typeof document)return!1;var d="https:"==location.protocol,e=location.port||(d?443:80);return location.hostname!=a||e!=b||d!=c},c.prototype.load=function(a){this.iframe=document.createElement("iframe"),this.iframe.src=this.origin+this.basePath+a,this.iframe.setAttribute("style",c.style),document.body.appendChild(this.iframe),this.queue=[],this.iframe.addEventListener("load",this.onLoad.bind(this),!1)},c.prototype.onLoad=function(){for(var a=this.queue,b=0;b<a.length;++b)this.postMessage(a[b]);this.queue=null},c.prototype.doSend=function(b,c,d){var f=this;if(b.isBinary)return a.prototype.doSend.call(this,b,c,d);this.iframe||(this.load(b.request.path),b.request.path="/connect");var g={mid:++this.mid,method:c.method,path:c.path,headers:c.headers,entity:c.entity,responseHeaders:e.RESPONSE_HEADERS};this.messages[g.mid]=d;var h=JSON.stringify(g);this.queue?this.queue.push(h):this.postMessage(h),this.connected||setTimeout(function(){f.messages[g.mid]&&(delete f.messages[g.mid],d({status:0,error:new Error("Connection refused.")}))},1e4)},c.prototype.postMessage=function(a){this.iframe.contentWindow.postMessage(a,this.origin)},c.prototype.doReceive=function(a){if(a.origin===this.origin&&"{"==a.data[0]){var b=JSON.parse(a.data),c=this.messages[b.mid];c&&(delete this.messages[b.mid],this.connected=!0,c({status:b.status,headers:b.headers,entity:b.entity}))}},c}(f);g.style="width:1px;height:1px;position:absolute;top:-10px;left:-10px;",e.connectors.push(g),c.exports=g},{23:23,26:26}],25:[function(a,c,d){"use strict";var e=a(28),f="undefined"==typeof navigator||"undefined"!=typeof chrome&&/google/i.test(navigator.vendor)||/cros i686/i.test(navigator.platform),g=function(){function a(){b.classCallCheck(this,a),this.withCredentials=!1,this.tokenStorage=null,this._progress=null;var c=arguments,d=0,e=this.spec.path;if(Object(e)instanceof Array){e=this.spec.path[0];for(var f=this.spec.path.length,g=1;g<f;++g)this.spec.dynamic&&f-1==g?(e+=c[d].split("/").map(encodeURIComponent).join("/"),d+=1):e+=encodeURIComponent(c[d++])+this.spec.path[g]}for(var h="",i=0;i<this.spec.query.length;++i){var j=c[d++];void 0!==j&&null!==j&&(h+=h||~e.indexOf("?")?"&":"?",h+=this.spec.query[i]+"="+encodeURIComponent(j))}this.request={method:this.spec.method,path:e+h,entity:null,headers:{}},c[d]&&this.entity(c[d],"json"),this.responseType("json")}return a.create=function(c){var d=c.path.split("?"),e=d[0].split(/[:\*]\w*/),f=[];return d[1]&&d[1].split("&").forEach(function(a){var b=a.split("=");f.push(b[0])}),c.dynamic=-1!=c.path.indexOf("*"),c.path=e,c.query=f,function(a){function d(){return b.classCallCheck(this,d),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(d,a),b.createClass(d,[{key:"spec",get:function(){return c}}]),d}(a)},a.createExternal=function(c,d){c.path=[c.path];var e=function(a){function d(){return b.classCallCheck(this,d),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(d,a),b.createClass(d,[{key:"spec",get:function(){return c}}]),d}(a);return Object.assign(e.prototype,d),e},b.createClass(a,[{key:"isBinary",get:function(){return this.request.type in a.BINARY||this._responseType in a.BINARY}}]),a.prototype.header=function(a,b){return void 0!==b?(this.request.headers[a]=b,this):this.request.headers[a]},a.prototype.entity=function(a,b){return b||(b="string"==typeof a?/^data:(.+?)(;base64)?,.*$/.test(a)?"data-url":"text":"undefined"!=typeof Blob&&a instanceof Blob?"blob":"undefined"!=typeof Buffer&&a instanceof Buffer?"buffer":"undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer?"arraybuffer":"undefined"!=typeof FormData&&a instanceof FormData?"form":"json"),this.request.type=b,this.request.entity=a,this},a.prototype.mimeType=function(a){return this.header("content-type",a)},a.prototype.contentLength=function(a){return this.header("content-length",a)},a.prototype.ifMatch=function(a){return this.header("If-Match",this._formatETag(a))},a.prototype.ifNoneMatch=function(a){return this.header("If-None-Match",this._formatETag(a))},a.prototype.ifUnmodifiedSince=function(a){return this.header("if-unmodified-since",a&&a.toUTCString().replace("UTC","GMT"))},a.prototype.noCache=function(){return f||this.ifMatch("").ifNoneMatch("-"),this.cacheControl("max-age=0, no-cache")},a.prototype.cacheControl=function(a){return this.header("cache-control",a)},a.prototype.acl=function(a){return this.header("baqend-acl",a&&JSON.stringify(a))},a.prototype.customHeaders=function(a){return this.header("baqend-custom-headers",a&&JSON.stringify(a))},a.prototype.accept=function(a){return this.header("accept",a)},a.prototype.responseType=function(a){return void 0!==a?(this._responseType=a,this):this._responseType},a.prototype.progress=function(a){return void 0!==a?(this._progress=a,this):this._progress},a.prototype.addQueryString=function(a){var b=this;if(Object(a)instanceof String)this.request.path+=a;else if(a){var c=~this.request.path.indexOf("?")?"&":"?";Object.keys(a).forEach(function(d,e){b.request.path+=c+d+"="+encodeURIComponent(a[d]),0==e&&(c="&")})}return this},a.prototype._formatETag=function(a){return a&&"*"!=a&&(a=""+a,-1==a.indexOf('"')&&(a='"'+a+'"')),a},a.prototype.doReceive=function(a){if(-1==this.spec.status.indexOf(a.status))throw new e(this,a)},a}();Object.assign(g,{StatusCode:{NOT_MODIFIED:304,BAD_CREDENTIALS:460,BUCKET_NOT_FOUND:461,INVALID_PERMISSION_MODIFICATION:462,INVALID_TYPE_VALUE:463,OBJECT_NOT_FOUND:404,OBJECT_OUT_OF_DATE:412,PERMISSION_DENIED:466,QUERY_DISPOSED:467,QUERY_NOT_SUPPORTED:468,SCHEMA_NOT_COMPATIBLE:469,SCHEMA_STILL_EXISTS:470,SYNTAX_ERROR:471,TRANSACTION_INACTIVE:472,TYPE_ALREADY_EXISTS:473,TYPE_STILL_REFERENCED:474,SCRIPT_ABORTION:475},BINARY:{blob:!0,buffer:!0,stream:!0,arraybuffer:!0,"data-url":!0,base64:!0},GoogleOAuth:g.createExternal({method:"OAUTH",path:"https://accounts.google.com/o/oauth2/auth?response_type=code&access_type=online",query:["client_id","scope","state"],status:[200]},{addRedirectOrigin:function(a){this.addQueryString({redirect_uri:a+"/db/User/OAuth/google"})}}),FacebookOAuth:g.createExternal({method:"OAUTH",path:"https://www.facebook.com/dialog/oauth?response_type=code",query:["client_id","scope","state"],status:[200]},{addRedirectOrigin:function(a){this.addQueryString({redirect_uri:a+"/db/User/OAuth/facebook"})}}),GitHubOAuth:g.createExternal({method:"OAUTH",path:"https://github.com/login/oauth/authorize?response_type=code&access_type=online",query:["client_id","scope","state"],status:[200]},{addRedirectOrigin:function(a){this.addQueryString({redirect_uri:a+"/db/User/OAuth/github"})}}),LinkedInOAuth:g.createExternal({method:"OAUTH",path:"https://www.linkedin.com/uas/oauth2/authorization?response_type=code&access_type=online",query:["client_id","scope","state"],status:[200]},{addRedirectOrigin:function(a){this.addQueryString({redirect_uri:a+"/db/User/OAuth/linkedin"})}}),TwitterOAuth:g.createExternal({method:"OAUTH",path:"",query:[],status:[200]},{addRedirectOrigin:function(a){this.request.path=a+"/db/User/OAuth1/twitter"}})}),c.exports=g},{28:28}],26:[function(a,c,d){"use strict";var e=a(23),f=function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.isUsable=function(a,b,c){return"undefined"!=typeof XMLHttpRequest},c.prototype.doSend=function(a,b,c){var d=this;if("OAUTH"==b.method){this.oAuthHandle&&this.oAuthHandle({status:409,entity:'{"message": "A new OAuth request was sent."}'}),localStorage.removeItem("oauth-response");var f=function(a){"oauth-response"==a.key&&d.oAuthHandle(JSON.parse(a.newValue))};return this.oAuthHandle=function(a){c(a),localStorage.removeItem("oauth-response"),removeEventListener("storage",f,!1)},void addEventListener("storage",f,!1)}var g=new XMLHttpRequest,h=this.origin+this.basePath+b.path;g.onreadystatechange=function(){if(g.responseType&&2==g.readyState&&g.status>=400&&(g.responseType="text"),4==g.readyState){var a={headers:{},status:g.status,entity:g.response||g.responseText};e.RESPONSE_HEADERS.forEach(function(b){a.headers[b]=g.getResponseHeader(b)}),c(a)}},g.upload&&a.progress()&&(g.upload.onprogress=a.progress()),g.open(b.method,h,!0);var i=b.entity,j=b.headers;for(var k in j)g.setRequestHeader(k,j[k]);switch(g.withCredentials=a.withCredentials,a.responseType()){case"arraybuffer":g.responseType="arraybuffer";break;case"blob":case"data-url":case"base64":g.responseType="blob"}g.send(i)},c.prototype.fromFormat=function(a,b,c){if("json"==c)b=JSON.parse(b);else if("data-url"==c||"base64"==c){var d=new FileReader;return d.readAsDataURL(b),new Promise(function(a,b){d.onload=a,d.onerror=b}).then(function(){var a=d.result;return"base64"==c&&(a=a.substring(a.indexOf(",")+1)),a})}return b},c.prototype.toFormat=function(a){var b=a.request.type;if(b){var c=a.request.entity,d=a.mimeType();switch(b){case"blob":d=d||c.type;break;case"arraybuffer":case"form":break;case"data-url":var e=c.match(/^data:(.+?)(;base64)?,(.*)$/),f=e[2];if(c=e[3],b="blob",d=d||e[1],!f){c=decodeURIComponent(c);break}case"base64":for(var g=atob(c),h=g.length,i=new Uint8Array(h),j=0;j<h;++j)i[j]=g.charCodeAt(j);b="blob",c=new Blob([i],{type:d});break;case"json":"string"!=typeof c&&(c=JSON.stringify(c))}a.entity(c,b).mimeType(d)}},c}(e);e.connectors.push(f),c.exports=f},{23:23}],27:[function(a,b,c){"use strict";c.Message=a(25),c.Connector=a(23),c.FetchConnector=a(78),c.XMLHttpConnector=a(26),c.IFrameConnector=a(24),c.NodeConnector=a(78)},{23:23,24:24,25:25,26:26,78:78}],28:[function(a,c,d){"use strict";var e=a(31),f=function(a){function c(d,e){b.classCallCheck(this,c);var f=e.entity||e.error||{},g=0==e.status?"Request":"Response",h=f.message||"Handling the "+g+" for "+d.request.method+" "+d.request.path,i=b.possibleConstructorReturn(this,a.call(this,h,f));i.name=f.className||"CommunicationError",i.reason=f.reason||"Communication failed",i.status=e.status,f.data&&(i.data=f.data);for(var j=f;j&&j.stackTrace;){i.stack+="\nServerside Caused by: "+j.className+" "+j.message;for(var k=j.stackTrace,l=0;l<k.length;++l){var m=k[l];i.stack+="\n    at "+m.className+"."+m.methodName,i.stack+=" ("+m.fileName+":"+m.lineNumber+")"}j=j.cause}return i}return b.inherits(c,a),c}(e);c.exports=f},{31:31}],29:[function(a,c,d){"use strict";var e=a(31),f=function(a){function c(d){b.classCallCheck(this,c);var e=b.possibleConstructorReturn(this,a.call(this,"The entity "+d+" is managed by a different db."));return e.entity=d,e}return b.inherits(c,a),c}(e);c.exports=f},{31:31}],30:[function(a,c,d){"use strict";var e=a(31),f=function(a){function c(d){b.classCallCheck(this,c);var e=b.possibleConstructorReturn(this,a.call(this,"Entity "+d+" is not a valid entity"));return e.entity=d,e}return b.inherits(c,a),c}(e);c.exports=f},{31:31}],31:[function(a,b,c){"use strict";function d(a,b){a=a||"An unexpected persistent error occured.",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=a,this.name=this.constructor.name,b&&(this.cause=b,b.stack&&(this.stack+="\nCaused By: "+b.stack))}d.of=function(a){return a instanceof d?a:new d(null,a)},d.prototype=Object.create(Error.prototype,{constructor:{value:d,enumerable:!1,configurable:!0}}),b.exports=d},{}],32:[function(a,c,d){"use strict";var e=a(31),f=function(a){function c(d){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.call(this,"The transaction has been rollbacked",d))}return b.inherits(c,a),c}(e);c.exports=f},{31:31}],33:[function(a,b,c){"use strict";c.CommunicationError=a(28),c.IllegalEntityError=a(30),c.EntityExistsError=a(29),c.PersistentError=a(31),c.RollbackError=a(32)},{28:28,29:29,30:30,31:31,32:32}],34:[function(a,b,c){"use strict";a(176),b.exports=a(6)},{176:176,6:6}],35:[function(a,b,c){"use strict";var d=a(25);c.ListAllResources=d.create({method:"GET",path:"/",status:[200]}),c.ApiVersion=d.create({method:"GET",path:"/version",status:[200]}),c.Specification=d.create({method:"GET",path:"/spec",status:[200]}),c.GetBloomFilter=d.create({method:"GET",path:"/bloomfilter",status:[200]}),c.DeleteBloomFilter=d.create({method:"DELETE",path:"/bloomfilter",status:[204]}),c.GetOrestesConfig=d.create({method:"GET",path:"/config",status:[200]}),c.UpdateOrestesConfig=d.create({method:"PUT",path:"/config",status:[200,202]}),c.Connect=d.create({method:"GET",path:"/connect",status:[200]}),c.Status=d.create({method:"GET",path:"/status",status:[200]}),c.EventsUrl=d.create({method:"GET",path:"/events-url",status:[200]}),c.BannedIp=d.create({method:"GET",path:"/banned/:ip",status:[204]}),c.Banned=d.create({method:"GET",path:"/banned",status:[]}),c.Unban=d.create({method:"DELETE",path:"/banned",status:[204]}),c.UnbanIp=d.create({method:"DELETE",path:"/banned/:ip",status:[204]}),c.GetBucketNames=d.create({method:"GET",path:"/db",status:[200]}),c.GetBucketIds=d.create({method:"GET",path:"/db/:bucket/ids?start=0&count=-1",status:[200]}),c.ExportBucket=d.create({method:"GET",path:"/db/:bucket",status:[200]}),c.ImportBucket=d.create({method:"PUT",path:"/db/:bucket",status:[200]}),c.TruncateBucket=d.create({method:"DELETE",path:"/db/:bucket",status:[200]}),c.CreateObject=d.create({method:"POST",path:"/db/:bucket",status:[201,202]}),c.GetObject=d.create({method:"GET",path:"/db/:bucket/:oid",status:[200,304]}),c.ReplaceObject=d.create({method:"PUT",path:"/db/:bucket/:oid",status:[200,202]}),c.DeleteObject=d.create({method:"DELETE",path:"/db/:bucket/:oid",status:[202,204]}),c.GetAllSchemas=d.create({method:"GET",path:"/schema",status:[200]}),c.UpdateAllSchemas=d.create({method:"POST",path:"/schema",status:[200]}),c.ReplaceAllSchemas=d.create({method:"PUT",path:"/schema",status:[200]}),c.GetSchema=d.create({method:"GET",path:"/schema/:bucket",status:[200]}),c.UpdateSchema=d.create({method:"POST",path:"/schema/:bucket",status:[200]}),c.ReplaceSchema=d.create({method:"PUT",path:"/schema/:bucket",status:[200]}),c.DeleteSchema=d.create({method:"DELETE",path:"/schema/:bucket",status:[204]}),c.AdhocQuery=d.create({method:"GET",path:"/db/:bucket/query?q&start=0&count=-1&sort=&eager=&hinted=",status:[200]}),c.AdhocQueryPOST=d.create({method:"POST",path:"/db/:bucket/query?start=0&count=-1&sort=",status:[200]}),c.AdhocCountQuery=d.create({method:"GET",path:"/db/:bucket/count?q",status:[200]}),c.AdhocCountQueryPOST=d.create({method:"POST",path:"/db/:bucket/count",status:[200]}),c.ListQueryResources=d.create({method:"GET",path:"/query",status:[200]}),c.CreateQuery=d.create({method:"POST",path:"/query",status:[201]}),c.ListThisQueryResources=d.create({method:"GET",path:"/query/:qid",status:[200]}),c.GetQueryCode=d.create({method:"GET",path:"/query/:qid/source",status:[200]}),c.RunQuery=d.create({method:"GET",path:"/query/:qid/result?start=0&count=-1",status:[200]}),c.GetQueryParameters=d.create({method:"GET",path:"/query/:qid/parameters",status:[200]}),c.NewTransaction=d.create({method:"POST",path:"/transaction",status:[201]}),c.CommitTransaction=d.create({method:"PUT",path:"/transaction/:tid/committed",status:[200]}),c.UpdatePartially=d.create({method:"POST",path:"/db/:bucket/:oid",status:[200]}),c.UpdateField=d.create({method:"POST",path:"/db/:bucket/:oid/:field",status:[200]}),c.Login=d.create({method:"POST",path:"/db/User/login",status:[200]}),c.Register=d.create({method:"POST",path:"/db/User/register",status:[200,204]}),c.Me=d.create({method:"GET",path:"/db/User/me",status:[200]}),c.ValidateUser=d.create({method:"GET",path:"/db/User/validate",status:[200]}),c.Logout=d.create({method:"GET",path:"/db/User/logout",status:[204]}),c.NewPassword=d.create({method:"POST",path:"/db/User/password",status:[200]}),c.ResetPassword=d.create({method:"POST",path:"/db/User/reset",status:[200]}),c.Verify=d.create({method:"GET",path:"/db/User/verify?token=",status:[204]}),c.ChangeUsername=d.create({method:"POST",path:"/db/User/changeUsername",status:[204]}),c.VerifyUsername=d.create({method:"GET",path:"/db/User/verifyUsername?token=",status:[204]}),c.OAuth2=d.create({method:"GET",path:"/db/User/OAuth/:provider?state=&code=&oauth_verifier=&oauth_token=&error_description=",status:[200]}),c.OAuth1=d.create({method:"GET",
path:"/db/User/OAuth1/:provider",status:[200]}),c.UserToken=d.create({method:"POST",path:"/db/User/:oid/token",status:[200]}),c.RevokeUserToken=d.create({method:"DELETE",path:"/db/User/:oid/token",status:[204]}),c.GetBaqendCode=d.create({method:"GET",path:"/code/:bucket/:type",status:[200]}),c.SetBaqendCode=d.create({method:"PUT",path:"/code/:bucket/:type",status:[200,202]}),c.DeleteBaqendCode=d.create({method:"DELETE",path:"/code/:bucket/:type",status:[202,204]}),c.PostBaqendModule=d.create({method:"POST",path:"/code/:bucket",status:[200,204]}),c.GetBaqendModule=d.create({method:"GET",path:"/code/:bucket",status:[200,204]}),c.GetAllModules=d.create({method:"GET",path:"/code",status:[200]}),c.ListFiles=d.create({method:"GET",path:"/file/:bucket/ids?path=/&start=&count=-1&deep=false",status:[200]}),c.ListBuckets=d.create({method:"GET",path:"/file/buckets",status:[200]}),c.DownloadArchive=d.create({method:"GET",path:"/file",status:[200]}),c.UploadPatchArchive=d.create({method:"POST",path:"/file",status:[200]}),c.GetFileBucketMetadata=d.create({method:"GET",path:"/file/:bucket",status:[200]}),c.SetFileBucketMetadata=d.create({method:"PUT",path:"/file/:bucket",status:[204]}),c.DeleteFileBucket=d.create({method:"DELETE",path:"/file/:bucket",status:[204]}),c.CreateFile=d.create({method:"POST",path:"/file/:bucket",status:[200]}),c.DownloadFile=d.create({method:"GET",path:"/file/:bucket/*oid",status:[200,304]}),c.UploadFile=d.create({method:"PUT",path:"/file/:bucket/*oid",status:[200]}),c.GetFileMetadata=d.create({method:"HEAD",path:"/file/:bucket/*oid",status:[200]}),c.UpdateFileMetadata=d.create({method:"POST",path:"/file/:bucket/*oid",status:[200]}),c.DeleteFile=d.create({method:"DELETE",path:"/file/:bucket/*oid",status:[200,204]}),c.CreateManifest=d.create({method:"POST",path:"/pwa/manifest",status:[202]}),c.DownloadAsset=d.create({method:"GET",path:"/asset/*url",status:[200,304]}),c.RevalidateAssets=d.create({method:"POST",path:"/asset/revalidate",status:[202]}),c.GetRevalidationStatus=d.create({method:"GET",path:"/asset/revalidate/:id",status:[200,202]}),c.ListIndexes=d.create({method:"GET",path:"/index/:bucket",status:[200]}),c.CreateDropIndex=d.create({method:"POST",path:"/index/:bucket",status:[202]}),c.DropAllIndexes=d.create({method:"DELETE",path:"/index/:bucket",status:[202]}),c.DeviceRegister=d.create({method:"POST",path:"/db/Device/register",status:[200]}),c.DevicePush=d.create({method:"POST",path:"/db/Device/push",status:[204]}),c.DeviceRegistered=d.create({method:"GET",path:"/db/Device/registered",status:[200]}),c.UploadAPNSCertificate=d.create({method:"POST",path:"/config/APNSCert",status:[204]}),c.GCMAKey=d.create({method:"POST",path:"/config/GCMKey",status:[204]}),c.VAPIDKeys=d.create({method:"POST",path:"/config/VAPIDKeys",status:[200]}),c.VAPIDPublicKey=d.create({method:"GET",path:"/config/VAPIDPublicKey",status:[200]})},{25:25}],36:[function(a,c,d){"use strict";var e=a(7),f=function(){function a(c,d){b.classCallCheck(this,a),this.isMetadata=!!d,this.isId=!1,this.isVersion=!1,this.isAcl=!1,this.name=c,this.order=null,this.accessor=null,this.declaringType=null,this.metadata=null}return b.createClass(a,[{key:"persistentAttributeType",get:function(){return-1}},{key:"isAssociation",get:function(){return this.persistentAttributeType>a.PersistentAttributeType.EMBEDDED}},{key:"isCollection",get:function(){return this.persistentAttributeType==a.PersistentAttributeType.ELEMENT_COLLECTION}}]),a.prototype.init=function(a,b){if(this.declaringType)throw new Error("The attribute is already initialized.");this.order=b,this.accessor=new e,this.declaringType=a},a.prototype.getValue=function(a){return this.accessor.getValue(a,this)},a.prototype.setValue=function(a,b){this.accessor.setValue(a,this,b)},a.prototype.hasMetadata=function(a){return this.metadata&&!!this.metadata[a]},a.prototype.getMetadata=function(a){return this.hasMetadata(a)?this.metadata[a]:null},a.prototype.getJsonValue=function(a,b,c){},a.prototype.setJsonValue=function(a,b,c,d){},a.prototype.toJSON=function(){return{name:this.name,metadata:this.metadata||void 0,order:this.order}},a}();f.PersistentAttributeType={BASIC:0,ELEMENT_COLLECTION:1,EMBEDDED:2,MANY_TO_MANY:3,MANY_TO_ONE:4,ONE_TO_MANY:5,ONE_TO_ONE:6},c.exports=f},{7:7}],37:[function(a,c,d){"use strict";function e(a){return a instanceof Date?a.toISOString().replace(/\.?0*Z/,"Z"):null}function f(a,b){var c="string"==typeof a?new Date(a):null;return b&&c&&b.toISOString()==c.toISOString()?b:c}var g=a(50),h=a(5),i=a(13),j=function(a){function c(d,e,f){b.classCallCheck(this,c),0!=d.indexOf("/db/")&&(d="/db/"+d);var g=b.possibleConstructorReturn(this,a.call(this,d,e));return g.noResolving=f,g}return b.inherits(c,a),b.createClass(c,[{key:"persistenceType",get:function(){return g.PersistenceType.BASIC}}]),c.prototype.toJsonValue=function(a,b){return null===b||void 0===b?null:this.typeConstructor(b)},c.prototype.fromJsonValue=function(a,b,c){return null===b||void 0===b?null:b},c.prototype.toString=function(){return"BasicType("+this.ref+")"},c}(g);Object.assign(j,{Boolean:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.fromJsonValue=function(b,c,d){return"string"==typeof c?"false"!==c:a.prototype.fromJsonValue.call(this,b,c,d)},c}(j))("Boolean",Boolean),Double:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.fromJsonValue=function(b,c,d){return"string"==typeof c?parseFloat(c):a.prototype.fromJsonValue.call(this,b,c,d)},c}(j))("Double",Number),Integer:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.fromJsonValue=function(b,c,d){return"string"==typeof c?parseInt(c):a.prototype.fromJsonValue.call(this,b,c,d)},c}(j))("Integer",Number),String:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c}(j))("String",String),DateTime:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.toJsonValue=function(a,b){return e(b)},c.prototype.fromJsonValue=function(a,b,c){return f(b,c)},c}(j))("DateTime",Date),Date:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.toJsonValue=function(a,b){var c=e(b);return c?c.substring(0,c.indexOf("T")):null},c.prototype.fromJsonValue=function(a,b,c){return f(b,c)},c}(j))("Date",Date),Time:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.toJsonValue=function(a,b){var c=e(b);return c?c.substring(c.indexOf("T")+1):null},c.prototype.fromJsonValue=function(a,b,c){return"string"==typeof b?f("1970-01-01T"+b,c):b},c}(j))("Time",Date),File:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.toJsonValue=function(a,b){return b instanceof i?b.id:null},c.prototype.fromJsonValue=function(a,b,c){return b?c&&c.id==b?c:new a.db.File(b):null},c}(j))("File",i),GeoPoint:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.toJsonValue=function(a,b){return b instanceof h?b:null},c.prototype.fromJsonValue=function(a,b){return b?new h(b):null},c}(j))("GeoPoint",h),JsonArray:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.init=function(a){this._enhancer=a},c.prototype.toJsonValue=function(a,b){return Array.isArray(b)?b:null},c.prototype.fromJsonValue=function(a,b){return Array.isArray(b)?b:null},c}(j))("JsonArray",Array),JsonObject:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.init=function(a){this._enhancer=a},c.prototype.toJsonValue=function(a,b){return b&&b.constructor==Object?b:null},c}(j))("JsonObject",Object)}),c.exports=j},{13:13,5:5,50:50}],38:[function(a,c,d){"use strict";var e=a(47),f=function(a){function c(d,e){b.classCallCheck(this,c);var f=b.possibleConstructorReturn(this,a.call(this,d,e));return f.typeConstructor=null,f}return b.inherits(c,a),b.createClass(c,[{key:"collectionType",get:function(){return e.CollectionType.COLLECTION}}]),c}(e);c.exports=f},{47:47}],39:[function(a,c,d){"use strict";var e=function(){function a(c,d){if(b.classCallCheck(this,a),Object(c)instanceof String){var e={};e[c]=a.ASC,this.keys=[e]}else if(Object(c)instanceof Array)this.keys=c;else{if(!c)throw new Error("The keys parameter must be an String, Object or Array.");this.keys=[c]}this.drop=!1,this.unique=!0===d}return a.prototype.hasKey=function(a){for(var b=0;b<this.keys.length;b++)if(this.keys[b][a])return!0;return!1},a.prototype.toJSON=function(){return{unique:this.unique,keys:this.keys,drop:this.drop}},b.createClass(a,[{key:"isCompound",get:function(){return this.keys.length>1}},{key:"isUnique",get:function(){return this.unique}}]),a}();Object.assign(e,{ASC:"asc",DESC:"desc",GEO:"geo",fromJSON:function(a){return new e(a.keys,a.unique)}}),c.exports=e},{}],40:[function(a,c,d){"use strict";var e=a(43),f=a(50),g=a(20),h=function(a){function c(d,e){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.call(this,d,e))}return b.inherits(c,a),b.createClass(c,[{key:"persistenceType",get:function(){return f.PersistenceType.EMBEDDABLE}}]),c.prototype.createProxyClass=function(){return this._enhancer.createProxy(g.Managed)},c.prototype.createObjectFactory=function(a){return g.ManagedFactory.create(this,a)},c.prototype.toJsonValue=function(b,c,d){return b._root&&c instanceof this.typeConstructor&&!c._metadata._root&&(c._metadata._root=b._root),a.prototype.toJsonValue.call(this,b,c,d)},c.prototype.fromJsonValue=function(b,c,d,e){return c&&(d instanceof this.typeConstructor||(d=this.create()),b._root&&!d._metadata._root&&(d._metadata._root=b._root)),a.prototype.fromJsonValue.call(this,b,c,d,e)},c.prototype.toString=function(){return"EmbeddableType("+this.ref+")"},c}(e);c.exports=h},{20:20,43:43,50:50}],41:[function(a,c,d){"use strict";var e=a(20),f=a(49),g=a(37),h=a(50),i=a(43),j=a(68),k=a(66),l=function(a){function c(d,e,f){b.classCallCheck(this,c);var g=b.possibleConstructorReturn(this,a.call(this,d,f));return g.declaredId=null,g.declaredVersion=null,g.declaredAcl=null,g.superType=e,g.loadPermission=new j,g.updatePermission=new j,g.deletePermission=new j,g.queryPermission=new j,g.schemaSubclassPermission=new j,g.insertPermission=new j,g}return b.inherits(c,a),b.createClass(c,[{key:"persistenceType",get:function(){return h.PersistenceType.ENTITY}},{key:"id",get:function(){return this.declaredId||this.superType.id}},{key:"version",get:function(){return this.declaredVersion||this.superType.version}},{key:"acl",get:function(){return this.declaredAcl||this.superType.acl}}]),c.prototype.createProxyClass=function(){var a=this.superType.typeConstructor;if(a===Object)switch(this.name){case"User":a=e.User;break;case"Role":a=e.Role;break;default:a=e.Entity}return this._enhancer.createProxy(a)},c.prototype.getReferencing=function(a,b){for(var c=Object.assign({},b),d=a.metamodel.entities,e=new Map,f=Object.keys(d),g=Array.isArray(f),h=0,f=g?f:f[Symbol.iterator]();;){var i;if(g){if(h>=f.length)break;i=f[h++]}else{if(h=f.next(),h.done)break;i=h.value}var j=i;if(!(c.classes&&c.classes.indexOf(j)<0))for(var k=d[j],l=k.attributes(),m=Array.isArray(l),n=0,l=m?l:l[Symbol.iterator]();;){var o;if(m){if(n>=l.length)break;o=l[n++]}else{if(n=l.next(),n.done)break;o=n.value}var p=o;if(p.type===this||p.elementType===this){var q=e.get(p.declaringType)||new Set;q.add(p.name),e.set(p.declaringType,q)}}}return e},c.prototype.createObjectFactory=function(a){switch(this.name){case"User":return e.UserFactory.create(this,a);case"Device":return e.DeviceFactory.create(this,a);case"Object":return}return e.EntityFactory.create(this,a)},c.prototype.fromJsonValue=function(c,d,e,f){if("string"==typeof d)return c.db.getReference(d);if(!d||"object"!==(void 0===d?"undefined":b.typeof(d)))return null;f=Object.assign({persisting:!1,onlyMetadata:!1},f);var g=void 0,h=void 0;if(e){var i=k.get(e);d.id&&i.id&&d.id!==i.id||(g=e,h=i)}return g||(g=c.db.getReference(this.typeConstructor,d.id),h=k.get(g)),h.enable(!1),a.prototype.fromJsonValue.call(this,h,d,g,f),h.enable(!0),f.persisting?h.setPersistent():f.onlyMetadata||h.setDirty(),g},c.prototype.toJsonValue=function(b,c,d){d=Object.assign({excludeMetadata:!1,depth:0,persisting:!1},d);var e=!0===d.depth||d.depth>-1,f=c&&k.get(c);if(e&&f&&f.isAvailable){f.enable(!1);var g=a.prototype.toJsonValue.call(this,f,c,Object.assign({},d,{depth:!0===d.depth||d.depth-1}));return f.enable(!0),g}return c instanceof this.typeConstructor?(c.attach(b.db),c.id):null},c.prototype.toString=function(){return"EntityType("+this.ref+")"},c.prototype.toJSON=function(){var b=a.prototype.toJSON.call(this);return b.acl.schemaSubclass=this.schemaSubclassPermission,b.acl.insert=this.insertPermission,b.acl.update=this.updatePermission,b.acl.delete=this.deletePermission,b.acl.query=this.queryPermission,b},c}(i),m=function(a){function c(){b.classCallCheck(this,c);var d=b.possibleConstructorReturn(this,a.call(this,l.Object.ref,null,Object));return d.declaredId=new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.call(this,"id",g.String,!0))}return b.inherits(c,a),c.prototype.getJsonValue=function(a,b,c){return a.id||void 0},c.prototype.setJsonValue=function(a,b,c){this.id||(a.id=c)},c}(f)),d.declaredId.init(d,0),d.declaredId.isId=!0,d.declaredVersion=new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.call(this,"version",g.Integer,!0))}return b.inherits(c,a),c.prototype.getJsonValue=function(a,b,c){return a.version||void 0},c.prototype.setJsonValue=function(a,b,c){c&&(a.version=c)},c}(f)),d.declaredVersion.init(d,1),d.declaredVersion.isVersion=!0,d.declaredAcl=new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.call(this,"acl",g.JsonObject,!0))}return b.inherits(c,a),c.prototype.getJsonValue=function(a,b,c){return a.acl.toJSON()},c.prototype.setJsonValue=function(a,b,c){a.acl.fromJSON(c||{})},c}(f)),d.declaredAcl.init(d,2),d.declaredAcl.isAcl=!0,d.declaredAttributes=[d.declaredId,d.declaredVersion,d.declaredAcl],d}return b.inherits(c,a),b.createClass(c,null,[{key:"ref",get:function(){return"/db/Object"}}]),c}(l);l.Object=m,c.exports=l},{20:20,37:37,43:43,49:49,50:50,66:66,68:68}],42:[function(a,c,d){"use strict";var e=a(47),f=function(a){function c(d,e){b.classCallCheck(this,c);var f=b.possibleConstructorReturn(this,a.call(this,d,e));return f.typeConstructor=Array,f}return b.inherits(c,a),b.createClass(c,[{key:"collectionType",get:function(){return e.CollectionType.LIST}}],[{key:"ref",get:function(){return"/db/collection.List"}}]),c.prototype.getJsonValue=function(a,b,c){var d=this.getValue(b);if(d instanceof this.typeConstructor){for(var e=d.length,f=new Array(e),g=d.__persistedState__||[],h=!d.__persistedState__||g.length!=e,i=new Array(e),j=0;j<e;++j){var k=d[j];i[j]=this.elementType.toJsonValue(a,k,c),f[j]=k,h|=g[j]!==k}return c.persisting&&Object.defineProperty(d,"__persistedState__",{value:f,configurable:!0}),a.isPersistent&&h&&a.setDirty(),i}return null},c.prototype.setJsonValue=function(a,b,c,d){var e=null;if(c){e=this.getValue(b);var f=c.length;e instanceof this.typeConstructor||(e=new this.typeConstructor(f));var g=new Array(f),h=e.__persistedState__||[];f<e.length&&e.splice(f,e.length-f);for(var i=0;i<f;++i){var j=this.elementType.fromJsonValue(a,c[i],h[i],d);g[i]=e[i]=j}d.persisting&&Object.defineProperty(e,"__persistedState__",{value:g,configurable:!0})}this.setValue(b,e)},c.prototype.toJSON=function(){return Object.assign({},a.prototype.toJSON.call(this),{type:c.ref+"["+this.elementType.ref+"]"})},c}(e);c.exports=f},{47:47}],43:[function(a,c,d){"use strict";var e=a(50),f=a(68),g=a(72),h=a(20),i=function(a){function c(d,e){b.classCallCheck(this,c);var g=b.possibleConstructorReturn(this,a.call(this,0!=d.indexOf("/db/")?"/db/"+d:d,e));return g._enhancer=null,g.declaredAttributes=[],g.schemaAddPermission=new f,g.schemaReplacePermission=new f,g.metadata=null,g}return b.inherits(c,a),b.createClass(c,[{key:"validationCode",get:function(){return this._validationCode},set:function(a){this._validationCode=a?g.compile(this,a):null}},{key:"typeConstructor",get:function(){return this._typeConstructor||(this.typeConstructor=this.createProxyClass()),this._typeConstructor},set:function(a){if(this._typeConstructor)throw new Error("Type constructor has already been set.");var b=a.prototype instanceof h.Entity;if(this.isEntity){if(!b)throw new TypeError("Entity classes must extends the Entity class.")}else if(!(a.prototype instanceof h.Managed)||b)throw new TypeError("Embeddable classes must extends the Managed class.");this._enhancer.enhance(this,a),this._typeConstructor=a}}]),c.prototype.init=function(a){this._enhancer=a,this._typeConstructor&&!this._enhancer.getIdentifier(this._typeConstructor)&&this._enhancer.setIdentifier(this._typeConstructor,this.ref)},c.prototype.createProxyClass=function(){},c.prototype.createObjectFactory=function(a){},c.prototype.create=function(){var a=void 0;return a=Object.create(this.typeConstructor.prototype),h.Managed.init(a),a},c.prototype.attributes=function(){var a,b=void 0,c=0,d=this;return this.superType&&(b=this.superType.attributes()),a={},a[Symbol.iterator]=function(){return this},a.next=function(){if(b){var a=b.next();if(!a.done)return a;b=null}return c<d.declaredAttributes.length?{value:d.declaredAttributes[c++],done:!1}:{done:!0}},a},c.prototype.addAttribute=function(a,b){if(this.getAttribute(a.name))throw new Error("An attribute with the name "+a.name+" is already declared.");b=null==a.order?void 0===b?this.declaredAttributes.length:b:a.order,a.init(this,b),this.declaredAttributes.push(a),this._typeConstructor&&"Object"!=this.name&&this._enhancer.enhanceProperty(this._typeConstructor,a)},c.prototype.removeAttribute=function(a){var b=this.declaredAttributes.length;if(this.declaredAttributes=this.declaredAttributes.filter(function(b){return b.name!=a}),b==this.declaredAttributes.length)throw new Error("An Attribute with the name "+a+" is not declared.")},c.prototype.getAttribute=function(a){var b=this.getDeclaredAttribute(a);return!b&&this.superType&&(b=this.superType.getAttribute(a)),b},c.prototype.getDeclaredAttribute=function(a){for(var b=this.declaredAttributes,c=Array.isArray(b),d=0,b=c?b:b[Symbol.iterator]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{if(d=b.next(),d.done)break;e=d.value}var f=e;if(f.name===a||f.order===a)return f}return null},c.prototype.fromJsonValue=function(a,b,c,d){if(b)for(var e=this.attributes(),f=Array.isArray(e),g=0,e=f?e:e[Symbol.iterator]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{if(g=e.next(),g.done)break;h=g.value}var i=h;d.onlyMetadata&&!i.isMetadata||i.setJsonValue(a,c,b[i.name],d)}else c=null;return c},c.prototype.toJsonValue=function(a,b,c){var d=null;if(b instanceof this.typeConstructor){d={};for(var e=this.attributes(),f=Array.isArray(e),g=0,e=f?e:e[Symbol.iterator]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{if(g=e.next(),g.done)break;h=g.value}var i=h;c.excludeMetadata&&i.isMetadata||(d[i.name]=i.getJsonValue(a,b,c))}}return d},c.prototype.toJSON=function(){var a={};a.class=this.ref,this.superType&&(a.superClass=this.superType.ref),this.isEmbeddable&&(a.embedded=!0),this.metadata&&(a.metadata=this.metadata),a.acl={load:this.loadPermission,schemaAdd:this.schemaAddPermission,schemaReplace:this.schemaReplacePermission};for(var b=a.fields={},c=this.declaredAttributes,d=Array.isArray(c),e=0,c=d?c:c[Symbol.iterator]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{if(e=c.next(),e.done)break;f=e.value}var g=f;g.isMetadata||(b[g.name]=g)}return a},c.prototype.references=function(){var a,b=this.attributes(),c=[];return a={},a[Symbol.iterator]=function(){return this},a.next=function(){for(var a=b,d=Array.isArray(a),e=0,a=d?a:a[Symbol.iterator]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{if(e=a.next(),e.done)break;f=e.value}var g=f,h=g.isCollection?g.elementType:g.type;if(h.isEntity)return{done:!1,value:{path:[g.name]}};if(h.isEmbeddable)for(var i=h.references(),j=Array.isArray(i),k=0,i=j?i:i[Symbol.iterator]();;){var l;if(j){if(k>=i.length)break;l=i[k++]}else{if(k=i.next(),k.done)break;l=k.value}var m=l;c.push({done:!1,value:{path:[g.name].concat(m.path)}})}}return c.length?c.pop():{done:!0}},a},c.prototype.hasMetadata=function(a){return this.metadata&&!!this.metadata[a]},c.prototype.getMetadata=function(a){return this.hasMetadata(a)?this.metadata[a]:null},c}(e);c.exports=i},{20:20,50:50,68:68,72:72}],44:[function(a,c,d){"use strict";var e=a(47),f=a(31),g=function(a){function c(d,e,f,g){b.classCallCheck(this,c);var h=b.possibleConstructorReturn(this,a.call(this,d,f,g));return h.keyType=e,h.typeConstructor=Map,h}return b.inherits(c,a),b.createClass(c,[{key:"collectionType",get:function(){return e.CollectionType.MAP}}],[{key:"ref",get:function(){return"/db/collection.Map"}}]),c.prototype.getJsonValue=function(a,b,c){var d=this.getValue(b);if(d instanceof this.typeConstructor){for(var e={},g=d.__persistedState__||{},h=!d.__persistedState__||d.__persistedSize__!==d.size,i={},j=d.entries(),k=Array.isArray(j),l=0,j=k?j:j[Symbol.iterator]();;){var m;if(k){if(l>=j.length)break;m=j[l++]}else{if(l=j.next(),l.done)break;m=l.value}var n=m;if(null===n[0]||void 0===n[0])throw new f("Map keys can't be null nor undefined.");var o=this.keyType.toJsonValue(a,n[0],c);i[o]=this.elementType.toJsonValue(a,n[1],c),e[o]=[n[0],n[1]],h|=(g[o]||[])[1]!==n[1]}return c.persisting&&Object.defineProperties(d,{__persistedState__:{value:e,configurable:!0},__persistedSize__:{value:d.size,configurable:!0}}),a.isPersistent&&h&&a.setDirty(),i}return null},c.prototype.setJsonValue=function(a,b,c,d){var e=null;if(c){e=this.getValue(b),e instanceof this.typeConstructor||(e=new this.typeConstructor);var f={},g=e.__persistedState__||{};e.clear();for(var h in c){var i=g[h]||[],j=this.keyType.fromJsonValue(a,h,i[0],d),k=this.elementType.fromJsonValue(a,c[h],i[1],d);f[h]=[j,k],e.set(j,k)}d.persisting&&Object.defineProperties(e,{__persistedState__:{value:f,configurable:!0},__persistedSize__:{value:e.size,configurable:!0}})}this.setValue(b,e)},c.prototype.toJSON=function(){return Object.assign({},a.prototype.toJSON.call(this),{type:c.ref+"["+this.keyType.ref+","+this.elementType.ref+"]"})},c}(e);c.exports=g},{31:31,47:47}],45:[function(a,c,d){"use strict";var e=(a(37),a(43)),f=a(41),g=a(9),h=a(46),i=a(39),j=a(64),k=a(25).StatusCode,l=a(35),m=function(a){function c(d){b.classCallCheck(this,c);var e=b.possibleConstructorReturn(this,a.call(this));return e.isInitialized=!1,e.entityManagerFactory=d,e.entities=null,e.embeddables=null,e.baseTypes=null,e._enhancer=new g,e}return b.inherits(c,a),c.prototype.init=function(a){if(this.isInitialized)throw new Error("Metamodel is already initialized.");this.fromJSON(a||[]),this.isInitialized=!0},c.prototype._getRef=function(a){var b=void 0;return Object(a)instanceof String?(b=a,0!=b.indexOf("/db/")&&(b="/db/"+a)):b=this._enhancer.getIdentifier(a),b},c.prototype.entity=function(a){var b=this._getRef(a);return b?this.entities[b]:null},c.prototype.baseType=function(a){var b=null;if(Object(a)instanceof String)b=this._getRef(a);else for(var c in this.baseTypes){var d=this.baseTypes[c];if(!d.noResolving&&d.typeConstructor==a){b=c;break}}return b?this.baseTypes[b]:null},c.prototype.embeddable=function(a){var b=this._getRef(a);return b?this.embeddables[b]:null},c.prototype.managedType=function(a){return this.baseType(a)||this.entity(a)||this.embeddable(a)},c.prototype.addType=function(a){var b=void 0;if(a.isBasic?b=this.baseTypes:a.isEmbeddable?(a.init(this._enhancer),b=this.embeddables):a.isEntity&&(a.init(this._enhancer),b=this.entities,null==a.superType&&a.ref!=f.Object.ref&&(a.superType=this.entity(f.Object.ref))),b[a.ref])throw new Error("The type "+a.ref+" is already declared.");return b[a.ref]=a},c.prototype.load=function(){var a=this;if(this.isInitialized)throw new Error("Metamodel is already initialized.");return this.withLock(function(){var b=new l.GetAllSchemas;return a.entityManagerFactory.send(b).then(function(b){return a.init(b.entity),a})})},c.prototype.save=function(a){var b=this;return this._send(a||this.toJSON()).then(function(){return b})},c.prototype.update=function(a){var b=this;return this._send(a).then(function(a){return b.fromJSON(a.entity),b})},c.prototype._send=function(a){var b=this;if(!this.isInitialized)throw new Error("Metamodel is not initialized.");return this.withLock(function(){var c=void 0;return c=a instanceof e?new l.UpdateSchema(a.name,a.toJSON()):new l.UpdateAllSchemas(a),b.entityManagerFactory.send(c)})},c.prototype.toJSON=function(){var a=[];for(var b in this.entities)a.push(this.entities[b]);for(b in this.embeddables)a.push(this.embeddables[b]);return a},c.prototype.fromJSON=function(a){var b=new h,c=b.buildModels(a);this.baseTypes={},this.embeddables={},this.entities={};for(var d in c){var e=c[d];this.addType(e)}},c.prototype.createIndex=function(a,b){b.drop=!1;var c=new l.CreateDropIndex(a,b.toJSON());return this.entityManagerFactory.send(c)},c.prototype.dropIndex=function(a,b){b.drop=!0;var c=new l.CreateDropIndex(a,b.toJSON());return this.entityManagerFactory.send(c)},c.prototype.dropAllIndexes=function(a){var b=new l.DropAllIndexes(a);return this.entityManagerFactory.send(b)},c.prototype.getIndexes=function(a){var b=new l.ListIndexes(a);return this.entityManagerFactory.send(b).then(function(a){return a.entity.map(function(a){return new i(a.keys,a.unique)})},function(a){if(a.status==k.BUCKET_NOT_FOUND||a.status==k.OBJECT_NOT_FOUND)return null;throw a})},c}(j);c.exports=m},{25:25,35:35,37:37,39:39,41:41,43:43,46:46,64:64,9:9}],46:[function(a,c,d){"use strict";var e=a(37),f=a(41),g=a(40),h=a(42),i=a(44),j=a(48),k=a(49),l=a(31),m=function(){function a(){b.classCallCheck(this,a),this.models={},this.modelDescriptors=null;for(var c=Object.keys(e),d=Array.isArray(c),f=0,c=d?c:c[Symbol.iterator]();;){var g;if(d){if(f>=c.length)break;g=c[f++]}else{if(f=c.next(),f.done)break;g=f.value}var h=g,i=e[h];i instanceof e&&(this.models[i.ref]=i)}}return a.prototype.getModel=function(a){return a in this.models?this.models[a]:this.models[a]=this.buildModel(a)},a.prototype.buildModels=function(a){this.modelDescriptors={};for(var b=0,c=void 0;c=a[b];++b)this.modelDescriptors[c.class]=c;for(var d in this.modelDescriptors)try{var e=this.getModel(d);this.buildAttributes(e)}catch(a){throw new l("Can't create model for entity class "+d,a)}return this.getModel(f.Object.ref),this.models},a.prototype.buildModel=function(a){var b=this.modelDescriptors[a],c=void 0;if(a===f.Object.ref)c=new f.Object;else{if(!b)throw new TypeError("No model available for "+a);if(b.embedded)c=new g(a);else{var d=b.superClass||f.Object.ref;c=new f(a,this.getModel(d))}}if(c.metadata={},b){c.metadata=b.metadata||{};var e=b.acl;for(var h in e)c[h+"Permission"].fromJSON(e[h])}return c},a.prototype.buildAttributes=function(a){var b=this.modelDescriptors[a.ref],c=b.fields;for(var d in c){var e=c[d];a.getAttribute(d)||a.addAttribute(this.buildAttribute(e),e.order)}b.validationCode&&(a.validationCode=b.validationCode)},a.prototype.buildAttribute=function(a){var b=a.flags&&(-1!=a.flags.indexOf("METADATA")||-1!=a.flags.indexOf("READONLY")),c=a.name,d=a.type;if(0!==d.indexOf("/db/collection.")){var e=new k(c,this.getModel(d),b);return e.metadata=a.metadata,e}var f=d.substring(0,d.indexOf("[")),g=d.substring(d.indexOf("[")+1,d.indexOf("]")).trim();switch(f){case h.ref:return new h(c,this.getModel(g));case j.ref:return new j(c,this.getModel(g));case i.ref:var l=g.substring(0,g.indexOf(",")).trim();return g=g.substring(g.indexOf(",")+1).trim(),new i(c,this.getModel(l),this.getModel(g));default:throw new TypeError("No collection available for "+d)}},a}();c.exports=m},{31:31,37:37,40:40,41:41,42:42,44:44,48:48,49:49}],47:[function(a,c,d){"use strict";var e=a(36),f=function(a){function c(d,e,f){b.classCallCheck(this,c);var g=b.possibleConstructorReturn(this,a.call(this,d));return g.elementType=e,g.typeConstructor=null,g}return b.inherits(c,a),b.createClass(c,[{key:"persistentAttributeType",get:function(){return e.PersistentAttributeType.ELEMENT_COLLECTION}}]),c}(e);f.CollectionType={COLLECTION:0,LIST:1,MAP:2,SET:3},c.exports=f},{36:36}],48:[function(a,c,d){"use strict";var e=a(47),f=function(a){function c(d,e,f){b.classCallCheck(this,c);var g=b.possibleConstructorReturn(this,a.call(this,d,e,f));return g.typeConstructor=Set,g}return b.inherits(c,a),b.createClass(c,[{key:"collectionType",get:function(){return e.CollectionType.SET}}],[{key:"ref",get:function(){return"/db/collection.Set"}}]),c.prototype.getJsonValue=function(a,b,c){var d=this.getValue(b);if(d instanceof this.typeConstructor){for(var e={},f=d.__persistedState__||{},g=!d.__persistedState__||d.__persistedSize__!==d.size,h=[],i=d,j=Array.isArray(i),k=0,i=j?i:i[Symbol.iterator]();;){var l;if(j){if(k>=i.length)break;l=i[k++]}else{if(k=i.next(),k.done)break;l=k.value}var m=l,n=this.elementType.toJsonValue(a,m,c);h.push(n),e[n]=m,g|=f[n]!==m}return c.persisting&&Object.defineProperties(d,{__persistedState__:{value:e,configurable:!0},__persistedSize__:{value:d.size,configurable:!0}}),a.isPersistent&&g&&a.setDirty(),h}return null},c.prototype.setJsonValue=function(a,b,c,d){var e=null;if(c){e=this.getValue(b),e instanceof this.typeConstructor||(e=new this.typeConstructor);var f={},g=e.__persistedState__||{};e.clear();for(var h=0,i=c.length;h<i;++h){var j=c[h],k=j&&j.id?j.id:j,l=this.elementType.fromJsonValue(a,j,g[k],d);e.add(l),f[k]=l}d.persisting&&Object.defineProperties(e,{__persistedState__:{value:f,configurable:!0},__persistedSize__:{value:e.size,configurable:!0}})}this.setValue(b,e)},c.prototype.toJSON=function(){return Object.assign({},a.prototype.toJSON.call(this),{type:c.ref+"["+this.elementType.ref+"]"})},c}(e);c.exports=f},{47:47}],49:[function(a,c,d){"use strict";var e=a(36),f=a(50),g=function(a){function c(d,e,f){b.classCallCheck(this,c);var g=b.possibleConstructorReturn(this,a.call(this,d,f));return g.type=e,g}return b.inherits(c,a),b.createClass(c,[{key:"typeConstructor",get:function(){return this.type.typeConstructor}},{key:"persistentAttributeType",get:function(){switch(this.type.persistenceType){case f.PersistenceType.BASIC:return e.PersistentAttributeType.BASIC;case f.PersistenceType.EMBEDDABLE:return e.PersistentAttributeType.EMBEDDED;case f.PersistenceType.ENTITY:return e.PersistentAttributeType.ONE_TO_MANY}}}]),c.prototype.getJsonValue=function(a,b,c){return this.type.toJsonValue(a,this.getValue(b),c)},c.prototype.setJsonValue=function(a,b,c,d){this.setValue(b,this.type.fromJsonValue(a,c,this.getValue(b),d))},c.prototype.toJSON=function(){return Object.assign({},a.prototype.toJSON.call(this),{type:this.type.ref})},c}(e);c.exports=g},{36:36,50:50}],50:[function(a,c,d){"use strict";var e=function(){function a(c,d){if(b.classCallCheck(this,a),0!=c.indexOf("/db/"))throw new SyntaxError("Type ref "+c+" is invalid.");this.ref=c,this.name=c.substring(4),this._typeConstructor=d}return b.createClass(a,[{key:"persistenceType",get:function(){return-1}},{key:"isBasic",get:function(){return this.persistenceType==a.PersistenceType.BASIC}},{key:"isEmbeddable",get:function(){return this.persistenceType==a.PersistenceType.EMBEDDABLE}},{key:"isEntity",
get:function(){return this.persistenceType==a.PersistenceType.ENTITY}},{key:"isMappedSuperclass",get:function(){return this.persistenceType==a.PersistenceType.MAPPED_SUPERCLASS}},{key:"typeConstructor",get:function(){return this._typeConstructor},set:function(a){if(this._typeConstructor)throw new Error("typeConstructor has already been set.");this._typeConstructor=a}}]),a.prototype.fromJsonValue=function(a,b,c,d){},a.prototype.toJsonValue=function(a,b,c){},a}();e.PersistenceType={BASIC:0,EMBEDDABLE:1,ENTITY:2,MAPPED_SUPERCLASS:3},c.exports=e},{}],51:[function(a,b,c){"use strict";var d=a(45);d.prototype.Attribute=a(36),d.prototype.BasicType=a(37),d.prototype.CollectionAttribute=a(38),d.prototype.EmbeddableType=a(40),d.prototype.EntityType=a(41),d.prototype.ListAttribute=a(42),d.prototype.ManagedType=a(43),d.prototype.MapAttribute=a(44),d.prototype.Metamodel=a(45),d.prototype.ModelBuilder=a(46),d.prototype.PluralAttribute=a(47),d.prototype.SetAttribute=a(48),d.prototype.SingularAttribute=a(49),d.prototype.Type=a(50),d.prototype.DbIndex=a(39),b.exports=new d},{36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49,50:50}],52:[function(a,c,d){"use strict";var e=a(53),f=a(66),g=a(35),h=function(a){function c(d,e){b.classCallCheck(this,c);var f=b.possibleConstructorReturn(this,a.call(this,e));return f._entity=d,f}return b.inherits(c,a),c.prototype.execute=function(){var a=this,b=f.get(this._entity),c=JSON.stringify(this),d=new g.UpdatePartially(b.bucket,b.key,c);return b.withLock(function(){return b.db.send(d).then(function(c){return b.setJson(c.entity,!0),a._entity})})},c}(e);c.exports=h},{35:35,53:53,66:66}],53:[function(a,c,d){"use strict";var e=["$add","$and","$currentDate","$dec","$inc","$max","$min","$mul","$or","$pop","$push","$put","$remove","$rename","$replace","$set","$shift","$unshift","$xor"],f=a(54),g=function(){function a(c){b.classCallCheck(this,a),this._operations=[],c&&this._addOperations(c)}return a.prototype.set=function(a,b){if(b instanceof Set)b=Array.from(b);else if(b instanceof Map){var c={};b.forEach(function(a,b){c[b]=a}),b=c}return this._addOperation(a,"$set",b)},a.prototype.inc=function(a,b){return this._addOperation(a,"$inc","number"==typeof b?b:1)},a.prototype.dec=function(a,b){return this.increment(a,"number"==typeof b?-b:-1)},a.prototype.mul=function(a,b){if("number"!=typeof b)throw new Error("Multiplicator must be a number.");return this._addOperation(a,"$mul",b)},a.prototype.div=function(a,b){if("number"!=typeof b)throw new Error("Divisor must be a number.");return this._addOperation(a,"$mul",1/b)},a.prototype.min=function(a,b){if("number"!=typeof b)throw new Error("Value must be a number");return this._addOperation(a,"$min",b)},a.prototype.max=function(a,b){if("number"!=typeof b)throw new Error("Value must be a number");return this._addOperation(a,"$max",b)},a.prototype.remove=function(a,b){return this._addOperation(a,"$remove",b)},a.prototype.put=function(a,c,d){var e={};return"string"==typeof c||"number"==typeof c?e[c]=d:"object"===(void 0===c?"undefined":b.typeof(c))&&Object.assign(e,c),this._addOperation(a,"$put",e)},a.prototype.push=function(a,b){return this._addOperation(a,"$push",b)},a.prototype.unshift=function(a,b){return this._addOperation(a,"$unshift",b)},a.prototype.pop=function(a){return this._addOperation(a,"$pop")},a.prototype.shift=function(a){return this._addOperation(a,"$shift")},a.prototype.add=function(a,b){return this._addOperation(a,"$add",b)},a.prototype.replace=function(a,b,c){if(this._hasOperationOnPath(a))throw new Error("You cannot update "+a+" multiple times");return this._addOperation(a+"."+b,"$replace",c)},a.prototype.currentDate=function(a){return this._addOperation(a,"$currentDate")},a.prototype.and=function(a,b){return this._addOperation(a,"$and",b)},a.prototype.or=function(a,b){return this._addOperation(a,"$or",b)},a.prototype.xor=function(a,b){return this._addOperation(a,"$xor",b)},a.prototype.rename=function(a,b){return this._addOperation(a,"$rename",b)},a.prototype.toJSON=function(){return this._operations.reduce(function(a,b){var c={};return c[b.path]=b.value,a[b.name]=Object.assign({},a[b.name],c),a},{})},a.prototype.execute=function(){throw new Error('Cannot call "execute" on abstract PartialUpdateBuilder')},a.prototype._addOperation=function(a,b,c){if("string"!=typeof a)throw new Error("Path must be a string");if(-1===e.indexOf(b))throw new Error("Operation invalid: "+b);if(this._hasOperationOnPath(a))throw new Error("You cannot update "+a+" multiple times");if("number"==typeof c){if(isNaN(c))throw new Error("NaN is not a supported value");if(!isFinite(c))throw new Error("Infinity is not a supported value")}var d=void 0===c?null:c,g=new f(b,a,d);return this._operations.push(g),this},a.prototype._addOperations=function(a){var b=this;Object.keys(a).forEach(function(c){var d=a[c];Object.keys(d).forEach(function(a){var e=d[a];b._operations.push(new f(c,a,e))})})},a.prototype._hasOperationOnPath=function(a){return this._operations.some(function(b){return b.path===a})},a}();Object.assign(g.prototype,{increment:g.prototype.inc,decrement:g.prototype.dec,multiply:g.prototype.mul,divide:g.prototype.div,atMost:g.prototype.min,atLeast:g.prototype.max,toNow:g.prototype.currentDate}),c.exports=g},{54:54}],54:[function(a,c,d){"use strict";var e=function a(c,d,e){b.classCallCheck(this,a),this.name=c,this.path=d,this.value=e};c.exports=e},{}],55:[function(a,b,c){"use strict";c.EntityPartialUpdateBuilder=a(52),c.PartialUpdateBuilder=a(53)},{52:52,53:53}],56:[function(a,c,d){"use strict";var e=a(58),f=a(57),g=a(60),h=a(61),i=h.varargs,j=function(a){function c(d,e){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.call(this,d,e))}return b.inherits(c,a),c.prototype.and=function(a){return this._addOperator("$and",i(0,arguments))},c.prototype.or=function(a){return this._addOperator("$or",i(0,arguments))},c.prototype.nor=function(a){return this._addOperator("$nor",i(0,arguments))},c.prototype.eventStream=function(a,b,c,d){return this.where({}).eventStream(a,b,c,d)},c.prototype.resultStream=function(a,b,c,d){return this.where({}).resultStream(a,b,c,d)},c.prototype.resultList=function(a,b,c){return this.where({}).resultList(a,b,c)},c.prototype.singleResult=function(a,b,c){return this.where({}).singleResult(a,b,c)},c.prototype.count=function(a,b){return this.where({}).count(a,b)},c.prototype._addOperator=function(a,b){if(b.length<2)throw new Error("Only two or more queries can be joined with an "+a+" operator.");return b.forEach(function(a,b){if(!(a instanceof h))throw new Error("Argument at index "+b+" is not a query.")}),new g(this.entityManager,this.resultClass,a,b)},c.prototype._addOrder=function(a,b){return new e(this.entityManager,this.resultClass)._addOrder(a,b)},c.prototype._addFilter=function(a,b,c){return new e(this.entityManager,this.resultClass)._addFilter(a,b,c)},c.prototype._addOffset=function(a){return new e(this.entityManager,this.resultClass)._addOffset(a)},c.prototype._addLimit=function(a){return new e(this.entityManager,this.resultClass)._addLimit(a)},c}(h);Object.assign(j.prototype,f),c.exports=j},{57:57,58:58,60:60,61:61}],57:[function(a,b,c){"use strict";var d=a(61).varargs,e={};Object.assign(e,{where:function(a){return this._addFilter(null,null,a)},equal:function(a,b){return this._addFilter(a,null,b)},notEqual:function(a,b){return this._addFilter(a,"$ne",b)},greaterThan:function(a,b){return this._addFilter(a,"$gt",b)},greaterThanOrEqualTo:function(a,b){return this._addFilter(a,"$gte",b)},lessThan:function(a,b){return this._addFilter(a,"$lt",b)},lessThanOrEqualTo:function(a,b){return this._addFilter(a,"$lte",b)},between:function(a,b,c){return this._addFilter(a,"$gt",b)._addFilter(a,"$lt",c)},in:function(a,b){return this._addFilter(a,"$in",d(1,arguments))},notIn:function(a,b){return this._addFilter(a,"$nin",d(1,arguments))},isNull:function(a){return this.equal(a,null)},isNotNull:function(a){return this._addFilter(a,"$exists",!0)._addFilter(a,"$ne",null)},containsAll:function(a,b){return this._addFilter(a,"$all",d(1,arguments))},mod:function(a,b,c){return this._addFilter(a,"$mod",[b,c])},matches:function(a,b){if(Object(b)instanceof RegExp||(b=new RegExp(b)),b.ignoreCase)throw new Error("RegExp.ignoreCase flag is not supported.");if(b.global)throw new Error("RegExp.global flag is not supported.");if(0!=b.source.indexOf("^"))throw new Error("regExp must be an anchored expression, i.e. it must be started with a ^.");var c=this._addFilter(a,"$regex",b.source);return b.multiline&&c._addFilter(a,"$options","m"),c},size:function(a,b){return this._addFilter(a,"$size",b)},near:function(a,b,c){return this._addFilter(a,"$nearSphere",{$geometry:{type:"Point",coordinates:[b.longitude,b.latitude]},$maxDistance:c})},withinPolygon:function(a,b){return b=d(1,arguments),this._addFilter(a,"$geoWithin",{$geometry:{type:"Polygon",coordinates:[b.map(function(a){return[a.longitude,a.latitude]})]}})}}),Object.assign(e,{eq:e.equal,ne:e.notEqual,lt:e.lessThan,le:e.lessThanOrEqualTo,gt:e.greaterThan,ge:e.greaterThanOrEqualTo,containsAny:e.in}),b.exports=e},{61:61}],58:[function(a,c,d){"use strict";var e=a(59),f=a(57),g=function(a){function c(d,e){b.classCallCheck(this,c);var f=b.possibleConstructorReturn(this,a.call(this,d,e));return f._filter={},f}return b.inherits(c,a),c.prototype._addFilter=function(a,b,c){if(null!==a){if(!(Object(a)instanceof String))throw new Error("Field must be a string.");if(b){var d=this._filter[a];d instanceof Object&&Object.getPrototypeOf(d)==Object.prototype||(this._filter[a]=d={}),d[b]=c}else this._filter[a]=c}else Object.assign(this._filter,c);return this},c.prototype.toJSON=function(){return this._filter},c}(e);Object.assign(g.prototype,f),c.exports=g},{57:57,59:59}],59:[function(a,c,d){"use strict";var e=a(61),f=a(35),g=a(66),h=a(10),i=function(a){function c(d,e){b.classCallCheck(this,c);var f=b.possibleConstructorReturn(this,a.call(this,d,e));return f.firstResult=0,f.maxResults=-1,f._sort={},f}return b.inherits(c,a),c.prototype.eventStream=function(){throw new Error("Streaming features not available! Please use Streaming SDK!")},c.prototype.resultStream=function(){throw new Error("Streaming features not available! Please use Streaming SDK!")},c.prototype.resultList=function(a,b,c){var d=this;a instanceof Function&&(c=b,b=a,a={});var g=this.resultClass?this.entityManager.metamodel.entity(this.resultClass):null;if(!g)throw new Error("Only typed queries can be executed.");var h=this._serializeQuery(),i=this._serializeSort(),j=this.entityManager._connector.host.length+h.length+i.length,k=void 0;return k=j>e.MAX_URI_SIZE?new f.AdhocQueryPOST(g.name,this.firstResult,this.maxResults,i).entity(h,"text"):new f.AdhocQuery(g.name,h,this.firstResult,this.maxResults,i),this.entityManager.send(k).then(function(b){return d._createResultList(b.entity,a)}).then(b,c)},c.prototype.singleResult=function(a,b,c){var d=this;a instanceof Function&&(c=b,b=a,a={});var g=this.resultClass?this.entityManager.metamodel.entity(this.resultClass):null;if(!g)throw new Error("Only typed queries can be executed.");var h=this._serializeQuery(),i=this._serializeSort(),j=this.entityManager._connector.host.length+h.length,k=void 0;return k=j>e.MAX_URI_SIZE?new f.AdhocQueryPOST(g.name,h,this.firstResult,1,i).entity(h,"text"):new f.AdhocQuery(g.name,h,this.firstResult,1,i),this.entityManager.send(k).then(function(b){return d._createResultList(b.entity,a)}).then(function(a){return a.length?a[0]:null}).then(b,c)},c.prototype.count=function(a,b){var c=this.resultClass?this.entityManager.metamodel.entity(this.resultClass):null;if(!c)throw new Error("Only typed queries can be executed.");var d=this._serializeQuery(),g=this.entityManager._connector.host.length+d.length,h=void 0;return h=g>e.MAX_URI_SIZE?new f.AdhocCountQueryPOST(c.name).entity(d,"text"):new f.AdhocCountQuery(c.name,d),this.entityManager.send(h).then(function(a){return a.entity.count}).then(a,b)},c.prototype._serializeQuery=function(){return JSON.stringify(this,function(a,b){var c=this[a];return Object(c)instanceof Date?{$date:b}:c instanceof h?c.id:b})},c.prototype._serializeSort=function(){return JSON.stringify(this._sort)},c.prototype._createResultList=function(a,b){return a.length?Promise.all(a.map(function(a){if(a.id){var c=this.entityManager.getReference(this.resultClass,a.id);return g.get(c).setJson(a,{persisting:!0}),this.entityManager.resolveDepth(c,b)}return this.entityManager.load(Object.keys(a)[0])},this)).then(function(a){return a.filter(function(a){return!!a})}):Promise.resolve([])},c.prototype._addOrder=function(a,b){return b?this._sort[a]=b:this._sort=a,this},c.prototype._addOffset=function(a){return this.firstResult=a,this},c.prototype._addLimit=function(a){return this.maxResults=a,this},c}(e);c.exports=i},{10:10,35:35,61:61,66:66}],60:[function(a,c,d){"use strict";var e=a(59),f=function(a){function c(d,e,f,g){b.classCallCheck(this,c);var h=b.possibleConstructorReturn(this,a.call(this,d,e));return h._operator=f,h._childs=g,h}return b.inherits(c,a),c.prototype.toJSON=function(){var a={};return a[this._operator]=this._childs,a},c}(e);c.exports=f},{59:59}],61:[function(a,c,d){"use strict";var e=function(){function a(c,d){b.classCallCheck(this,a),this.entityManager=c,this.resultClass=d}return a.prototype.ascending=function(a){return this._addOrder(a,1)},a.prototype.descending=function(a){return this._addOrder(a,-1)},a.prototype.sort=function(a){if(!(a instanceof Object)||Object.getPrototypeOf(a)!=Object.prototype)throw new Error("sort must be an object.");return this._addOrder(a)},a.prototype.offset=function(a){if(a<0)throw new Error("The offset can't be nagative.");return this._addOffset(a)},a.prototype.limit=function(a){if(a<0)throw new Error("The limit can't be nagative.");return this._addLimit(a)},a.prototype.resultList=function(a,b,c){},a.prototype.singleResult=function(a,b,c){},a.prototype.eventStream=function(a){},a.prototype.resultStream=function(a){},a.prototype.count=function(a,b){},a}();e.MAX_URI_SIZE=2e3,e.varargs=function(a,b){return Array.prototype.concat.apply([],Array.prototype.slice.call(b,a))},c.exports=e},{}],62:[function(a,b,c){"use strict";c.Builder=a(56),c.Condition=a(57),c.Filter=a(58),c.Node=a(59),c.Operator=a(60),c.Query=a(61)},{56:56,57:57,58:58,59:59,60:60,61:61}],63:[function(a,c,d){"use strict";var e=a(35),f=a(25).StatusCode,g=function(){function a(c,d){b.classCallCheck(this,a),this._metamodel=c,this.entityManagerFactory=d}return a.prototype.functionToString=function(a){if(!a)return"";var b=a.toString();return b=b.substring(b.indexOf("{")+1,b.lastIndexOf("}")),"\n"==b.charAt(0)&&(b=b.substring(1)),"\n"==b.charAt(b.length-1)&&(b=b.substring(0,b.length-1)),b},a.prototype.stringToFunction=function(a,b){return new Function(a,b)},a.prototype.loadModules=function(){var a=new e.GetAllModules;return this.entityManagerFactory.send(a).then(function(a){return a.entity})},a.prototype.loadCode=function(a,b,c){var d=this,g=Object(a)instanceof String?a:a.name,h=new e.GetBaqendCode(g,b).responseType("text");return this.entityManagerFactory.send(h).then(function(a){return d._parseCode(g,b,c,a.entity)},function(a){if(a.status==f.OBJECT_NOT_FOUND)return null;throw a})},a.prototype.saveCode=function(a,b,c){var d=this,f=Object(a)instanceof String?a:a.name,g=c instanceof Function,h=new e.SetBaqendCode(f,b).entity(g?this.functionToString(c):c,"text").responseType("text");return this.entityManagerFactory.send(h).then(function(a){return d._parseCode(f,b,g,a.entity)})},a.prototype.deleteCode=function(a,b){var c=this,d=Object(a)instanceof String?a:a.name,f=new e.DeleteBaqendCode(d,b);return this.entityManagerFactory.send(f).then(function(){return c._parseCode(d,b,!1,null)})},a.prototype._parseCode=function(a,b,c,d){if("validate"==b){var e=this._metamodel.entity(a);return e.validationCode=d,c?e.validationCode:d}return c?this.stringToFunction(["module","exports"],d):d},a}();c.exports=g},{25:25,35:35}],64:[function(a,c,d){"use strict";var e=function(){function a(){b.classCallCheck(this,a),this._isLocked=!1,this._readyPromise=Promise.resolve(this),this._deferred=null}return a.prototype.ready=function(a,b){return this._readyPromise.then(a,b)},a.prototype.withLock=function(a,b){var c=this;if(this._isLocked)throw new Error("Current operation has not been finished.");try{this._isLocked=!0;var d=a().then(function(a){return c._isLocked=!1,a},function(a){throw b||(c._isLocked=!1),a});return this._readyPromise=d.then(function(){return c},function(a){if(!b)return c;throw a}),d}catch(a){throw b?this._readyPromise=Promise.reject(a):this._isLocked=!1,a}},b.createClass(a,[{key:"isReady",get:function(){return!this._isLocked}}]),a}();c.exports=e},{}],65:[function(a,c,d){"use strict";var e=a(35),f=(a(25).StatusCode,function(){function a(){b.classCallCheck(this,a)}return a.create=function(a){function b(){c.log.apply(b,arguments)}for(var c=this.prototype,d=Object.getOwnPropertyNames(c),e=Array.isArray(d),f=0,d=e?d:d[Symbol.iterator]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{if(f=d.next(),f.done)break;g=f.value}var h=g;Object.defineProperty(b,h,Object.getOwnPropertyDescriptor(c,h))}return b._init(a),b},a.prototype.log=function(c,d,e){var f=Array.prototype.slice.call(arguments);if(c=-1==a.LEVELS.indexOf(f[0])?"info":f.shift(),!(this.levelIndex>a.LEVELS.indexOf(c)))return d="string"==typeof f[0]?this._format(f.shift(),f):"[no message]",e=null,f.length&&"object"===b.typeof(f[f.length-1])&&(e=f.pop(),Array.isArray(e)&&(e={data:e})),f.length&&(d+=", "+f.join(", ")),this._log({date:new Date,message:d,level:c,user:this.entityManager.me&&this.entityManager.me.id,data:e})},a.prototype._format=function(b,c){return 0==c.length?b:String(b).replace(a.FORMAT_REGEXP,function(a){if("%%"===a)return"%";if(!c.length)return a;switch(a){case"%s":return String(c.shift());case"%d":return Number(c.shift());case"%j":try{return JSON.stringify(c.shift())}catch(a){return"[Circular]"}default:return a}})},a.prototype._init=function(b){var c=this;this.entityManager=b,this.levelIndex=2,a.LEVELS.forEach(function(a){c[a]=c.log.bind(c,a)})},a.prototype._log=function(a){return this.entityManager.isReady?this.entityManager.send(new e.CreateObject("logs.AppLog",a)):this.entityManager.ready(this._log.bind(this,a))},b.createClass(a,[{key:"level",get:function(){return a.LEVELS[this.levelIndex]},set:function(b){var c=a.LEVELS.indexOf(b);if(-1==c)throw new Error("Unknown logging level "+b);this.levelIndex=c}}]),a}());Object.assign(f,{LEVELS:["trace","debug","info","warn","error"],FORMAT_REGEXP:/%[sdj%]/g}),c.exports=f},{25:25,35:35}],66:[function(a,c,d){"use strict";var e=a(33),f=a(1),g=a(64),h=(a(20),function(c){function d(a,e){b.classCallCheck(this,d);var g=b.possibleConstructorReturn(this,c.call(this));return g._root=a,g._state=d.Type.DIRTY,g._enabled=!0,g.id=null,g.version=null,g.type=e,g.acl=new f(g),g}return b.inherits(d,c),d.create=function(a,b){var c=void 0;if(a.isEntity)c=new d(b,a);else{if(!a.isEmbeddable)throw new Error("Illegal type "+a);c={type:a,readAccess:function(){var a=this._root&&this._root._metadata;a&&a.readAccess()},writeAccess:function(){var a=this._root&&this._root._metadata;a&&a.writeAccess()}}}return c},d.get=function(a){return a._metadata},b.createClass(d,[{key:"db",get:function(){return this._db?this._db:this._db=a(6)},set:function(a){if(this._db)throw new Error("DB has already been set.");this._db=a}},{key:"bucket",get:function(){return this.type.name}},{key:"key",get:function(){if(!this._key&&this.id){var a=this.id.lastIndexOf("/");this._key=decodeURIComponent(this.id.substring(a+1))}return this._key},set:function(a){if(a+="",this.id)throw new Error("The id can't be set twice.");this.id="/db/"+this.bucket+"/"+encodeURIComponent(a),this._key=a}},{key:"isAttached",get:function(){return!!this._db}},{key:"isAvailable",get:function(){return this._state>d.Type.UNAVAILABLE}},{key:"isPersistent",get:function(){return this._state==d.Type.PERSISTENT}},{key:"isDirty",get:function(){return this._state==d.Type.DIRTY}}]),d.prototype.enable=function(a){this._enabled=a},d.prototype.readAccess=function(){if(this._enabled&&!this.isAvailable)throw new e.PersistentError("This object "+this.id+" is not available.")},d.prototype.writeAccess=function(){if(this._enabled){if(!this.isAvailable)throw new e.PersistentError("This object "+this.id+" is not available.");this.setDirty()}},d.prototype.setUnavailable=function(){this._state=d.Type.UNAVAILABLE},d.prototype.setPersistent=function(){this._state=d.Type.PERSISTENT},d.prototype.setDirty=function(){this._state=d.Type.DIRTY},d.prototype.setRemoved=function(){this.isAvailable&&(this.setDirty(),this.version=null)},d.prototype.getJson=function(a){return this.type.toJsonValue(this,this._root,a)},d.prototype.setJson=function(a,b){this.type.fromJsonValue(this,a,this._root,b)},d}(g));h.Type={UNAVAILABLE:-1,PERSISTENT:0,DIRTY:1},c.exports=h},{1:1,20:20,33:33,6:6,64:64}],67:[function(a,c,d){"use strict";var e=a(35),f=function(){function a(c,d){b.classCallCheck(this,a),this._entityManager=c,this._connector=d}return a.prototype.get=function(a,b,c,d,f){b instanceof Function&&(f=c,d=b,c={},b=null),c instanceof Function&&(f=d,d=c,c={}),c=c||{};var g=new e.GetBaqendModule(a).addQueryString(b).responseType(c.responseType||null);return this._send(g,d,f)},a.prototype.post=function(a,b,c,d,f){c instanceof Function&&(f=d,d=c,c={}),c=c||{};var g=new e.PostBaqendModule(a).entity(b,c.requestType).mimeType(c.mimeType||null).responseType(c.responseType||null);return this._send(g,d,f)},a.prototype._send=function(a,b,c){return this._entityManager.send(a).then(function(a){return a.entity}).then(b,c)},a}();c.exports=f},{35:35}],68:[function(a,c,d){"use strict";var e=function(){function a(c){b.classCallCheck(this,a),this._rules={},this._metadata=c}return a.prototype.allRules=function(){return Object.keys(this._rules)},a.prototype.clear=function(){this._metadata&&this._metadata.writeAccess(),this._rules={}},a.prototype.copy=function(a){return this._metadata&&this._metadata.writeAccess(),this._rules=Object.assign({},a._rules),this},a.prototype.isPublicAllowed=function(){if("*"in this._rules)return!1;for(var a in this._rules)if("allow"==this._rules[a])return!1;return!0},a.prototype.setPublicAllowed=function(){this._metadata&&this._metadata.writeAccess();for(var a in this._rules)"allow"==this._rules[a]&&delete this._rules[a]},a.prototype.getRule=function(a){return this._rules[this._getRef(a)]},a.prototype.isAllowed=function(a){return"allow"==this._rules[this._getRef(a)]},a.prototype.isDenied=function(a){return"deny"==this._rules[this._getRef(a)]},a.prototype.allowAccess=function(a){var b=arguments;this._metadata&&this._metadata.writeAccess();for(var c=0;c<b.length;c++)this._rules[this._getRef(b[c])]="allow";return this},a.prototype.denyAccess=function(a){var b=arguments;this._metadata&&this._metadata.writeAccess();for(var c=0;c<b.length;c++)this._rules[this._getRef(b[c])]="deny";return this},a.prototype.deleteAccess=function(a){var b=arguments;this._metadata&&this._metadata.writeAccess();for(var c=0;c<b.length;c++)delete this._rules[this._getRef(b[c])];return this},a.prototype.toJSON=function(){return Object.assign({},this._rules)},a.prototype.fromJSON=function(a){this._rules=a},a.fromJSON=function(a){var b=new this;return b.fromJSON(a),b},a.prototype._getRef=function(a){if("string"!=typeof a&&(a=a._metadata.id),0==a.indexOf("/db/User/")||0==a.indexOf("/db/Role/"))return a;throw new TypeError("The given object isn't a user, role or a valid reference.")},a}();e.BASE_PERMISSIONS=["load","update","delete","query","insert"],c.exports=e},{}],69:[function(a,c,d){"use strict";var e=a(10),f=function(){function a(c,d,f,g){if(b.classCallCheck(this,a),g=g||{},"string"==typeof g&&(g={sound:g,badge:arguments[4],data:arguments[5]}),this.devices=null,c instanceof Set)this.devices=c;else if(!c||c[Symbol.iterator])this.devices=new Set(c);else{if(!(c instanceof e))throw new Error("Only Sets, Lists and Arrays can be used as devices.");this.devices=new Set,this.devices.add(c)}this.message=d,this.subject=f,Object.assign(this,g)}return a.prototype.addDevice=function(a){this.devices||(this.devices=new Set),this.devices.add(a)},a.prototype.toJSON=function(){if(!this.devices||!this.devices.size)throw new Error("Set of devices is empty.");return Object.assign({},this,{devices:Array.from(this.devices,function(a){return a.id})})},a}();c.exports=f},{10:10}],70:[function(a,c,d){"use strict";var e=a(74).hmac,f=function(){function a(c,d,e){b.classCallCheck(this,a),this._token=d?a.parse(d):null,this._origin=c,this.temporary=e}return a.parse=function(a){return{val:a,createdAt:1e3*parseInt(a.substring(0,8),16),expireAt:1e3*parseInt(a.substring(8,16),16),sig:a.substring(a.length-40),data:a.substring(0,a.length-40)}},a.create=function(b){return Promise.resolve(new a(b))},b.createClass(a,[{key:"token",get:function(){return this._token?this._token.val:null}}]),a.prototype._saveToken=function(a,b,c){},a.prototype.update=function(b){var c=b?a.parse(b):null;this._token&&c&&this._token.expireAt>c.expireAt||(this._token=c,this._saveToken(this._origin,b,this.temporary))},a.prototype.signPath=function(a){if(this._token){var b=a.split("/").map(encodeURIComponent).join("/");return b+"?BAT="+(this._token.data+e(b+this._token.data,this._token.sig))}return a},a}(),g={},h=function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.create=function(a){return Promise.resolve(new c(a,g[a]))},c.prototype._saveToken=function(a,b,c){c||(b?g[a]=b:delete g[a])},c}(f);f.GLOBAL=h;var i=function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.isAvailable=function(){try{return"undefined"!=typeof localStorage&&(localStorage.setItem("bq_webstorage_test","bq"),localStorage.removeItem("bq_webstorage_test"),!0)}catch(a){}return!1},c.create=function(a){var b=!1,d=localStorage.getItem("BAT:"+a);return d||"undefined"==typeof sessionStorage||(d=sessionStorage.getItem("BAT:"+a),b=!!d),Promise.resolve(new c(a,d,b))},c.prototype._saveToken=function(a,b,c){var d=c?sessionStorage:localStorage;b?d.setItem("BAT:"+a,b):d.removeItem("BAT:"+a)},c}(f);i.isAvailable()&&(f.WEB_STORAGE=i),c.exports=f},{74:74}],71:[function(a,c,d){"use strict";var e=function(){function a(){b.classCallCheck(this,a),this.fields={}}return b.createClass(a,[{key:"isValid",get:function(){for(var a in this.fields)if(!this.fields[a].isValid)return!1;return!0}}]),a.prototype.toJSON=function(){var a={};for(var b in this.fields)a[b]=this.fields[b].toJSON();return a},a}();c.exports=e},{}],72:[function(a,c,d){"use strict";var e=a(175),f=(a(71),function(){function a(c,d){b.classCallCheck(this,a),this.key=c,this._entity=d,this.errors=[]}return a.compile=function(a,b){for(var c=[],d=a.attributes(),e=Array.isArray(d),f=0,d=e?d:d[Symbol.iterator]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{if(f=d.next(),f.done)break;g=f.value}var h=g;c.push(h.name)}var i=new Function(c,b);return function(a){var b=c.map(function(b){return a[b]});return i.apply({},b)}},a.prototype.is=function(a,b){return a instanceof Function&&(b=a,a="is"),!1===b(this.value,e)&&this.errors.push(a),this},b.createClass(a,[{key:"value",get:function(){return this._entity[this.key]}},{key:"isValid",get:function(){return 0==this.errors.length}}]),a.prototype._callMethod=function(a,b,c){return c=c||[],c.unshift(this.value),!1===e[a].apply(this,c)&&this.errors.push(b),this},a.prototype.toString=function(){return this.value},a.prototype.toJSON=function(){return{isValid:this.isValid,errors:this.errors}},a}());Object.keys(e).forEach(function(a){"function"==typeof e[a]&&"toString"!==a&&"toDate"!==a&&"extend"!==a&&"init"!==a&&(f.prototype[a]=function(b){return this._callMethod(a,b||a,Array.prototype.slice.call(arguments,b?1:0))})}),c.exports=f},{175:175,71:71}],73:[function(a,b,c){"use strict";c.atob=atob},{}],74:[function(a,b,c){"use strict";c.hmac=a(168)},{168:168}],75:[function(a,b,c){"use strict";c.isNode=a(76).isNode,c.atob=a(73).atob,c.hmac=a(74).hmac,c.Metadata=a(66),c.Permission=a(68),c.Validator=a(72),c.ValidationResult=a(71),c.Code=a(63),c.Modules=a(67),c.Lockable=a(64),c.Logger=a(65),c.PushMessage=a(69),c.TokenStorage=a(70),c.uuid=a(77).uuid},{63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73,74:74,76:76,77:77}],76:[function(a,b,c){"use strict";c.isNode=!1},{}],77:[function(a,b,c){"use strict";c.uuid=a(174)},{174:174}],78:[function(a,b,c){"use strict"},{}],79:[function(a,b,c){b.exports=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a}},{}],80:[function(a,b,c){var d=a(155)("unscopables"),e=Array.prototype;void 0==e[d]&&a(101)(e,d,{}),b.exports=function(a){e[d][a]=!0}},{101:101,155:155}],81:[function(a,b,c){b.exports=function(a,b,c,d){if(!(a instanceof b)||void 0!==d&&d in a)throw TypeError(c+": incorrect invocation!");return a}},{}],82:[function(a,b,c){var d=a(109);b.exports=function(a){if(!d(a))throw TypeError(a+" is not an object!");return a}},{109:109}],83:[function(a,b,c){var d=a(146),e=a(147),f=a(144);b.exports=function(a){return function(b,c,g){var h,i=d(b),j=e(i.length),k=f(g,j);if(a&&c!=c){for(;j>k;)if((h=i[k++])!=h)return!0}else for(;j>k;k++)if((a||k in i)&&i[k]===c)return a||k||0;return!a&&-1}}},{144:144,146:146,147:147}],84:[function(a,b,c){var d=a(85),e=a(155)("toStringTag"),f="Arguments"==d(function(){return arguments}()),g=function(a,b){try{return a[b]}catch(a){}};b.exports=function(a){var b,c,h;return void 0===a?"Undefined":null===a?"Null":"string"==typeof(c=g(b=Object(a),e))?c:f?d(b):"Object"==(h=d(b))&&"function"==typeof b.callee?"Arguments":h}},{155:155,85:85}],85:[function(a,b,c){var d={}.toString;b.exports=function(a){return d.call(a).slice(8,-1)}},{}],86:[function(a,b,c){"use strict";var d=a(122).f,e=a(121),f=a(135),g=a(90),h=a(81),i=a(98),j=a(112),k=a(114),l=a(138),m=a(92),n=a(117).fastKey,o=a(152),p=m?"_s":"size",q=function(a,b){var c,d=n(b);if("F"!==d)return a._i[d];for(c=a._f;c;c=c.n)if(c.k==b)return c};b.exports={getConstructor:function(a,b,c,j){var k=a(function(a,d){h(a,k,b,"_i"),a._t=b,a._i=e(null),a._f=void 0,a._l=void 0,a[p]=0,void 0!=d&&i(d,c,a[j],a)});return f(k.prototype,{clear:function(){for(var a=o(this,b),c=a._i,d=a._f;d;d=d.n)d.r=!0,d.p&&(d.p=d.p.n=void 0),delete c[d.i];a._f=a._l=void 0,a[p]=0},delete:function(a){var c=o(this,b),d=q(c,a);if(d){var e=d.n,f=d.p;delete c._i[d.i],d.r=!0,f&&(f.n=e),e&&(e.p=f),c._f==d&&(c._f=e),c._l==d&&(c._l=f),c[p]--}return!!d},forEach:function(a){o(this,b);for(var c,d=g(a,arguments.length>1?arguments[1]:void 0,3);c=c?c.n:this._f;)for(d(c.v,c.k,this);c&&c.r;)c=c.p},has:function(a){return!!q(o(this,b),a)}}),m&&d(k.prototype,"size",{get:function(){return o(this,b)[p]}}),k},def:function(a,b,c){var d,e,f=q(a,b);return f?f.v=c:(a._l=f={i:e=n(b,!0),k:b,v:c,p:d=a._l,n:void 0,r:!1},a._f||(a._f=f),d&&(d.n=f),a[p]++,"F"!==e&&(a._i[e]=f)),a},getEntry:q,setStrong:function(a,b,c){j(a,b,function(a,c){this._t=o(a,b),this._k=c,this._l=void 0},function(){for(var a=this,b=a._k,c=a._l;c&&c.r;)c=c.p;return a._t&&(a._l=c=c?c.n:a._t._f)?"keys"==b?k(0,c.k):"values"==b?k(0,c.v):k(0,[c.k,c.v]):(a._t=void 0,k(1))},c?"entries":"values",!c,!0),l(b)}}},{112:112,114:114,117:117,121:121,122:122,135:135,138:138,152:152,81:81,90:90,92:92,98:98}],87:[function(a,b,c){"use strict";var d=a(99),e=a(96),f=a(136),g=a(135),h=a(117),i=a(98),j=a(81),k=a(109),l=a(97),m=a(113),n=a(139),o=a(104);b.exports=function(a,b,c,p,q,r){var s=d[a],t=s,u=q?"set":"add",v=t&&t.prototype,w={},x=function(a){var b=v[a];f(v,a,"delete"==a?function(a){return!(r&&!k(a))&&b.call(this,0===a?0:a)}:"has"==a?function(a){return!(r&&!k(a))&&b.call(this,0===a?0:a)}:"get"==a?function(a){return r&&!k(a)?void 0:b.call(this,0===a?0:a)}:"add"==a?function(a){return b.call(this,0===a?0:a),this}:function(a,c){return b.call(this,0===a?0:a,c),this})};if("function"==typeof t&&(r||v.forEach&&!l(function(){
(new t).entries().next()}))){var y=new t,z=y[u](r?{}:-0,1)!=y,A=l(function(){y.has(1)}),B=m(function(a){new t(a)}),C=!r&&l(function(){for(var a=new t,b=5;b--;)a[u](b,b);return!a.has(-0)});B||(t=b(function(b,c){j(b,t,a);var d=o(new s,b,t);return void 0!=c&&i(c,q,d[u],d),d}),t.prototype=v,v.constructor=t),(A||C)&&(x("delete"),x("has"),q&&x("get")),(C||z)&&x(u),r&&v.clear&&delete v.clear}else t=p.getConstructor(b,a,q,u),g(t.prototype,c),h.NEED=!0;return n(t,a),w[a]=t,e(e.G+e.W+e.F*(t!=s),w),r||p.setStrong(t,a,q),t}},{104:104,109:109,113:113,117:117,135:135,136:136,139:139,81:81,96:96,97:97,98:98,99:99}],88:[function(a,b,c){var d=b.exports={version:"2.5.7"};"number"==typeof __e&&(__e=d)},{}],89:[function(a,b,c){"use strict";var d=a(122),e=a(134);b.exports=function(a,b,c){b in a?d.f(a,b,e(0,c)):a[b]=c}},{122:122,134:134}],90:[function(a,b,c){var d=a(79);b.exports=function(a,b,c){if(d(a),void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}}},{79:79}],91:[function(a,b,c){b.exports=function(a){if(void 0==a)throw TypeError("Can't call method on  "+a);return a}},{}],92:[function(a,b,c){b.exports=!a(97)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{97:97}],93:[function(a,b,c){var d=a(109),e=a(99).document,f=d(e)&&d(e.createElement);b.exports=function(a){return f?e.createElement(a):{}}},{109:109,99:99}],94:[function(a,b,c){b.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],95:[function(a,b,c){var d=a(130),e=a(127),f=a(131);b.exports=function(a){var b=d(a),c=e.f;if(c)for(var g,h=c(a),i=f.f,j=0;h.length>j;)i.call(a,g=h[j++])&&b.push(g);return b}},{127:127,130:130,131:131}],96:[function(a,b,c){var d=a(99),e=a(88),f=a(101),g=a(136),h=a(90),i=function(a,b,c){var j,k,l,m,n=a&i.F,o=a&i.G,p=a&i.S,q=a&i.P,r=a&i.B,s=o?d:p?d[b]||(d[b]={}):(d[b]||{}).prototype,t=o?e:e[b]||(e[b]={}),u=t.prototype||(t.prototype={});o&&(c=b);for(j in c)k=!n&&s&&void 0!==s[j],l=(k?s:c)[j],m=r&&k?h(l,d):q&&"function"==typeof l?h(Function.call,l):l,s&&g(s,j,l,a&i.U),t[j]!=l&&f(t,j,m),q&&u[j]!=l&&(u[j]=l)};d.core=e,i.F=1,i.G=2,i.S=4,i.P=8,i.B=16,i.W=32,i.U=64,i.R=128,b.exports=i},{101:101,136:136,88:88,90:90,99:99}],97:[function(a,b,c){b.exports=function(a){try{return!!a()}catch(a){return!0}}},{}],98:[function(a,b,c){var d=a(90),e=a(110),f=a(107),g=a(82),h=a(147),i=a(156),j={},k={},c=b.exports=function(a,b,c,l,m){var n,o,p,q,r=m?function(){return a}:i(a),s=d(c,l,b?2:1),t=0;if("function"!=typeof r)throw TypeError(a+" is not iterable!");if(f(r)){for(n=h(a.length);n>t;t++)if((q=b?s(g(o=a[t])[0],o[1]):s(a[t]))===j||q===k)return q}else for(p=r.call(a);!(o=p.next()).done;)if((q=e(p,s,o.value,b))===j||q===k)return q};c.BREAK=j,c.RETURN=k},{107:107,110:110,147:147,156:156,82:82,90:90}],99:[function(a,b,c){var d=b.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=d)},{}],100:[function(a,b,c){var d={}.hasOwnProperty;b.exports=function(a,b){return d.call(a,b)}},{}],101:[function(a,b,c){var d=a(122),e=a(134);b.exports=a(92)?function(a,b,c){return d.f(a,b,e(1,c))}:function(a,b,c){return a[b]=c,a}},{122:122,134:134,92:92}],102:[function(a,b,c){var d=a(99).document;b.exports=d&&d.documentElement},{99:99}],103:[function(a,b,c){b.exports=!a(92)&&!a(97)(function(){return 7!=Object.defineProperty(a(93)("div"),"a",{get:function(){return 7}}).a})},{92:92,93:93,97:97}],104:[function(a,b,c){var d=a(109),e=a(137).set;b.exports=function(a,b,c){var f,g=b.constructor;return g!==c&&"function"==typeof g&&(f=g.prototype)!==c.prototype&&d(f)&&e&&e(a,f),a}},{109:109,137:137}],105:[function(a,b,c){b.exports=function(a,b,c){var d=void 0===c;switch(b.length){case 0:return d?a():a.call(c);case 1:return d?a(b[0]):a.call(c,b[0]);case 2:return d?a(b[0],b[1]):a.call(c,b[0],b[1]);case 3:return d?a(b[0],b[1],b[2]):a.call(c,b[0],b[1],b[2]);case 4:return d?a(b[0],b[1],b[2],b[3]):a.call(c,b[0],b[1],b[2],b[3])}return a.apply(c,b)}},{}],106:[function(a,b,c){var d=a(85);b.exports=Object("z").propertyIsEnumerable(0)?Object:function(a){return"String"==d(a)?a.split(""):Object(a)}},{85:85}],107:[function(a,b,c){var d=a(115),e=a(155)("iterator"),f=Array.prototype;b.exports=function(a){return void 0!==a&&(d.Array===a||f[e]===a)}},{115:115,155:155}],108:[function(a,b,c){var d=a(85);b.exports=Array.isArray||function(a){return"Array"==d(a)}},{85:85}],109:[function(a,b,c){b.exports=function(a){return"object"==typeof a?null!==a:"function"==typeof a}},{}],110:[function(a,b,c){var d=a(82);b.exports=function(a,b,c,e){try{return e?b(d(c)[0],c[1]):b(c)}catch(b){var f=a.return;throw void 0!==f&&d(f.call(a)),b}}},{82:82}],111:[function(a,b,c){"use strict";var d=a(121),e=a(134),f=a(139),g={};a(101)(g,a(155)("iterator"),function(){return this}),b.exports=function(a,b,c){a.prototype=d(g,{next:e(1,c)}),f(a,b+" Iterator")}},{101:101,121:121,134:134,139:139,155:155}],112:[function(a,b,c){"use strict";var d=a(116),e=a(96),f=a(136),g=a(101),h=a(115),i=a(111),j=a(139),k=a(128),l=a(155)("iterator"),m=!([].keys&&"next"in[].keys()),n=function(){return this};b.exports=function(a,b,c,o,p,q,r){i(c,b,o);var s,t,u,v=function(a){if(!m&&a in z)return z[a];switch(a){case"keys":case"values":return function(){return new c(this,a)}}return function(){return new c(this,a)}},w=b+" Iterator",x="values"==p,y=!1,z=a.prototype,A=z[l]||z["@@iterator"]||p&&z[p],B=A||v(p),C=p?x?v("entries"):B:void 0,D="Array"==b?z.entries||A:A;if(D&&(u=k(D.call(new a)))!==Object.prototype&&u.next&&(j(u,w,!0),d||"function"==typeof u[l]||g(u,l,n)),x&&A&&"values"!==A.name&&(y=!0,B=function(){return A.call(this)}),d&&!r||!m&&!y&&z[l]||g(z,l,B),h[b]=B,h[w]=n,p)if(s={values:x?B:v("values"),keys:q?B:v("keys"),entries:C},r)for(t in s)t in z||f(z,t,s[t]);else e(e.P+e.F*(m||y),b,s);return s}},{101:101,111:111,115:115,116:116,128:128,136:136,139:139,155:155,96:96}],113:[function(a,b,c){var d=a(155)("iterator"),e=!1;try{var f=[7][d]();f.return=function(){e=!0},Array.from(f,function(){throw 2})}catch(a){}b.exports=function(a,b){if(!b&&!e)return!1;var c=!1;try{var f=[7],g=f[d]();g.next=function(){return{done:c=!0}},f[d]=function(){return g},a(f)}catch(a){}return c}},{155:155}],114:[function(a,b,c){b.exports=function(a,b){return{value:b,done:!!a}}},{}],115:[function(a,b,c){b.exports={}},{}],116:[function(a,b,c){b.exports=!1},{}],117:[function(a,b,c){var d=a(150)("meta"),e=a(109),f=a(100),g=a(122).f,h=0,i=Object.isExtensible||function(){return!0},j=!a(97)(function(){return i(Object.preventExtensions({}))}),k=function(a){g(a,d,{value:{i:"O"+ ++h,w:{}}})},l=function(a,b){if(!e(a))return"symbol"==typeof a?a:("string"==typeof a?"S":"P")+a;if(!f(a,d)){if(!i(a))return"F";if(!b)return"E";k(a)}return a[d].i},m=function(a,b){if(!f(a,d)){if(!i(a))return!0;if(!b)return!1;k(a)}return a[d].w},n=function(a){return j&&o.NEED&&i(a)&&!f(a,d)&&k(a),a},o=b.exports={KEY:d,NEED:!1,fastKey:l,getWeak:m,onFreeze:n}},{100:100,109:109,122:122,150:150,97:97}],118:[function(a,b,c){var d=a(99),e=a(143).set,f=d.MutationObserver||d.WebKitMutationObserver,g=d.process,h=d.Promise,i="process"==a(85)(g);b.exports=function(){var a,b,c,j=function(){var d,e;for(i&&(d=g.domain)&&d.exit();a;){e=a.fn,a=a.next;try{e()}catch(d){throw a?c():b=void 0,d}}b=void 0,d&&d.enter()};if(i)c=function(){g.nextTick(j)};else if(!f||d.navigator&&d.navigator.standalone)if(h&&h.resolve){var k=h.resolve(void 0);c=function(){k.then(j)}}else c=function(){e.call(d,j)};else{var l=!0,m=document.createTextNode("");new f(j).observe(m,{characterData:!0}),c=function(){m.data=l=!l}}return function(d){var e={fn:d,next:void 0};b&&(b.next=e),a||(a=e,c()),b=e}}},{143:143,85:85,99:99}],119:[function(a,b,c){"use strict";function d(a){var b,c;this.promise=new a(function(a,d){if(void 0!==b||void 0!==c)throw TypeError("Bad Promise constructor");b=a,c=d}),this.resolve=e(b),this.reject=e(c)}var e=a(79);b.exports.f=function(a){return new d(a)}},{79:79}],120:[function(a,b,c){"use strict";var d=a(130),e=a(127),f=a(131),g=a(148),h=a(106),i=Object.assign;b.exports=!i||a(97)(function(){var a={},b={},c=Symbol(),d="abcdefghijklmnopqrst";return a[c]=7,d.split("").forEach(function(a){b[a]=a}),7!=i({},a)[c]||Object.keys(i({},b)).join("")!=d})?function(a,b){for(var c=g(a),i=arguments.length,j=1,k=e.f,l=f.f;i>j;)for(var m,n=h(arguments[j++]),o=k?d(n).concat(k(n)):d(n),p=o.length,q=0;p>q;)l.call(n,m=o[q++])&&(c[m]=n[m]);return c}:i},{106:106,127:127,130:130,131:131,148:148,97:97}],121:[function(a,b,c){var d=a(82),e=a(123),f=a(94),g=a(140)("IE_PROTO"),h=function(){},i=function(){var b,c=a(93)("iframe"),d=f.length;for(c.style.display="none",a(102).appendChild(c),c.src="javascript:",b=c.contentWindow.document,b.open(),b.write("<script>document.F=Object<\/script>"),b.close(),i=b.F;d--;)delete i.prototype[f[d]];return i()};b.exports=Object.create||function(a,b){var c;return null!==a?(h.prototype=d(a),c=new h,h.prototype=null,c[g]=a):c=i(),void 0===b?c:e(c,b)}},{102:102,123:123,140:140,82:82,93:93,94:94}],122:[function(a,b,c){var d=a(82),e=a(103),f=a(149),g=Object.defineProperty;c.f=a(92)?Object.defineProperty:function(a,b,c){if(d(a),b=f(b,!0),d(c),e)try{return g(a,b,c)}catch(a){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(a[b]=c.value),a}},{103:103,149:149,82:82,92:92}],123:[function(a,b,c){var d=a(122),e=a(82),f=a(130);b.exports=a(92)?Object.defineProperties:function(a,b){e(a);for(var c,g=f(b),h=g.length,i=0;h>i;)d.f(a,c=g[i++],b[c]);return a}},{122:122,130:130,82:82,92:92}],124:[function(a,b,c){var d=a(131),e=a(134),f=a(146),g=a(149),h=a(100),i=a(103),j=Object.getOwnPropertyDescriptor;c.f=a(92)?j:function(a,b){if(a=f(a),b=g(b,!0),i)try{return j(a,b)}catch(a){}if(h(a,b))return e(!d.f.call(a,b),a[b])}},{100:100,103:103,131:131,134:134,146:146,149:149,92:92}],125:[function(a,b,c){var d=a(146),e=a(126).f,f={}.toString,g="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],h=function(a){try{return e(a)}catch(a){return g.slice()}};b.exports.f=function(a){return g&&"[object Window]"==f.call(a)?h(a):e(d(a))}},{126:126,146:146}],126:[function(a,b,c){var d=a(129),e=a(94).concat("length","prototype");c.f=Object.getOwnPropertyNames||function(a){return d(a,e)}},{129:129,94:94}],127:[function(a,b,c){c.f=Object.getOwnPropertySymbols},{}],128:[function(a,b,c){var d=a(100),e=a(148),f=a(140)("IE_PROTO"),g=Object.prototype;b.exports=Object.getPrototypeOf||function(a){return a=e(a),d(a,f)?a[f]:"function"==typeof a.constructor&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?g:null}},{100:100,140:140,148:148}],129:[function(a,b,c){var d=a(100),e=a(146),f=a(83)(!1),g=a(140)("IE_PROTO");b.exports=function(a,b){var c,h=e(a),i=0,j=[];for(c in h)c!=g&&d(h,c)&&j.push(c);for(;b.length>i;)d(h,c=b[i++])&&(~f(j,c)||j.push(c));return j}},{100:100,140:140,146:146,83:83}],130:[function(a,b,c){var d=a(129),e=a(94);b.exports=Object.keys||function(a){return d(a,e)}},{129:129,94:94}],131:[function(a,b,c){c.f={}.propertyIsEnumerable},{}],132:[function(a,b,c){b.exports=function(a){try{return{e:!1,v:a()}}catch(a){return{e:!0,v:a}}}},{}],133:[function(a,b,c){var d=a(82),e=a(109),f=a(119);b.exports=function(a,b){if(d(a),e(b)&&b.constructor===a)return b;var c=f.f(a);return(0,c.resolve)(b),c.promise}},{109:109,119:119,82:82}],134:[function(a,b,c){b.exports=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}}},{}],135:[function(a,b,c){var d=a(136);b.exports=function(a,b,c){for(var e in b)d(a,e,b[e],c);return a}},{136:136}],136:[function(a,b,c){var d=a(99),e=a(101),f=a(100),g=a(150)("src"),h=Function.toString,i=(""+h).split("toString");a(88).inspectSource=function(a){return h.call(a)},(b.exports=function(a,b,c,h){var j="function"==typeof c;j&&(f(c,"name")||e(c,"name",b)),a[b]!==c&&(j&&(f(c,g)||e(c,g,a[b]?""+a[b]:i.join(String(b)))),a===d?a[b]=c:h?a[b]?a[b]=c:e(a,b,c):(delete a[b],e(a,b,c)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[g]||h.call(this)})},{100:100,101:101,150:150,88:88,99:99}],137:[function(a,b,c){var d=a(109),e=a(82),f=function(a,b){if(e(a),!d(b)&&null!==b)throw TypeError(b+": can't set as prototype!")};b.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(b,c,d){try{d=a(90)(Function.call,a(124).f(Object.prototype,"__proto__").set,2),d(b,[]),c=!(b instanceof Array)}catch(a){c=!0}return function(a,b){return f(a,b),c?a.__proto__=b:d(a,b),a}}({},!1):void 0),check:f}},{109:109,124:124,82:82,90:90}],138:[function(a,b,c){"use strict";var d=a(99),e=a(122),f=a(92),g=a(155)("species");b.exports=function(a){var b=d[a];f&&b&&!b[g]&&e.f(b,g,{configurable:!0,get:function(){return this}})}},{122:122,155:155,92:92,99:99}],139:[function(a,b,c){var d=a(122).f,e=a(100),f=a(155)("toStringTag");b.exports=function(a,b,c){a&&!e(a=c?a:a.prototype,f)&&d(a,f,{configurable:!0,value:b})}},{100:100,122:122,155:155}],140:[function(a,b,c){var d=a(141)("keys"),e=a(150);b.exports=function(a){return d[a]||(d[a]=e(a))}},{141:141,150:150}],141:[function(a,b,c){var d=a(88),e=a(99),f=e["__core-js_shared__"]||(e["__core-js_shared__"]={});(b.exports=function(a,b){return f[a]||(f[a]=void 0!==b?b:{})})("versions",[]).push({version:d.version,mode:a(116)?"pure":"global",copyright:" 2018 Denis Pushkarev (zloirock.ru)"})},{116:116,88:88,99:99}],142:[function(a,b,c){var d=a(82),e=a(79),f=a(155)("species");b.exports=function(a,b){var c,g=d(a).constructor;return void 0===g||void 0==(c=d(g)[f])?b:e(c)}},{155:155,79:79,82:82}],143:[function(a,b,c){var d,e,f,g=a(90),h=a(105),i=a(102),j=a(93),k=a(99),l=k.process,m=k.setImmediate,n=k.clearImmediate,o=k.MessageChannel,p=k.Dispatch,q=0,r={},s=function(){var a=+this;if(r.hasOwnProperty(a)){var b=r[a];delete r[a],b()}},t=function(a){s.call(a.data)};m&&n||(m=function(a){for(var b=[],c=1;arguments.length>c;)b.push(arguments[c++]);return r[++q]=function(){h("function"==typeof a?a:Function(a),b)},d(q),q},n=function(a){delete r[a]},"process"==a(85)(l)?d=function(a){l.nextTick(g(s,a,1))}:p&&p.now?d=function(a){p.now(g(s,a,1))}:o?(e=new o,f=e.port2,e.port1.onmessage=t,d=g(f.postMessage,f,1)):k.addEventListener&&"function"==typeof postMessage&&!k.importScripts?(d=function(a){k.postMessage(a+"","*")},k.addEventListener("message",t,!1)):d="onreadystatechange"in j("script")?function(a){i.appendChild(j("script")).onreadystatechange=function(){i.removeChild(this),s.call(a)}}:function(a){setTimeout(g(s,a,1),0)}),b.exports={set:m,clear:n}},{102:102,105:105,85:85,90:90,93:93,99:99}],144:[function(a,b,c){var d=a(145),e=Math.max,f=Math.min;b.exports=function(a,b){return a=d(a),a<0?e(a+b,0):f(a,b)}},{145:145}],145:[function(a,b,c){var d=Math.ceil,e=Math.floor;b.exports=function(a){return isNaN(a=+a)?0:(a>0?e:d)(a)}},{}],146:[function(a,b,c){var d=a(106),e=a(91);b.exports=function(a){return d(e(a))}},{106:106,91:91}],147:[function(a,b,c){var d=a(145),e=Math.min;b.exports=function(a){return a>0?e(d(a),9007199254740991):0}},{145:145}],148:[function(a,b,c){var d=a(91);b.exports=function(a){return Object(d(a))}},{91:91}],149:[function(a,b,c){var d=a(109);b.exports=function(a,b){if(!d(a))return a;var c,e;if(b&&"function"==typeof(c=a.toString)&&!d(e=c.call(a)))return e;if("function"==typeof(c=a.valueOf)&&!d(e=c.call(a)))return e;if(!b&&"function"==typeof(c=a.toString)&&!d(e=c.call(a)))return e;throw TypeError("Can't convert object to primitive value")}},{109:109}],150:[function(a,b,c){var d=0,e=Math.random();b.exports=function(a){return"Symbol(".concat(void 0===a?"":a,")_",(++d+e).toString(36))}},{}],151:[function(a,b,c){var d=a(99),e=d.navigator;b.exports=e&&e.userAgent||""},{99:99}],152:[function(a,b,c){var d=a(109);b.exports=function(a,b){if(!d(a)||a._t!==b)throw TypeError("Incompatible receiver, "+b+" required!");return a}},{109:109}],153:[function(a,b,c){var d=a(99),e=a(88),f=a(116),g=a(154),h=a(122).f;b.exports=function(a){var b=e.Symbol||(e.Symbol=f?{}:d.Symbol||{});"_"==a.charAt(0)||a in b||h(b,a,{value:g.f(a)})}},{116:116,122:122,154:154,88:88,99:99}],154:[function(a,b,c){c.f=a(155)},{155:155}],155:[function(a,b,c){var d=a(141)("wks"),e=a(150),f=a(99).Symbol,g="function"==typeof f;(b.exports=function(a){return d[a]||(d[a]=g&&f[a]||(g?f:e)("Symbol."+a))}).store=d},{141:141,150:150,99:99}],156:[function(a,b,c){var d=a(84),e=a(155)("iterator"),f=a(115);b.exports=a(88).getIteratorMethod=function(a){if(void 0!=a)return a[e]||a["@@iterator"]||f[d(a)]}},{115:115,155:155,84:84,88:88}],157:[function(a,b,c){"use strict";var d=a(90),e=a(96),f=a(148),g=a(110),h=a(107),i=a(147),j=a(89),k=a(156);e(e.S+e.F*!a(113)(function(a){Array.from(a)}),"Array",{from:function(a){var b,c,e,l,m=f(a),n="function"==typeof this?this:Array,o=arguments.length,p=o>1?arguments[1]:void 0,q=void 0!==p,r=0,s=k(m);if(q&&(p=d(p,o>2?arguments[2]:void 0,2)),void 0==s||n==Array&&h(s))for(b=i(m.length),c=new n(b);b>r;r++)j(c,r,q?p(m[r],r):m[r]);else for(l=s.call(m),c=new n;!(e=l.next()).done;r++)j(c,r,q?g(l,p,[e.value,r],!0):e.value);return c.length=r,c}})},{107:107,110:110,113:113,147:147,148:148,156:156,89:89,90:90,96:96}],158:[function(a,b,c){"use strict";var d=a(80),e=a(114),f=a(115),g=a(146);b.exports=a(112)(Array,"Array",function(a,b){this._t=g(a),this._i=0,this._k=b},function(){var a=this._t,b=this._k,c=this._i++;return!a||c>=a.length?(this._t=void 0,e(1)):"keys"==b?e(0,c):"values"==b?e(0,a[c]):e(0,[c,a[c]])},"values"),f.Arguments=f.Array,d("keys"),d("values"),d("entries")},{112:112,114:114,115:115,146:146,80:80}],159:[function(a,b,c){"use strict";var d=a(86),e=a(152);b.exports=a(87)("Map",function(a){return function(){return a(this,arguments.length>0?arguments[0]:void 0)}},{get:function(a){var b=d.getEntry(e(this,"Map"),a);return b&&b.v},set:function(a,b){return d.def(e(this,"Map"),0===a?0:a,b)}},d,!0)},{152:152,86:86,87:87}],160:[function(a,b,c){var d=a(96);d(d.S+d.F,"Object",{assign:a(120)})},{120:120,96:96}],161:[function(a,b,c){var d=a(96);d(d.S,"Object",{setPrototypeOf:a(137).set})},{137:137,96:96}],162:[function(a,b,c){"use strict";var d,e,f,g,h=a(116),i=a(99),j=a(90),k=a(84),l=a(96),m=a(109),n=a(79),o=a(81),p=a(98),q=a(142),r=a(143).set,s=a(118)(),t=a(119),u=a(132),v=a(151),w=a(133),x=i.TypeError,y=i.process,z=y&&y.versions,A=z&&z.v8||"",B=i.Promise,C="process"==k(y),D=function(){},E=e=t.f,F=!!function(){try{var b=B.resolve(1),c=(b.constructor={})[a(155)("species")]=function(a){a(D,D)};return(C||"function"==typeof PromiseRejectionEvent)&&b.then(D)instanceof c&&0!==A.indexOf("6.6")&&-1===v.indexOf("Chrome/66")}catch(a){}}(),G=function(a){var b;return!(!m(a)||"function"!=typeof(b=a.then))&&b},H=function(a,b){if(!a._n){a._n=!0;var c=a._c;s(function(){for(var d=a._v,e=1==a._s,f=0;c.length>f;)!function(b){var c,f,g,h=e?b.ok:b.fail,i=b.resolve,j=b.reject,k=b.domain;try{h?(e||(2==a._h&&K(a),a._h=1),!0===h?c=d:(k&&k.enter(),c=h(d),k&&(k.exit(),g=!0)),c===b.promise?j(x("Promise-chain cycle")):(f=G(c))?f.call(c,i,j):i(c)):j(d)}catch(a){k&&!g&&k.exit(),j(a)}}(c[f++]);a._c=[],a._n=!1,b&&!a._h&&I(a)})}},I=function(a){r.call(i,function(){var b,c,d,e=a._v,f=J(a);if(f&&(b=u(function(){C?y.emit("unhandledRejection",e,a):(c=i.onunhandledrejection)?c({promise:a,reason:e}):(d=i.console)&&d.error&&d.error("Unhandled promise rejection",e)}),a._h=C||J(a)?2:1),a._a=void 0,f&&b.e)throw b.v})},J=function(a){return 1!==a._h&&0===(a._a||a._c).length},K=function(a){r.call(i,function(){var b;C?y.emit("rejectionHandled",a):(b=i.onrejectionhandled)&&b({promise:a,reason:a._v})})},L=function(a){var b=this;b._d||(b._d=!0,b=b._w||b,b._v=a,b._s=2,b._a||(b._a=b._c.slice()),H(b,!0))},M=function(a){var b,c=this;if(!c._d){c._d=!0,c=c._w||c;try{if(c===a)throw x("Promise can't be resolved itself");(b=G(a))?s(function(){var d={_w:c,_d:!1};try{b.call(a,j(M,d,1),j(L,d,1))}catch(a){L.call(d,a)}}):(c._v=a,c._s=1,H(c,!1))}catch(a){L.call({_w:c,_d:!1},a)}}};F||(B=function(a){o(this,B,"Promise","_h"),n(a),d.call(this);try{a(j(M,this,1),j(L,this,1))}catch(a){L.call(this,a)}},d=function(a){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},d.prototype=a(135)(B.prototype,{then:function(a,b){var c=E(q(this,B));return c.ok="function"!=typeof a||a,c.fail="function"==typeof b&&b,c.domain=C?y.domain:void 0,this._c.push(c),this._a&&this._a.push(c),this._s&&H(this,!1),c.promise},catch:function(a){return this.then(void 0,a)}}),f=function(){var a=new d;this.promise=a,this.resolve=j(M,a,1),this.reject=j(L,a,1)},t.f=E=function(a){return a===B||a===g?new f(a):e(a)}),l(l.G+l.W+l.F*!F,{Promise:B}),a(139)(B,"Promise"),a(138)("Promise"),g=a(88).Promise,l(l.S+l.F*!F,"Promise",{reject:function(a){var b=E(this);return(0,b.reject)(a),b.promise}}),l(l.S+l.F*(h||!F),"Promise",{resolve:function(a){return w(h&&this===g?B:this,a)}}),l(l.S+l.F*!(F&&a(113)(function(a){B.all(a).catch(D)})),"Promise",{all:function(a){var b=this,c=E(b),d=c.resolve,e=c.reject,f=u(function(){var c=[],f=0,g=1;p(a,!1,function(a){var h=f++,i=!1;c.push(void 0),g++,b.resolve(a).then(function(a){i||(i=!0,c[h]=a,--g||d(c))},e)}),--g||d(c)});return f.e&&e(f.v),c.promise},race:function(a){var b=this,c=E(b),d=c.reject,e=u(function(){p(a,!1,function(a){b.resolve(a).then(c.resolve,d)})});return e.e&&d(e.v),c.promise}})},{109:109,113:113,116:116,118:118,119:119,132:132,133:133,135:135,138:138,139:139,142:142,143:143,151:151,155:155,79:79,81:81,84:84,88:88,90:90,96:96,98:98,99:99}],163:[function(a,b,c){"use strict";var d=a(86),e=a(152);b.exports=a(87)("Set",function(a){return function(){return a(this,arguments.length>0?arguments[0]:void 0)}},{add:function(a){return d.def(e(this,"Set"),a=0===a?0:a,a)}},d)},{152:152,86:86,87:87}],164:[function(a,b,c){"use strict";var d=a(99),e=a(100),f=a(92),g=a(96),h=a(136),i=a(117).KEY,j=a(97),k=a(141),l=a(139),m=a(150),n=a(155),o=a(154),p=a(153),q=a(95),r=a(108),s=a(82),t=a(109),u=a(146),v=a(149),w=a(134),x=a(121),y=a(125),z=a(124),A=a(122),B=a(130),C=z.f,D=A.f,E=y.f,F=d.Symbol,G=d.JSON,H=G&&G.stringify,I=n("_hidden"),J=n("toPrimitive"),K={}.propertyIsEnumerable,L=k("symbol-registry"),M=k("symbols"),N=k("op-symbols"),O=Object.prototype,P="function"==typeof F,Q=d.QObject,R=!Q||!Q.prototype||!Q.prototype.findChild,S=f&&j(function(){return 7!=x(D({},"a",{get:function(){return D(this,"a",{value:7}).a}})).a})?function(a,b,c){var d=C(O,b);d&&delete O[b],D(a,b,c),d&&a!==O&&D(O,b,d)}:D,T=function(a){var b=M[a]=x(F.prototype);return b._k=a,b},U=P&&"symbol"==typeof F.iterator?function(a){return"symbol"==typeof a}:function(a){return a instanceof F},V=function(a,b,c){return a===O&&V(N,b,c),s(a),b=v(b,!0),s(c),e(M,b)?(c.enumerable?(e(a,I)&&a[I][b]&&(a[I][b]=!1),c=x(c,{enumerable:w(0,!1)})):(e(a,I)||D(a,I,w(1,{})),a[I][b]=!0),S(a,b,c)):D(a,b,c)},W=function(a,b){s(a);for(var c,d=q(b=u(b)),e=0,f=d.length;f>e;)V(a,c=d[e++],b[c]);return a},X=function(a,b){return void 0===b?x(a):W(x(a),b)},Y=function(a){var b=K.call(this,a=v(a,!0));return!(this===O&&e(M,a)&&!e(N,a))&&(!(b||!e(this,a)||!e(M,a)||e(this,I)&&this[I][a])||b)},Z=function(a,b){if(a=u(a),b=v(b,!0),a!==O||!e(M,b)||e(N,b)){var c=C(a,b);return!c||!e(M,b)||e(a,I)&&a[I][b]||(c.enumerable=!0),c}},$=function(a){for(var b,c=E(u(a)),d=[],f=0;c.length>f;)e(M,b=c[f++])||b==I||b==i||d.push(b);return d},_=function(a){for(var b,c=a===O,d=E(c?N:u(a)),f=[],g=0;d.length>g;)!e(M,b=d[g++])||c&&!e(O,b)||f.push(M[b]);return f};P||(F=function(){if(this instanceof F)throw TypeError("Symbol is not a constructor!");var a=m(arguments.length>0?arguments[0]:void 0),b=function(c){this===O&&b.call(N,c),e(this,I)&&e(this[I],a)&&(this[I][a]=!1),S(this,a,w(1,c))};return f&&R&&S(O,a,{configurable:!0,set:b}),T(a)},h(F.prototype,"toString",function(){return this._k}),z.f=Z,A.f=V,a(126).f=y.f=$,a(131).f=Y,a(127).f=_,f&&!a(116)&&h(O,"propertyIsEnumerable",Y,!0),o.f=function(a){return T(n(a))}),g(g.G+g.W+g.F*!P,{Symbol:F});for(var aa="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ba=0;aa.length>ba;)n(aa[ba++]);for(var ca=B(n.store),da=0;ca.length>da;)p(ca[da++]);g(g.S+g.F*!P,"Symbol",{for:function(a){return e(L,a+="")?L[a]:L[a]=F(a)},keyFor:function(a){if(!U(a))throw TypeError(a+" is not a symbol!");for(var b in L)if(L[b]===a)return b},useSetter:function(){R=!0},useSimple:function(){R=!1}}),g(g.S+g.F*!P,"Object",{create:X,defineProperty:V,defineProperties:W,getOwnPropertyDescriptor:Z,getOwnPropertyNames:$,getOwnPropertySymbols:_}),G&&g(g.S+g.F*(!P||j(function(){var a=F();return"[null]"!=H([a])||"{}"!=H({a:a})||"{}"!=H(Object(a))})),"JSON",{stringify:function(a){for(var b,c,d=[a],e=1;arguments.length>e;)d.push(arguments[e++]);if(c=b=d[1],(t(b)||void 0!==a)&&!U(a))return r(b)||(b=function(a,b){if("function"==typeof c&&(b=c.call(this,a,b)),!U(b))return b}),d[1]=b,H.apply(G,d)}}),F.prototype[J]||a(101)(F.prototype,J,F.prototype.valueOf),l(F,"Symbol"),l(Math,"Math",!0),l(d.JSON,"JSON",!0)},{100:100,101:101,108:108,109:109,116:116,117:117,121:121,122:122,124:124,125:125,126:126,127:127,130:130,131:131,134:134,136:136,139:139,141:141,146:146,149:149,150:150,153:153,154:154,155:155,82:82,92:92,95:95,96:96,97:97,99:99}],165:[function(a,b,c){"use strict";var d=a(96),e=a(99),f=a(88),g=a(118)(),h=a(155)("observable"),i=a(79),j=a(82),k=a(81),l=a(135),m=a(101),n=a(98),o=n.RETURN,p=function(a){return null==a?void 0:i(a)},q=function(a){var b=a._c;b&&(a._c=void 0,b())},r=function(a){return void 0===a._o},s=function(a){r(a)||(a._o=void 0,q(a))},t=function(a,b){j(a),this._c=void 0,this._o=a,a=new u(this);try{var c=b(a),d=c;null!=c&&("function"==typeof c.unsubscribe?c=function(){d.unsubscribe()}:i(c),this._c=c)}catch(b){return void a.error(b)}r(this)&&q(this)};t.prototype=l({},{unsubscribe:function(){s(this)}});var u=function(a){this._s=a};u.prototype=l({},{next:function(a){var b=this._s;if(!r(b)){var c=b._o;try{var d=p(c.next);if(d)return d.call(c,a)}catch(a){try{s(b)}finally{throw a}}}},error:function(a){var b=this._s;if(r(b))throw a;var c=b._o;b._o=void 0;try{var d=p(c.error);if(!d)throw a;a=d.call(c,a)}catch(a){try{q(b)}finally{throw a}}return q(b),a},complete:function(a){var b=this._s;if(!r(b)){var c=b._o;b._o=void 0;try{var d=p(c.complete);a=d?d.call(c,a):void 0}catch(a){try{q(b)}finally{throw a}}return q(b),a}}});var v=function(a){k(this,v,"Observable","_f")._f=i(a)};l(v.prototype,{subscribe:function(a){return new t(a,this._f)},forEach:function(a){var b=this;return new(f.Promise||e.Promise)(function(c,d){i(a);var e=b.subscribe({next:function(b){try{return a(b)}catch(a){d(a),e.unsubscribe()}},error:d,complete:c})})}}),l(v,{from:function(a){var b="function"==typeof this?this:v,c=p(j(a)[h]);if(c){var d=j(c.call(a));return d.constructor===b?d:new b(function(a){return d.subscribe(a)})}return new b(function(b){var c=!1;return g(function(){if(!c){try{if(n(a,!1,function(a){if(b.next(a),c)return o})===o)return}catch(a){if(c)throw a;return void b.error(a)}b.complete()}}),function(){c=!0}})},of:function(){for(var a=0,b=arguments.length,c=new Array(b);a<b;)c[a]=arguments[a++];return new("function"==typeof this?this:v)(function(a){var b=!1;return g(function(){if(!b){for(var d=0;d<c.length;++d)if(a.next(c[d]),b)return;a.complete()}}),function(){b=!0}})}}),m(v.prototype,h,function(){return this}),d(d.G,{Observable:v}),a(138)("Observable")},{101:101,118:118,135:135,138:138,155:155,79:79,81:81,82:82,88:88,96:96,98:98,99:99}],166:[function(a,b,c){a(153)("observable")},{153:153}],167:[function(b,c,d){!function(b,e){"object"==typeof d?c.exports=d=e():"function"==typeof a&&a.amd?a([],e):b.CryptoJS=e()}(this,function(){var a=a||function(a,b){var c=Object.create||function(){function a(){}return function(b){var c;return a.prototype=b,c=new a,a.prototype=null,c}}(),d={},e=d.lib={},f=e.Base=function(){return{extend:function(a){var b=c(this);return a&&b.mixIn(a),b.hasOwnProperty("init")&&this.init!==b.init||(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),g=e.WordArray=f.extend({init:function(a,b){a=this.words=a||[],this.sigBytes=void 0!=b?b:4*a.length},toString:function(a){return(a||i).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes,e=a.sigBytes;if(this.clamp(),d%4)for(var f=0;f<e;f++){var g=c[f>>>2]>>>24-f%4*8&255;b[d+f>>>2]|=g<<24-(d+f)%4*8}else for(var f=0;f<e;f+=4)b[d+f>>>2]=c[f>>>2];return this.sigBytes+=e,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-c%4*8,b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c,d=[],e=0;e<b;e+=4){var f=function(b){var b=b,c=987654321,d=4294967295;return function(){c=36969*(65535&c)+(c>>16)&d,b=18e3*(65535&b)+(b>>16)&d;var e=(c<<16)+b&d;return e/=4294967296,(e+=.5)*(a.random()>.5?1:-1)}}(4294967296*(c||a.random()));c=987654071*f(),d.push(4294967296*f()|0)}return new g.init(d,b)}}),h=d.enc={},i=h.Hex={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;e<c;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push((f>>>4).toString(16)),d.push((15&f).toString(16))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new g.init(c,b/2)}},j=h.Latin1={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;e<c;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push(String.fromCharCode(f))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-d%4*8;return new g.init(c,b)}},k=h.Utf8={stringify:function(a){try{return decodeURIComponent(escape(j.stringify(a)))}catch(a){throw new Error("Malformed UTF-8 data")}},parse:function(a){return j.parse(unescape(encodeURIComponent(a)))}},l=e.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=k.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,h=4*f,i=e/h;i=b?a.ceil(i):a.max((0|i)-this._minBufferSize,0);var j=i*f,k=a.min(4*j,e);if(j){for(var l=0;l<j;l+=f)this._doProcessBlock(d,l);var m=d.splice(0,j);c.sigBytes-=k}return new g.init(m,k)},clone:function(){var a=f.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0}),m=(e.Hasher=l.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new m.HMAC.init(a,c).finalize(b)}}}),d.algo={});return d}(Math);return a})},{}],168:[function(b,c,d){!function(e,f,g){"object"==typeof d?c.exports=d=f(b(167),b(170),b(169)):"function"==typeof a&&a.amd?a(["./core","./sha1","./hmac"],f):f(e.CryptoJS)}(this,function(a){return a.HmacSHA1})},{167:167,169:169,170:170}],169:[function(b,c,d){!function(e,f){"object"==typeof d?c.exports=d=f(b(167)):"function"==typeof a&&a.amd?a(["./core"],f):f(e.CryptoJS)}(this,function(a){!function(){var b=a,c=b.lib,d=c.Base,e=b.enc,f=e.Utf8,g=b.algo;g.HMAC=d.extend({init:function(a,b){a=this._hasher=new a.init,"string"==typeof b&&(b=f.parse(b));var c=a.blockSize,d=4*c;b.sigBytes>d&&(b=a.finalize(b)),b.clamp();for(var e=this._oKey=b.clone(),g=this._iKey=b.clone(),h=e.words,i=g.words,j=0;j<c;j++)h[j]^=1549556828,i[j]^=909522486;e.sigBytes=g.sigBytes=d,this.reset()},reset:function(){var a=this._hasher;a.reset(),a.update(this._iKey)},
update:function(a){return this._hasher.update(a),this},finalize:function(a){var b=this._hasher,c=b.finalize(a);return b.reset(),b.finalize(this._oKey.clone().concat(c))}})}()})},{167:167}],170:[function(b,c,d){!function(e,f){"object"==typeof d?c.exports=d=f(b(167)):"function"==typeof a&&a.amd?a(["./core"],f):f(e.CryptoJS)}(this,function(a){return function(){var b=a,c=b.lib,d=c.WordArray,e=c.Hasher,f=b.algo,g=[],h=f.SHA1=e.extend({_doReset:function(){this._hash=new d.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],f=c[2],h=c[3],i=c[4],j=0;j<80;j++){if(j<16)g[j]=0|a[b+j];else{var k=g[j-3]^g[j-8]^g[j-14]^g[j-16];g[j]=k<<1|k>>>31}var l=(d<<5|d>>>27)+i+g[j];l+=j<20?1518500249+(e&f|~e&h):j<40?1859775393+(e^f^h):j<60?(e&f|e&h|f&h)-1894007588:(e^f^h)-899497514,i=h,h=f,f=e<<30|e>>>2,e=d,d=l}c[0]=c[0]+d|0,c[1]=c[1]+e|0,c[2]=c[2]+f|0,c[3]=c[3]+h|0,c[4]=c[4]+i|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;return b[d>>>5]|=128<<24-d%32,b[14+(d+64>>>9<<4)]=Math.floor(c/4294967296),b[15+(d+64>>>9<<4)]=c,a.sigBytes=4*b.length,this._process(),this._hash},clone:function(){var a=e.clone.call(this);return a._hash=this._hash.clone(),a}});b.SHA1=e._createHelper(h),b.HmacSHA1=e._createHmacHelper(h)}(),a.SHA1})},{167:167}],171:[function(a,b,c){"use strict";function d(a){function b(a){}if(!a)throw new TypeError("argument namespace is required");return b._file=void 0,b._ignored=!0,b._namespace=a,b._traced=!1,b._warned=Object.create(null),b.function=e,b.property=f,b}function e(a,b){if("function"!=typeof a)throw new TypeError("argument fn must be a function");return a}function f(a,b,c){if(!a||"object"!=typeof a&&"function"!=typeof a)throw new TypeError("argument obj must be object");var d=Object.getOwnPropertyDescriptor(a,b);if(!d)throw new TypeError("must call property on owner object");if(!d.configurable)throw new TypeError("property must be configurable")}b.exports=d},{}],172:[function(a,b,c){function d(a,b){var c=b||0,d=e;return[d[a[c++]],d[a[c++]],d[a[c++]],d[a[c++]],"-",d[a[c++]],d[a[c++]],"-",d[a[c++]],d[a[c++]],"-",d[a[c++]],d[a[c++]],"-",d[a[c++]],d[a[c++]],d[a[c++]],d[a[c++]],d[a[c++]],d[a[c++]]].join("")}for(var e=[],f=0;f<256;++f)e[f]=(f+256).toString(16).substr(1);b.exports=d},{}],173:[function(a,b,c){var d="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(d){var e=new Uint8Array(16);b.exports=function(){return d(e),e}}else{var f=new Array(16);b.exports=function(){for(var a,b=0;b<16;b++)0==(3&b)&&(a=4294967296*Math.random()),f[b]=a>>>((3&b)<<3)&255;return f}}},{}],174:[function(a,b,c){function d(a,b,c){var d=b&&c||0;"string"==typeof a&&(b="binary"===a?new Array(16):null,a=null),a=a||{};var g=a.random||(a.rng||e)();if(g[6]=15&g[6]|64,g[8]=63&g[8]|128,b)for(var h=0;h<16;++h)b[d+h]=g[h];return b||f(g)}var e=a(173),f=a(172);b.exports=d},{172:172,173:173}],175:[function(b,c,d){!function(b,e){void 0!==d&&void 0!==c?c.exports=e():"function"==typeof a&&"object"==typeof a.amd?a(e):"function"==typeof a&&"object"==typeof a.petal?a("validator",[],e):this.validator=e()}(0,function(a){"use strict";function d(a){var b,c,d,e,f=a.match(L);if(f){if(!(b=f[21]))return f[12]?null:0;if("z"===b||"Z"===b)return 0;c=f[22],-1!==b.indexOf(":")?(d=parseInt(f[23]),e=parseInt(f[24])):(d=0,e=parseInt(f[23]))}else{if(a=a.toLowerCase(),!(b=a.match(/(?:\s|gmt\s*)(-|\+)(\d{1,4})(\s|$)/)))return-1!==a.indexOf("gmt")?0:null;c=b[1];var g=b[2];3===g.length&&(g="0"+g),g.length<=2?(d=0,e=parseInt(g)):(d=parseInt(g.slice(0,2)),e=parseInt(g.slice(2,4)))}return(60*d+e)*("-"===c?1:-1)}function e(a,b){a=a||{};for(var c in b)void 0===a[c]&&(a[c]=b[c]);return a}function f(a){var b="(\\"+a.symbol.replace(/\./g,"\\.")+")"+(a.require_symbol?"":"?"),c="[1-9]\\d{0,2}(\\"+a.thousands_separator+"\\d{3})*",d=["0","[1-9]\\d*",c],e="("+d.join("|")+")?",f="(\\"+a.decimal_separator+"\\d{2})?",g=e+f;return a.allow_negatives&&!a.parens_for_negatives&&(a.negative_sign_after_digits?g+="-?":a.negative_sign_before_digits&&(g="-?"+g)),a.allow_negative_sign_placeholder?g="( (?!\\-))?"+g:a.allow_space_after_symbol?g=" ?"+g:a.allow_space_after_digits&&(g+="( (?!$))?"),a.symbol_after_digits?g+=b:g=b+g,a.allow_negatives&&(a.parens_for_negatives?g="(\\("+g+"\\)|"+g+")":a.negative_sign_before_digits||a.negative_sign_after_digits||(g="-?"+g)),new RegExp("^(?!-? )(?=.*\\d)"+g+"$")}a={version:"4.9.0",coerce:!0};for(var g,h=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~]+$/i,i=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f]))*$/i,j=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+$/i,k=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*$/i,l=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\.\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\.\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF\s]*<(.+)>$/i,m=/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/,n=/^[A-Z]{2}[0-9A-Z]{9}[0-9]$/,o=/^(?:[0-9]{9}X|[0-9]{10})$/,p=/^(?:[0-9]{13})$/,q=/^([0-9a-fA-F][0-9a-fA-F]:){5}([0-9a-fA-F][0-9a-fA-F])$/,r=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,s=/^[0-9A-F]{1,4}$/i,t={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i},u={"en-US":/^[A-Z]+$/i,"de-DE":/^[A-Z]+$/i,"es-ES":/^[A-Z]+$/i,"fr-FR":/^[A-Z]+$/i,"nl-NL":/^[A-Z]+$/i,"pt-PT":/^[A-Z]+$/i,"ru-RU":/^[--]+$/i},v={"en-US":/^[0-9A-Z]+$/i,"de-DE":/^[0-9A-Z]+$/i,"es-ES":/^[0-9A-Z]+$/i,"fr-FR":/^[0-9A-Z]+$/i,"nl-NL":/^[0-9A-Z]+$/i,"pt-PT":/^[0-9A-Z]+$/i,"ru-RU":/^[0-9--]+$/i},w=["AU","GB","HK","IN","NZ","ZA","ZM"],x=0;x<w.length;x++)g="en-"+w[x],u[g]=u["en-US"],v[g]=v["en-US"];var y=/^[-+]?[0-9]+$/,z=/^(?:[-+]?(?:0|[1-9][0-9]*))$/,A=/^(?:[-+]?(?:[0-9]+))?(?:\.[0-9]*)?(?:[eE][\+\-]?(?:[0-9]+))?$/,B=/^[0-9A-F]+$/i,C=/^[-+]?([0-9]+|\.[0-9]+|[0-9]+\.[0-9]+)$/,D=/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i,E=/^[\x00-\x7F]+$/,F=/[^\x00-\x7F]/,G=/[^\u0020-\u007E\uFF61-\uFF9F\uFFA0-\uFFDC\uFFE8-\uFFEE0-9a-zA-Z]/,H=/[\u0020-\u007E\uFF61-\uFF9F\uFFA0-\uFFDC\uFFE8-\uFFEE0-9a-zA-Z]/,I=/[\uD800-\uDBFF][\uDC00-\uDFFF]/,J=/^(?:[A-Z0-9+\/]{4})*(?:[A-Z0-9+\/]{2}==|[A-Z0-9+\/]{3}=|[A-Z0-9+\/]{4})$/i,K={"en-US":/^(\+?1)?[2-9]\d{2}[2-9](?!11)\d{6}$/,"de-DE":/^(\+?49[ \.\-])?([\(]{1}[0-9]{1,6}[\)])?([0-9 \.\-\/]{3,20})((x|ext|extension)[ ]?[0-9]{1,4})?$/,"el-GR":/^(\+?30)?(69\d{8})$/,"en-AU":/^(\+?61|0)4\d{8}$/,"en-GB":/^(\+?44|0)7\d{9}$/,"en-HK":/^(\+?852\-?)?[569]\d{3}\-?\d{4}$/,"en-IN":/^(\+?91|0)?[789]\d{9}$/,"en-NZ":/^(\+?64|0)2\d{7,9}$/,"en-ZA":/^(\+?27|0)\d{9}$/,"en-ZM":/^(\+?26)?09[567]\d{7}$/,"es-ES":/^(\+?34)?(6\d{1}|7[1234])\d{7}$/,"fi-FI":/^(\+?358|0)\s?(4(0|1|2|4|5)?|50)\s?(\d\s?){4,8}\d$/,"fr-FR":/^(\+?33|0)[67]\d{8}$/,"nb-NO":/^(\+?47)?[49]\d{7}$/,"nn-NO":/^(\+?47)?[49]\d{7}$/,"pt-BR":/^(\+?55|0)\-?[1-9]{2}\-?[2-9]{1}\d{3,4}\-?\d{4}$/,"pt-PT":/^(\+?351)?9[1236]\d{7}$/,"ru-RU":/^(\+?7|8)?9\d{9}$/,"vi-VN":/^(\+?84|0)?((1(2([0-9])|6([2-9])|88|99))|(9((?!5)[0-9])))([0-9]{7})$/,"zh-CN":/^(\+?0?86\-?)?((13\d|14[57]|15[^4,\D]|17[678]|18\d)\d{8}|170[059]\d{7})$/,"zh-TW":/^(\+?886\-?|0)?9\d{8}$/},L=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/;a.extend=function(b,c){a[b]=function(){var b=Array.prototype.slice.call(arguments);return b[0]=a.toString(b[0]),c.apply(a,b)}},a.init=function(){for(var b in a)"function"==typeof a[b]&&"toString"!==b&&"toDate"!==b&&"extend"!==b&&"init"!==b&&"isServerSide"!==b&&a.extend(b,a[b])},a.isServerSide=function(){return"object"==typeof c&&c&&"object"==typeof c.exports&&"object"==typeof process&&"function"==typeof b};var M=null;a.deprecation=function(c){if(null===M){if(!a.isServerSide())return;M=b(171)("validator")}M(c)},a.toString=function(b){if("string"!=typeof b){if(!a.coerce)throw new Error("this library validates strings only");a.deprecation("you tried to validate a "+typeof b+" but this library (validator.js) validates strings only. Please update your code as this will be an error soon.")}return"object"==typeof b&&null!==b?b="function"==typeof b.toString?b.toString():"[object Object]":(null===b||void 0===b||isNaN(b)&&!b.length)&&(b=""),""+b},a.toDate=function(a){return"[object Date]"===Object.prototype.toString.call(a)?a:(a=Date.parse(a),isNaN(a)?null:new Date(a))},a.toFloat=function(a){return parseFloat(a)},a.toInt=function(a,b){return parseInt(a,b||10)},a.toBoolean=function(a,b){return b?"1"===a||"true"===a:"0"!==a&&"false"!==a&&""!==a},a.equals=function(b,c){return b===a.toString(c)},a.contains=function(b,c){return b.indexOf(a.toString(c))>=0},a.matches=function(a,b,c){return"[object RegExp]"!==Object.prototype.toString.call(b)&&(b=new RegExp(b,c)),b.test(a)};var N={allow_display_name:!1,allow_utf8_local_part:!0,require_tld:!0};a.isEmail=function(b,c){if(c=e(c,N),c.allow_display_name){var d=b.match(l);d&&(b=d[1])}var f=b.split("@"),g=f.pop(),m=f.join("@"),n=g.toLowerCase();if("gmail.com"!==n&&"googlemail.com"!==n||(m=m.replace(/\./g,"").toLowerCase()),!a.isByteLength(m,{max:64})||!a.isByteLength(g,{max:256}))return!1;if(!a.isFQDN(g,{require_tld:c.require_tld}))return!1;if('"'===m[0])return m=m.slice(1,m.length-1),c.allow_utf8_local_part?k.test(m):i.test(m);for(var o=c.allow_utf8_local_part?j:h,p=m.split("."),q=0;q<p.length;q++)if(!o.test(p[q]))return!1;return!0};var O={protocols:["http","https","ftp"],require_tld:!0,require_protocol:!1,require_valid_protocol:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_protocol_relative_urls:!1};a.isURL=function(b,c){if(!b||b.length>=2083||/\s/.test(b))return!1;if(0===b.indexOf("mailto:"))return!1;c=e(c,O);var d,f,g,h,i,j,k;if(k=b.split("://"),k.length>1){if(d=k.shift(),c.require_valid_protocol&&-1===c.protocols.indexOf(d))return!1}else{if(c.require_protocol)return!1;c.allow_protocol_relative_urls&&"//"===b.substr(0,2)&&(k[0]=b.substr(2))}return b=k.join("://"),k=b.split("#"),b=k.shift(),k=b.split("?"),b=k.shift(),k=b.split("/"),b=k.shift(),k=b.split("@"),!(k.length>1&&(f=k.shift(),f.indexOf(":")>=0&&f.split(":").length>2))&&(h=k.join("@"),k=h.split(":"),g=k.shift(),!(k.length&&(j=k.join(":"),i=parseInt(j,10),!/^[0-9]+$/.test(j)||i<=0||i>65535))&&(!(!a.isIP(g)&&!a.isFQDN(g,c)&&"localhost"!==g)&&((!c.host_whitelist||-1!==c.host_whitelist.indexOf(g))&&(!c.host_blacklist||-1===c.host_blacklist.indexOf(g)))))},a.isMACAddress=function(a){return q.test(a)},a.isIP=function(b,c){if(!(c=c?c+"":""))return a.isIP(b,4)||a.isIP(b,6);if("4"===c){if(!r.test(b))return!1;return b.split(".").sort(function(a,b){return a-b})[3]<=255}if("6"===c){var d=b.split(":"),e=!1,f=a.isIP(d[d.length-1],4),g=f?7:8;if(d.length>g)return!1;if("::"===b)return!0;"::"===b.substr(0,2)?(d.shift(),d.shift(),e=!0):"::"===b.substr(b.length-2)&&(d.pop(),d.pop(),e=!0);for(var h=0;h<d.length;++h)if(""===d[h]&&h>0&&h<d.length-1){if(e)return!1;e=!0}else if(f&&h==d.length-1);else if(!s.test(d[h]))return!1;return e?d.length>=1:d.length===g}return!1};var P={require_tld:!0,allow_underscores:!1,allow_trailing_dot:!1};a.isFQDN=function(a,b){b=e(b,P),b.allow_trailing_dot&&"."===a[a.length-1]&&(a=a.substring(0,a.length-1));var c=a.split(".");if(b.require_tld){var d=c.pop();if(!c.length||!/^([a-z\u00a1-\uffff]{2,}|xn[a-z0-9-]{2,})$/i.test(d))return!1}for(var f,g=0;g<c.length;g++){if(f=c[g],b.allow_underscores){if(f.indexOf("__")>=0)return!1;f=f.replace(/_/g,"")}if(!/^[a-z\u00a1-\uffff0-9-]+$/i.test(f))return!1;if(/[\uff01-\uff5e]/.test(f))return!1;if("-"===f[0]||"-"===f[f.length-1])return!1}return!0},a.isBoolean=function(a){return["true","false","1","0"].indexOf(a)>=0},a.isAlpha=function(a,b){if((b=b||"en-US")in u)return u[b].test(a);throw new Error("Invalid locale '"+b+"'")},a.isAlphanumeric=function(a,b){if((b=b||"en-US")in v)return v[b].test(a);throw new Error("Invalid locale '"+b+"'")},a.isNumeric=function(a){return y.test(a)},a.isDecimal=function(a){return""!==a&&C.test(a)},a.isHexadecimal=function(a){return B.test(a)},a.isHexColor=function(a){return D.test(a)},a.isLowercase=function(a){return a===a.toLowerCase()},a.isUppercase=function(a){return a===a.toUpperCase()},a.isInt=function(a,b){return b=b||{},z.test(a)&&(!b.hasOwnProperty("min")||a>=b.min)&&(!b.hasOwnProperty("max")||a<=b.max)},a.isFloat=function(a,b){return b=b||{},""!==a&&"."!==a&&(A.test(a)&&(!b.hasOwnProperty("min")||a>=b.min)&&(!b.hasOwnProperty("max")||a<=b.max))},a.isDivisibleBy=function(b,c){return a.toFloat(b)%parseInt(c,10)==0},a.isNull=function(a){return 0===a.length},a.isLength=function(a,b){var c,d;"object"==typeof b?(c=b.min||0,d=b.max):(c=arguments[1],d=arguments[2]);var e=a.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g)||[],f=a.length-e.length;return f>=c&&(void 0===d||f<=d)},a.isByteLength=function(a,b){var c,d;"object"==typeof b?(c=b.min||0,d=b.max):(c=arguments[1],d=arguments[2]);var e=encodeURI(a).split(/%..|./).length-1;return e>=c&&(void 0===d||e<=d)},a.isUUID=function(a,b){var c=t[b||"all"];return c&&c.test(a)},a.isDate=function(a){var b=new Date(Date.parse(a));if(isNaN(b))return!1;var c=d(a);if(null!==c){var e=b.getTimezoneOffset()-c;b=new Date(b.getTime()+6e4*e)}var f,g,h,i=String(b.getDate());return!(g=a.match(/(^|[^:\d])[23]\d([^:\d]|$)/g))||(f=g.map(function(a){return a.match(/\d+/g)[0]}).join("/"),h=String(b.getFullYear()).slice(-2),f===i||f===h||(f===i+"/"+h||f===h+"/"+i))},a.isAfter=function(b,c){var d=a.toDate(c||new Date),e=a.toDate(b);return!!(e&&d&&e>d)},a.isBefore=function(b,c){var d=a.toDate(c||new Date),e=a.toDate(b);return!!(e&&d&&e<d)},a.isIn=function(b,c){var d;if("[object Array]"===Object.prototype.toString.call(c)){var e=[];for(d in c)e[d]=a.toString(c[d]);return e.indexOf(b)>=0}return"object"==typeof c?c.hasOwnProperty(b):!(!c||"function"!=typeof c.indexOf)&&c.indexOf(b)>=0},a.isWhitelisted=function(a,b){for(var c=a.length-1;c>=0;c--)if(-1===b.indexOf(a[c]))return!1;return!0},a.isCreditCard=function(a){var b=a.replace(/[^0-9]+/g,"");if(!m.test(b))return!1;for(var c,d,e,f=0,g=b.length-1;g>=0;g--)c=b.substring(g,g+1),d=parseInt(c,10),e?(d*=2,f+=d>=10?d%10+1:d):f+=d,e=!e;return!(f%10!=0||!b)},a.isISIN=function(a){if(!n.test(a))return!1;for(var b,c,d=a.replace(/[A-Z]/g,function(a){return parseInt(a,36)}),e=0,f=!0,g=d.length-2;g>=0;g--)b=d.substring(g,g+1),c=parseInt(b,10),f?(c*=2,e+=c>=10?c+1:c):e+=c,f=!f;return parseInt(a.substr(a.length-1),10)===(1e4-e)%10},a.isISBN=function(b,c){if(!(c=c?c+"":""))return a.isISBN(b,10)||a.isISBN(b,13);var d,e=b.replace(/[\s-]+/g,""),f=0;if("10"===c){if(!o.test(e))return!1;for(d=0;d<9;d++)f+=(d+1)*e.charAt(d);if("X"===e.charAt(9)?f+=100:f+=10*e.charAt(9),f%11==0)return!!e}else if("13"===c){if(!p.test(e))return!1;var g=[1,3];for(d=0;d<12;d++)f+=g[d%2]*e.charAt(d);if(e.charAt(12)-(10-f%10)%10==0)return!!e}return!1},a.isMobilePhone=function(a,b){return b in K&&K[b].test(a)};var Q={symbol:"$",require_symbol:!1,allow_space_after_symbol:!1,symbol_after_digits:!1,allow_negatives:!0,parens_for_negatives:!1,negative_sign_before_digits:!1,negative_sign_after_digits:!1,allow_negative_sign_placeholder:!1,thousands_separator:",",decimal_separator:".",allow_space_after_digits:!1};a.isCurrency=function(a,b){return b=e(b,Q),f(b).test(a)},a.isJSON=function(a){try{var b=JSON.parse(a);return!!b&&"object"==typeof b}catch(a){}return!1},a.isMultibyte=function(a){return F.test(a)},a.isAscii=function(a){return E.test(a)},a.isFullWidth=function(a){return G.test(a)},a.isHalfWidth=function(a){return H.test(a)},a.isVariableWidth=function(a){return G.test(a)&&H.test(a)},a.isSurrogatePair=function(a){return I.test(a)},a.isBase64=function(a){return J.test(a)},a.isMongoId=function(b){return a.isHexadecimal(b)&&24===b.length},a.isISO8601=function(a){return L.test(a)},a.ltrim=function(a,b){var c=b?new RegExp("^["+b+"]+","g"):/^\s+/g;return a.replace(c,"")},a.rtrim=function(a,b){var c=b?new RegExp("["+b+"]+$","g"):/\s+$/g;return a.replace(c,"")},a.trim=function(a,b){var c=b?new RegExp("^["+b+"]+|["+b+"]+$","g"):/^\s+|\s+$/g;return a.replace(c,"")},a.escape=function(a){return a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#x2F;").replace(/\`/g,"&#96;")},a.stripLow=function(b,c){var d=c?"\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F":"\\x00-\\x1F\\x7F";return a.blacklist(b,d)},a.whitelist=function(a,b){return a.replace(new RegExp("[^"+b+"]+","g"),"")},a.blacklist=function(a,b){return a.replace(new RegExp("["+b+"]+","g"),"")};var R={lowercase:!0,remove_dots:!0,remove_extension:!0};return a.normalizeEmail=function(b,c){if(c=e(c,R),!a.isEmail(b))return!1;var d=b.split("@",2);if(d[1]=d[1].toLowerCase(),"gmail.com"===d[1]||"googlemail.com"===d[1]){if(c.remove_extension&&(d[0]=d[0].split("+")[0]),c.remove_dots&&(d[0]=d[0].replace(/\./g,"")),!d[0].length)return!1;d[0]=d[0].toLowerCase(),d[1]="gmail.com"}else c.lowercase&&(d[0]=d[0].toLowerCase());return d.join("@")},a.init(),a})},{171:171}],176:[function(a,b,c){"use strict";a(163),a(159),Object.assign||a(160),Object.setPrototypeOf||a(161),"undefined"==typeof Promise&&a(162),Array.from||(a(157),a(158)),"undefined"==typeof Symbol&&a(164)},{157:157,158:158,159:159,160:160,161:161,162:162,163:163,164:164}],177:[function(a,b,c){"use strict";var d=a(3),e=a(178);Object.defineProperty(d.prototype,"websocket",{get:function(){if(!this._websocket){var a=this._connector.secure,b=void 0;b=this._connectData.websocket?(a?"wss:":"ws:")+this._connectData.websocket:this._connector.origin.replace(/^http/,"ws")+this._connector.basePath+"/events",this._websocket=e.create(b)}return this._websocket}}),b.exports=d},{178:178,3:3}],178:[function(a,c,d){"use strict";var e=a(28),f=a(179).WebSocket,g=a(34),h=function(){function a(c){b.classCallCheck(this,a),this.observers={},this.socket=null,this.url=c}return a.create=function(b){var c=this.websockets[b];return c||(c=new a(b),this.websockets[b]=c),c},a.prototype.open=function(){var a=this;if(!this.socket){var b=new f(this.url),c=void 0,d=function(d){var f=!1;a.socket==c&&(f=3!=b.readyState,a.socket=null);var g=void 0;if(Object.keys(a.observers).forEach(function(b){var c=a.observers[b];delete a.observers[b];try{f?c.error(new e(null,d)):c.complete()}catch(a){g||(g=a)}}),g)throw g};b.onerror=d,b.onclose=d,b.onmessage=function(b){var c=JSON.parse(b.data);c.date=new Date(c.date);var f=c.id;if(!f)return void("error"==c.type&&d(c));var g=a.observers[f];g&&("error"==c.type?g.error(new e(null,c)):g.next(c))},c=this.socket=new Promise(function(a){b.onopen=a}).then(function(){return b})}return this.socket},a.prototype.close=function(){this.socket&&(this.socket.then(function(a){a.close()}),this.socket=null)},a.prototype.openStream=function(a,b){var c=this,d=new g.Observable(function(a){if(c.observers[b])throw new Error("Only one subscription per stream is allowed.");return c.observers[b]=a,function(){c.observers[b]==a&&delete c.observers[b]}});return d.send=function(d){c.open().then(function(c){d.id=b,a.token&&(d.token=a.token);var e=JSON.stringify(d);c.send(e)})},d},a}();Object.assign(h,{websockets:{}}),c.exports=h},{179:179,28:28,34:34}],179:[function(a,b,c){"use strict";c.WebSocket=window.WebSocket},{}],180:[function(a,b,c){"use strict";a(176),b.exports=a(184)},{176:176,184:184}],181:[function(a,b,c){"use strict";if("undefined"!=typeof Rx)b.exports=Rx.Observable;else try{b.exports=a("rxjs/Observable").Observable}catch(c){if("undefined"==typeof Observable){a(166),a(165);var d=Observable.prototype.subscribe;Observable.prototype.subscribe=function(a,b,c){return a instanceof Function?d.call(this,{next:a,error:b,complete:c}):d.call(this,a)}}b.exports=Observable}},{165:165,166:166,undefined:void 0}],182:[function(a,b,c){"use strict";var d=a(183),e=a(59);e.prototype.eventStream=function(a,b,c,e){a instanceof Function&&(e=c,c=b,b=a,a={});var f=d.createEventStream(this.entityManager,this._createRealTimeQuery(),a);return b instanceof Function?f.subscribe(b,c,e):f},e.prototype.resultStream=function(a,b,c,e){a instanceof Function&&(e=c,c=b,b=a,a={});var f=d.createResultStream(this.entityManager,this._createRealTimeQuery(),a);return b instanceof Function?f.subscribe(b,c,e):f},e.prototype._createRealTimeQuery=function(){var a=this.resultClass?this.entityManager.metamodel.entity(this.resultClass):null;if(!a)throw new Error("Only typed queries can be executed.");var b={bucket:a.name,query:this._serializeQuery()},c=this._serializeSort();return c&&"{}"!=c&&(b.sort=c),this.maxResults>0&&(b.limit=this.maxResults),this.firstResult>0&&(b.offset=this.firstResult),b},b.exports=e},{183:183,59:59}],183:[function(a,c,d){"use strict";var e=a(66),f=a(34),g=a(77).uuid,h=function(){function a(){b.classCallCheck(this,a)}return a.createEventStream=function(b,c,d){return d=d||{},d.reconnects=0,a.streamObservable(b,c,d,function(d,e){var f=d.type;if(delete d.type,"result"==f){d.data;d.data.forEach(function(f,g){var h=Object.assign({matchType:"add",operation:"none",initial:!0},d);h.data=a._resolveObject(b,f),c.sort&&(h.index=g),e(h)})}"match"==f&&(d.data=a._resolveObject(b,d.data),e(d))})},a.createResultStream=function(b,c,d){d=d||{},d.initial=!0,d.matchTypes="all",d.operations="any";var e=void 0,f=!!c.sort;return a.streamObservable(b,c,d,function(c,d){if("result"==c.type&&(e=c.data.map(function(c){return a._resolveObject(b,c)}),d(e.slice())),"match"==c.type){var g=a._resolveObject(b,c.data);if("remove"==c.matchType||"changeIndex"==c.matchType)for(var h=0,i=e.length;h<i;++h)if(e[h].id==c.data.id){e.splice(h,1);break}"add"!=c.matchType&&"changeIndex"!=c.matchType||(f?e.splice(c.index,0,g):e.push(g)),d(e.slice())}})},a.streamObservable=function(b,c,d,e){d=a.parseOptions(d);var h=b.entityManagerFactory.websocket,i=new f.Observable(function(a){var f=g(),i=h.openStream(b.tokenStorage,f);i.send(Object.assign({type:"subscribe"},c,d));var j=!1,k=a.next.bind(a),l=i.subscribe({complete:function(){j=!0,a.complete()},error:function(b){j=!0,a.error(b)},next:function(a){e(a,k)}});return function(){j||(i.send({type:"unsubscribe"}),l.unsubscribe(),j=!0)}});return a.cachedObservable(i,d)},a.cachedObservable=function(a,b){var c=null,d=[];return new f.Observable(function(e){if(!c){var f=b.reconnects,g=1,h={next:function(a){g=1,d.forEach(function(b){return b.next(a)})},error:function(a){d.forEach(function(b){return b.error(a)})},complete:function(){0!==f?(f=f<0?-1:f-1,setTimeout(function(){c=a.subscribe(h)},1e3*g),g<<=1):d.forEach(function(a){return a.complete()})}};c=a.subscribe(h)}return d.push(e),function(){d.splice(d.indexOf(e),1),d.length||(c.unsubscribe(),c=null)}})},a.parseOptions=function(b){b=b||{};var c={initial:void 0===b.initial||!!b.initial,matchTypes:a.normalizeMatchTypes(b.matchTypes),operations:a.normalizeOperations(b.operations),reconnects:a.normalizeReconnects(b.reconnects)};if(-1==c.matchTypes.indexOf("all")&&-1==c.operations.indexOf("any"))throw new Error("Only subscriptions for either operations or matchTypes are allowed. You cannot subscribe to a query using matchTypes and operations at the same time!");return c},a.normalizeMatchTypes=function(b){return a.normalizeSortedSet(b,"all","match types",["add","change","changeIndex","match","remove"])},a.normalizeReconnects=function(a){return void 0===a?-1:a<0?-1:Number(a)},a.normalizeOperations=function(b){return a.normalizeSortedSet(b,"any","operations",["delete","insert","none","update"])},a.normalizeSortedSet=function(a,b,c,d){if(!a)return[b];if(Array.isArray(a)||(a=[a]),0==a.length)return[b];a.sort();for(var e=void 0,f=void 0,g=a.length-1;g>=0;g--){if(!(e=a[g]))throw new Error("undefined and null not allowed!");if(e===f&&a.splice(g,1),e===b)return[b];if(-1==d.indexOf(e))throw new Error(e+" not allowed for "+c+"! (permitted: "+d+".)");f=e}return a},a._resolveObject=function(a,b){var c=a.getReference(b.id),d=e.get(c);return b.version?c.version<=b.version&&d.setJson(b,{persisting:!0}):(d.setRemoved(),a.removeReference(c)),c},a}();c.exports=h},{34:34,66:66,77:77}],184:[function(a,b,c){"use strict";b.exports=c=a(6),c.Observable=a(181),c.EntityManagerFactory=a(177),c.connector.WebSocketConnector=a(178),c.query.Node=a(182),c.query.Stream=a(183)},{177:177,178:178,181:181,182:182,183:183,6:6}]},{},[180])(180)});