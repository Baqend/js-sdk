/*! baqend 2.14.0 | Copyright (c) 2015 Baqend GmbH | MIT */

!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).DB=t()}(function(){var D={};function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return D.typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D.classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},D.createClass=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t},D.defaults=function(t,e){for(var r=Object.getOwnPropertyNames(e),n=0;n<r.length;n++){var i=r[n],o=Object.getOwnPropertyDescriptor(e,i);o&&o.configurable&&void 0===t[i]&&Object.defineProperty(t,i,o)}return t},D.inherits=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):D.defaults(t,e))},D.possibleConstructorReturn=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},function o(s,a,u){function c(e,t){if(!a[e]){if(!s[e]){var r="function"==typeof require&&require;if(!t&&r)return r(e,!0);if(h)return h(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var i=a[e]={exports:{}};s[e][0].call(i.exports,function(t){return c(s[e][1][t]||t)},i,i.exports,o,s,a,u)}return a[e].exports}for(var h="function"==typeof require&&require,t=0;t<u.length;t++)c(u[t]);return c}({1:[function(t,e,r){"use strict";var n=t(67),i=(o.prototype.clear=function(){this.read.clear(),this.write.clear()},o.prototype.copy=function(t){return this.read.copy(t.read),this.write.copy(t.write),this},o.prototype.isPublicReadAllowed=function(){return this.read.isPublicAllowed()},o.prototype.setPublicReadAllowed=function(){return this.read.setPublicAllowed()},o.prototype.isReadAllowed=function(t){return this.read.isAllowed(t)},o.prototype.isReadDenied=function(t){return this.read.isDenied(t)},o.prototype.allowReadAccess=function(){return n.prototype.allowAccess.apply(this.read,arguments),this},o.prototype.denyReadAccess=function(){return n.prototype.denyAccess.apply(this.read,arguments),this},o.prototype.deleteReadAccess=function(){return n.prototype.deleteAccess.apply(this.read,arguments),this},o.prototype.isPublicWriteAllowed=function(){return this.write.isPublicAllowed()},o.prototype.setPublicWriteAllowed=function(){return this.write.setPublicAllowed()},o.prototype.isWriteAllowed=function(t){return this.write.isAllowed(t)},o.prototype.isWriteDenied=function(t){return this.write.isDenied(t)},o.prototype.allowWriteAccess=function(){return n.prototype.allowAccess.apply(this.write,arguments),this},o.prototype.denyWriteAccess=function(){return n.prototype.denyAccess.apply(this.write,arguments),this},o.prototype.deleteWriteAccess=function(){return n.prototype.deleteAccess.apply(this.write,arguments),this},o.prototype.toJSON=function(){return{read:this.read.toJSON(),write:this.write.toJSON()}},o.prototype.fromJSON=function(t){this.read.fromJSON(t.read||{}),this.write.fromJSON(t.write||{})},o);function o(t){D.classCallCheck(this,o),this.read=new n(t),this.write=new n(t)}e.exports=i},{67:67}],2:[function(t,e,r){"use strict";var n,u=t(34),c=t(33),i=t(19),a=t(75),o=t(61),s=t(18),d=t(65),h=t(25),l=t(21),p=t(73),f=h.StatusCode,y="/db/",g=(n=a.Lockable,D.inherits(m,n),D.createClass(m,[{key:"isOpen",get:function(){return!!this.connection}},{key:"token",get:function(){return this.tokenStorage.token},set:function(t){this.tokenStorage.update(t)}},{key:"isCachingDisabled",get:function(){return!this.bloomFilter}},{key:"isDeviceRegistered",get:function(){return!!this.deviceMe}}]),m.prototype.connected=function(t,e,r){this.connection=t,this.tokenStorage=r,this.bloomFilterRefresh=this.entityManagerFactory.staleness,this.entities={},this.File=i.FileFactory.create(this),this._createObjectFactory(this.metamodel.embeddables),this._createObjectFactory(this.metamodel.entities),this.transaction={},this.modules=new a.Modules(this,t),e&&(e.device&&this.updateDevice(e.device),e.user&&r.token&&this._updateUser(e.user,!0),0<this.bloomFilterRefresh&&e.bloomFilter&&a.atob&&!a.isNode&&this.updateBloomFilter(e.bloomFilter))},m.prototype._createObjectFactory=function(t){var n=this;Object.keys(t).forEach(function(t){var e=n.metamodel.managedType(t),r=e.name;n[r]?(e.typeConstructor=n[r],Object.defineProperty(n,r,{value:e.createObjectFactory(n)})):Object.defineProperty(n,r,{get:function(){return Object.defineProperty(this,r,{value:e.createObjectFactory(this)}),this[r]},set:function(t){e.typeConstructor=t},configurable:!0})},this)},m.prototype.send=function(t,e){var r=this,n=t;n.tokenStorage=this.tokenStorage;var i=this.connection.send(n);return e||(i=i.catch(function(t){throw t.status===f.BAD_CREDENTIALS&&r._logout(),t})),i},m.prototype.getReference=function(t,e){var r,n,i=void 0,o=void 0;e?(r=e,o=this.metamodel.entity(t),i=0===r.indexOf(y)?r:o.ref+"/"+encodeURIComponent(r)):o="string"==typeof t?(-1!==(n=t.indexOf("/",y.length))&&(i=t),this.metamodel.entity(-1===n?t:i.substring(0,n))):this.metamodel.entity(t);var s,a=this.entities[i];return a||(a=o.create(),s=d.get(a),i&&(s.id=i),s.setUnavailable(),this._attach(a)),a},m.prototype.createQueryBuilder=function(t){return new o.Builder(this,t)},m.prototype.clear=function(){this.entities={}},m.prototype.close=function(){return this.connection=null,this.clear()},m.prototype.contains=function(t){return!!t&&this.entities[t.id]===t},m.prototype.containsById=function(t){return!(!t||!this.entities[t.id])},m.prototype.detach=function(t){var e=this;return d.get(t).withLock(function(){return e.removeReference(t),Promise.resolve(t)})},m.prototype.resolveDepth=function(t,e){var r=this;if(!e||!e.depth)return Promise.resolve(t);e.resolved=e.resolved||[];var n=[],i=Object.assign({},e,{depth:!0===e.depth||e.depth-1});return this.getSubEntities(t,1).forEach(function(t){null!==t&&-1===e.resolved.indexOf(t)&&(e.resolved.push(t),n.push(r.load(t.id,null,i)))}),Promise.all(n).then(function(){return t})},m.prototype.load=function(e,r,t){var n=this,i=t||{},o=this.getReference(e,r),s=d.get(o);if(!i.refresh&&i.local&&s.isAvailable)return this.resolveDepth(o,i);var a=new u.GetObject(s.bucket,s.key);return this.ensureCacheHeader(o.id,a,i.refresh),this.send(a).then(function(t){return o.version>t.entity.version?(i.refresh=!0,n.load(e,r,i)):(n.addToWhiteList(t.entity.id),t.status!==f.NOT_MODIFIED&&s.setJson(t.entity,{persisting:!0}),n.resolveDepth(o,i))},function(t){if(t.status===f.OBJECT_NOT_FOUND)return n.removeReference(o),s.setRemoved(),null;throw t})},m.prototype.insert=function(e,t){var r=this,n=t||{},i=void 0;return this._save(e,n,function(t,e){if(t.version)throw new c.PersistentError("Existing objects can't be inserted.");return i=!t.id,new u.CreateObject(t.bucket,e)}).then(function(t){return i&&r._attach(e),t})},m.prototype.update=function(t,e){var r=e||{};return this._save(t,r,function(t,e){if(!t.version)throw new c.PersistentError("New objects can't be inserted.");return r.force?(delete e.version,new u.ReplaceObject(t.bucket,t.key,e).ifMatch("*")):new u.ReplaceObject(t.bucket,t.key,e).ifMatch(t.version)})},m.prototype.save=function(t,e,r){function n(t,e){if(i.force){if(!t.id)throw new c.PersistentError("New special objects can't be forcedly saved.");return delete e.version,new u.ReplaceObject(t.bucket,t.key,e)}return t.version?new u.ReplaceObject(t.bucket,t.key,e).ifMatch(t.version):new u.CreateObject(t.bucket,e)}var i=e||{};return r?this._locklessSave(t,i,n):this._save(t,i,n)},m.prototype.optimisticSave=function(t,e){var r=this;return d.get(t).withLock(function(){return r._optimisticSave(t,e)})},m.prototype._optimisticSave=function(e,r){var n=this,t=!1,i=Promise.resolve(r(e,function(){t=!0}));return t?Promise.resolve(e):i.then(function(){return n.save(e,{},!0).catch(function(t){if(412===t.status)return n.refresh(e,{}).then(function(){return n._optimisticSave(e,r)});throw t})})},m.prototype._locklessSave=function(e,r,n){var i=this;this.attach(e);var o=d.get(e),s=void 0,t=void 0;o.isAvailable&&(t=o.getJson({persisting:!0})),s=o.isDirty?(r.refresh||o.setPersistent(),[this.send(n(o,t)).then(function(t){return o.id&&o.id!==t.entity.id&&(i.removeReference(e),o.id=t.entity.id,i._attach(e)),o.setJson(t.entity,{persisting:r.refresh,onlyMetadata:!r.refresh}),e},function(t){if(t.status===f.OBJECT_NOT_FOUND)return i.removeReference(e),o.setRemoved(),null;throw o.setDirty(),t})]):[Promise.resolve(e)];var a=Object.assign({},r);return a.depth=0,this.getSubEntities(e,r.depth).forEach(function(t){s.push(i._save(t,a,n))}),Promise.all(s).then(function(){return e})},m.prototype._save=function(t,e,r){var n=this;this.ensureBloomFilterFreshness();var i=d.get(t);return i.version&&this.addToBlackList(t.id),i.withLock(function(){return n._locklessSave(t,e,r)})},m.prototype.getSubEntities=function(t,e,r,n){var i=r||[];if(!e)return i;for(var o=n||t,s=d.get(t).type.references(),a=s.next();!a.done;a=s.next())for(var u=a.value,c=this.getSubEntitiesByPath(t,u.path),h=0,l=c.length;h<l;h+=1){var p=c[h];-1===i.indexOf(p)&&p!==o&&(i.push(p),i=this.getSubEntities(p,!0===e?e:e-1,i,o))}return i},m.prototype.getSubEntitiesByPath=function(t,e){var u=this,r=[t];return e.forEach(function(s){var a=[];r.forEach(function(t){var e=t[s];if(e){var r=u.metamodel.managedType(t.constructor).getAttribute(s);if(r.isCollection)for(var n=e.entries(),i=n.next();!i.done;i=n.next()){var o=i.value;a.push(o[1]),r.keyType&&r.keyType.isEntity&&a.push(o[0])}else a.push(e)}}),r=a}),r},m.prototype.delete=function(n,t){var i=this,o=t||{};this.attach(n);var s=d.get(n);return s.withLock(function(){if(!s.version&&!o.force)throw new c.IllegalEntityError(n);var t=new u.DeleteObject(s.bucket,s.key);i.addToBlackList(n.id),o.force||t.ifMatch(s.version);var e=[i.send(t).then(function(){return i.removeReference(n),s.setRemoved(),n})],r=Object.assign({},o);return r.depth=0,i.getSubEntities(n,o.depth).forEach(function(t){e.push(i.delete(t,r))}),Promise.all(e).then(function(){return n})})},m.prototype.flush=function(){},m.prototype.persist=function(t){this.attach(t)},m.prototype.refresh=function(t,e){var r=e||{};return r.refresh=!0,this.load(t.id,null,r)},m.prototype.attach=function(t){if(!this.contains(t)){if(!this.metamodel.entity(t.constructor))throw new c.IllegalEntityError(t);if(this.containsById(t))throw new c.EntityExistsError(t);this._attach(t)}},m.prototype._attach=function(t){var e=d.get(t);if(e.isAttached){if(e.db!==this)throw new c.EntityExistsError(t)}else e.db=this;e.id||"User"!==e.type.name&&"Role"!==e.type.name&&"logs.AppLog"!==e.type.name&&(e.id=y+e.type.name+"/"+a.uuid()),e.id&&(this.entities[e.id]=t)},m.prototype.removeReference=function(t){var e=d.get(t);if(!e)throw new c.IllegalEntityError(t);delete this.entities[e.id]},m.prototype.register=function(e,r,n){var i=this,o=n>s.LoginOption.NO_LOGIN;if(this.me&&o)throw new c.PersistentError("User is already logged in.");return this.withLock(function(){var t=new u.Register({user:e,password:r,login:o});return i._userRequest(t,n)})},m.prototype.login=function(e,r,n){var i=this;if(this.me)throw new c.PersistentError("User is already logged in.");return this.withLock(function(){var t=new u.Login({username:e,password:r});return i._userRequest(t,n)})},m.prototype.logout=function(){var t=this;return this.withLock(function(){return t.send(new u.Logout).then(t._logout.bind(t))})},m.prototype.loginWithOAuth=function(t,e,r){if(this.me)throw new c.PersistentError("User is already logged in.");var n=Object.assign({title:"Login with "+t,timeout:3e5,state:{},loginOption:!0},r);n.redirect&&Object.assign(n.state,{redirect:n.redirect,loginOption:n.loginOption});var i=void 0;if(!h[t+"OAuth"])throw new Error("OAuth provider "+t+" not supported.");(i=new h[t+"OAuth"](e,n.scope,JSON.stringify(n.state))).addRedirectOrigin(this.connection.origin+this.connection.basePath),n.path&&i.path(n.path);var o={width:n.width,height:n.height};if(n.redirect){var s=-1!==document.URL.indexOf("http://")||-1!==document.URL.indexOf("https://");return this.openOAuthWindow(i.request.path,s?"_self":"_system",o),new Promise(function(){})}var a=this._userRequest(i,n.loginOption);return this.openOAuthWindow(i.request.path,n.title,o),new Promise(function(t,e){var r=setTimeout(function(){e(new c.PersistentError("OAuth login timeout."))},n.timeout);a.then(t,e).then(function(){clearTimeout(r)})})},m.prototype.openOAuthWindow=function(t,e,r){var n=Object.keys(r).filter(function(t){return void 0!==r[t]}).map(function(t){return t+"="+r[t]}).join(",");open(t,e,n)},m.prototype.renew=function(e){var r=this;return this.withLock(function(){var t=new u.Me;return r._userRequest(t,e)})},m.prototype.newPassword=function(e,r,n){var i=this;return this.withLock(function(){var t=new u.NewPassword({username:e,password:r,newPassword:n});return i.send(t,!0).then(function(t){return i._updateUser(t.entity)})})},m.prototype.newPasswordWithToken=function(t,e,r){var n=this;return this.withLock(function(){return n._userRequest(new u.NewPassword({token:t,newPassword:e}),r)})},m.prototype.resetPassword=function(t){return this.send(new u.ResetPassword({username:t}))},m.prototype.changeUsername=function(t,e,r){return this.send(new u.ChangeUsername({username:t,newUsername:e,password:r}))},m.prototype._updateUser=function(t,e){var r=this.getReference(t.id);return d.get(r).setJson(t,{persisting:!0}),e&&(this.me=r),r},m.prototype._logout=function(){this.me=null,this.token=null},m.prototype._userRequest=function(t,e){var r=this,n=void 0===e||e,i=n>s.LoginOption.NO_LOGIN;return i&&(this.tokenStorage.temporary=n<s.LoginOption.PERSIST_LOGIN),this.send(t,!i).then(function(t){return t.entity?r._updateUser(t.entity,i):null},function(t){if(t.status===f.OBJECT_NOT_FOUND)return i&&r._logout(),null;throw t})},m.prototype.registerDevice=function(t,e,r){var n=this,i=new u.DeviceRegister({devicetype:t,subscription:e,device:r});return i.withCredentials=!0,this.send(i).then(function(t){return n.updateDevice(t.entity)})},m.prototype.updateDevice=function(t){var e=this.getReference(t.id);return d.get(e).setJson(t,{persisting:!0}),this.deviceMe=e},m.prototype.checkDeviceRegistration=function(){var e=this;return this.send(new u.DeviceRegistered).then(function(){return e.isDeviceRegistered=!0},function(t){if(t.status===f.OBJECT_NOT_FOUND)return e.isDeviceRegistered=!1;throw t})},m.prototype.pushDevice=function(t){return this.send(new u.DevicePush(t))},m.prototype.validate=function(t){for(var e=d.get(t).type,r=new a.ValidationResult,n=e.attributes(),i=n.next();!i.done;i=n.next()){var o=new a.Validator(i.value.name,t);r.fields[o.key]=o}var s=e.validationCode;return s&&s(r.fields),r},m.prototype.addToWhiteList=function(t){this.isCachingDisabled||(this.bloomFilter.contains(t)&&this.cacheWhiteList.add(t),this.cacheBlackList.delete(t))},m.prototype.addToBlackList=function(t){this.isCachingDisabled||(this.bloomFilter.contains(t)||this.cacheBlackList.add(t),this.cacheWhiteList.delete(t))},m.prototype.refreshBloomFilter=function(){var e=this;if(this.isCachingDisabled)return Promise.resolve();var t=new u.GetBloomFilter;return t.noCache(),this.send(t).then(function(t){return e.updateBloomFilter(t.entity),e.bloomFilter})},m.prototype.updateBloomFilter=function(t){this.bloomFilter=new l(t),this.cacheWhiteList=new Set,this.cacheBlackList=new Set},m.prototype.ensureBloomFilterFreshness=function(){var t,e,r=this;this.isCachingDisabled||(t=(new Date).getTime(),e=1e3*this.bloomFilterRefresh,this.bloomFilterLock.isReady&&t-this.bloomFilter.creation>e&&this.bloomFilterLock.withLock(function(){return r.refreshBloomFilter()}))},m.prototype.mustRevalidate=function(t){return!a.isNode&&(this.ensureBloomFilterFreshness(),this.isCachingDisabled||!this.bloomFilterLock.isReady||!this.cacheWhiteList.has(t)&&(this.cacheBlackList.has(t)||this.bloomFilter.contains(t)))},m.prototype.ensureCacheHeader=function(t,e,r){(r||this.mustRevalidate(t))&&e.noCache()},m.prototype.createURL=function(t,e){var r=this.connection.basePath+t,n=!1;return e&&this.me?(r=this.tokenStorage.signPath(r),n=!0):r=r.split("/").map(encodeURIComponent).join("/"),this.mustRevalidate(t)&&(r=r+(n?"&":"?")+"BCB"),this.connection.origin+r},m.prototype.requestAPIToken=function(t,e){var r=this._getUserReference(t,e),n=new u.UserToken(r.key);return this.send(n).then(function(t){return t.entity})},m.prototype.revokeAllTokens=function(t,e){var r=this._getUserReference(t,e),n=new u.RevokeUserToken(r.key);return this.send(n)},m.prototype._getUserReference=function(t,e){return"string"==typeof e?this.getReference(t,e):e},m);function m(t){D.classCallCheck(this,m);var e=D.possibleConstructorReturn(this,n.call(this));return e.log=a.Logger.create(e),e.connection=null,e.entities=null,e.entityManagerFactory=t,e.metamodel=t.metamodel,e.code=t.code,e.modules=null,e.me=null,e.deviceMe=null,e.tokenStorage=null,e.bloomFilter=null,e.cacheWhiteList=null,e.cacheBlackList=null,e.bloomFilterRefresh=60,e.bloomFilterLock=new a.Lockable,e}g.prototype.List=Array,g.prototype.Set=Set,g.prototype.Map=Map,g.prototype.GeoPoint=t(4),p(g.prototype,"_connector","connection"),p(g.prototype,"_entities","entities"),p(g.prototype,"_bloomFilterLock","bloomFilterLock"),e.exports=g},{18:18,19:19,21:21,25:25,33:33,34:34,4:4,61:61,65:65,73:73,75:75}],3:[function(t,e,r){"use strict";var o,s=t(34),n=t(50),a=t(75),i=t(73),u=t(23),c=t(2),h=Symbol("Connected"),l=(o=a.Lockable,D.inherits(p,o),p.prototype.configure=function(t){if(this.connection)throw new Error("The EntityManagerFactory can only be configured before is is connected.");t.tokenStorage&&(this.tokenStorage=t.tokenStorage),t.tokenStorageFactory&&(this.tokenStorageFactory=t.tokenStorageFactory),void 0!==t.staleness&&(this.staleness=t.staleness)},p.prototype.connect=function(t,e,r,n){if(this.connection)throw new Error("The EntityManagerFactory is already connected.");return Object(e)instanceof Boolean?this.connect(t,0,e,r):(this.connection=u.create(t,e,r,n),this[h](),this.ready())},p.prototype.createMetamodel=function(){return new n.Metamodel(this)},p.prototype.createEntityManager=function(t){var e=this,r=new c(this);return this.isReady?r.connected(this.connection,this.connectData,t?this.tokenStorage:new a.TokenStorage(this.connection.origin)):r.withLock(function(){return e.ready().then(function(){r.connected(e.connection,e.connectData,t?e.tokenStorage:new a.TokenStorage(e.connection.origin))})},!0),r},p.prototype.send=function(t){return t.tokenStorage||(t.tokenStorage=this.tokenStorage),this.connection.send(t)},p);function p(t){D.classCallCheck(this,p);var e=D.possibleConstructorReturn(this,o.call(this)),r=Object(t)instanceof String?{host:t}:t||{};e.connection=null,e.metamodel=e.createMetamodel(),e.code=new a.Code(e.metamodel,e),e.tokenStorageFactory=a.TokenStorage.WEB_STORAGE||a.TokenStorage.GLOBAL,e.configure(r);var n=!0,i=new Promise(function(t){e[h]=t});return r.host?e.connect(r.host,r.port,r.secure,r.basePath):n=!1,e.tokenStorage||(n=!1,i=i.then(function(){return e.tokenStorageFactory.create(e.connection.origin)}).then(function(t){e.tokenStorage=t})),r.schema?(e.connectData=r,e.metamodel.init(r.schema)):(n=!1,i=i.then(function(){var t=new s.Connect;return t.withCredentials=!0,0===e.staleness&&t.noCache(),e.send(t)}).then(function(t){e.connectData=t.entity,void 0===e.staleness&&(e.staleness=e.connectData.bloomFilterRefresh||60),e.metamodel.isInitialized||e.metamodel.init(e.connectData.schema),e.tokenStorage.update(e.connectData.token)})),n||e.withLock(function(){return i},!0),e}i(l.prototype,"_connector","connection"),i(l.prototype,"_connected",h),e.exports=l},{2:2,23:23,34:34,50:50,73:73,75:75}],4:[function(t,e,r){"use strict";var n=(o.current=function(){return new Promise(function(e,r){navigator||r(new Error("This seems not to be a browser context.")),navigator.geolocation||r(new Error("This browser does not support geolocation.")),navigator.geolocation.getCurrentPosition(function(t){e(new o(t.coords.latitude,t.coords.longitude))},function(t){r(t)})})},o.prototype.kilometersTo=function(t){return Number((o.EARTH_RADIUS_IN_KILOMETERS*this.radiansTo(t)).toFixed(3))},o.prototype.milesTo=function(t){return Number((o.EARTH_RADIUS_IN_MILES*this.radiansTo(t)).toFixed(3))},o.prototype.radiansTo=function(t){var e=this.latitude*o.DEG_TO_RAD,r=t.latitude*o.DEG_TO_RAD,n=(t.longitude-this.longitude)*o.DEG_TO_RAD;return Math.acos(Math.sin(e)*Math.sin(r)+Math.cos(e)*Math.cos(r)*Math.cos(n))},o.prototype.toString=function(){return this.latitude+";"+this.longitude},o.prototype.toJSON=function(){return{latitude:this.latitude,longitude:this.longitude}},o);function o(t,e){D.classCallCheck(this,o);var r,n=void 0,i=void 0;if(i=Object(t)instanceof String?(r=t.indexOf(";"),n=t.substring(0,r),t.substring(r+1)):Object(t)instanceof Number?(n=t,e):Object(t)instanceof Array?(n=t[0],t[1]):t instanceof Object?(n=t.latitude,t.longitude):n=0,this.longitude=i,this.latitude=n,this.latitude<-90||90<this.latitude)throw new Error("Latitude "+this.latitude+" is not in bound of -90 <= latitude <= 90");if(this.longitude<-180||180<this.longitude)throw new Error("Longitude "+this.longitude+" is not in bound of -180 <= longitude <= 180")}n.DEG_TO_RAD=Math.PI/180,n.EARTH_RADIUS_IN_KILOMETERS=6371,n.EARTH_RADIUS_IN_MILES=3956,e.exports=n},{}],5:[function(t,e,r){"use strict";var n=t(3),i=t(2);i.prototype.binding=t(19),i.prototype.connector=t(27),i.prototype.error=t(33),i.prototype.message=t(34),i.prototype.metamodel=t(50),i.prototype.util=t(75),i.prototype.caching=t(22),i.prototype.query=t(61),i.prototype.partialupdate=t(54),i.prototype.EntityManager=t(2),i.prototype.EntityManagerFactory=t(3),i.prototype.Acl=t(1);var o=new n,s=o.createEntityManager(!0);s.configure=function(t){return o.configure(t),this},s.connect=function(t,e,r,n){return e instanceof Function?this.connect(t,void 0,e,r):(o.connect(t,e),this.ready(r,n))},(r=s).db=s,r.default=s,e.exports=r},{1:1,19:19,2:2,22:22,27:27,3:3,33:33,34:34,50:50,54:54,61:61,75:75}],6:[function(t,e,r){"use strict";var n=(i.prototype.getValue=function(t,e){return t[e.name]},i.prototype.setValue=function(t,e,r){t[e.name]=r},i);function i(){D.classCallCheck(this,i)}e.exports=n},{}],7:[function(t,e,r){"use strict";var n=t(10),i=t(34),o=n.extend({get me(){return this.db.deviceMe},get isRegistered(){return this.db.isDeviceRegistered},loadWebPushKey:function(){var t=new i.VAPIDPublicKey;return t.responseType("arraybuffer"),this.db.send(t).then(function(t){return t.entity})},register:function(t,e,r,n,i){if(r instanceof Function)return this.register(t,e,null,r,n);var o="string"==typeof e?{token:e}:e;return this.db.registerDevice(t,o,r).then(n,i)},push:function(t,e,r){return this.db.pushDevice(t).then(e,r)}});o.PushMessage=t(68),e.exports=o},{10:10,34:34,68:68}],8:[function(t,e,r){"use strict";var n=Symbol("BaqendId"),i=Symbol("BaqendType"),o=(s.prototype.createProxy=function(t){return r=t,D.inherits(e,r),e;function e(){return D.classCallCheck(this,e),D.possibleConstructorReturn(this,r.apply(this,arguments))}var r},s.getBaqendType=function(t){return t[i]},s.getIdentifier=function(t){return t[n]},s.setIdentifier=function(t,e){t[n]=e},s.prototype.enhance=function(t,e){if(e[i]!==t){if(Object.prototype.hasOwnProperty.call(e,i))throw new Error("Type is already used by a different manager");e[i]=t,s.setIdentifier(e,t.ref),this.enhancePrototype(e.prototype,t)}},s.prototype.enhancePrototype=function(e,t){var r=this;e.toString===Object.prototype.toString&&Object.defineProperty(e,"toString",{value:function(){return this._metadata.id||this._metadata.bucket},enumerable:!1}),t.superType&&"Object"===t.superType.name&&t.superType.declaredAttributes.forEach(function(t){t.isMetadata||r.enhanceProperty(e,t)}),t.declaredAttributes.forEach(function(t){r.enhanceProperty(e,t)})},s.prototype.enhanceProperty=function(t,e){var r="$"+e.name;Object.defineProperty(t,e.name,{get:function(){var t=this._metadata;return t.readAccess(),t[r]},set:function(t){var e=this._metadata;e.writeAccess(),e[r]=t},configurable:!0,enumerable:!0})},s);function s(){D.classCallCheck(this,s)}e.exports=o},{}],9:[function(t,e,r){"use strict";var n,i=t(14),o=t(51),s=(n=i,D.inherits(a,n),a);function a(){return D.classCallCheck(this,a),D.possibleConstructorReturn(this,n.apply(this,arguments))}Object.defineProperties(s.prototype,{id:{get:function(){return this._metadata.id},set:function(t){if(this._metadata.id)throw new Error("The id can't be set twice: "+t);0===(t+"").indexOf("/db/"+this._metadata.bucket+"/")?this._metadata.id=t:this.key=t},enumerable:!0},key:{get:function(){return this._metadata.key},set:function(t){this._metadata.key=t}},version:{get:function(){return this._metadata.version},enumerable:!0},acl:{get:function(){return this._metadata.acl},enumerable:!0},ready:{value:function(t){return this._metadata.ready(t)}},attach:{value:function(t){t.attach(this)}},save:{value:function(t,e,r){return t instanceof Function?this.save({},t,e):this._metadata.db.save(this,t).then(e,r)}},insert:{value:function(t,e,r){return t instanceof Function?this.insert({},t,e):this._metadata.db.insert(this,t).then(e,r)}},update:{value:function(t,e,r){return t instanceof Function?this.update({},t,e):this._metadata.db.update(this,t).then(e,r)}},load:{value:function(t,e,r){if(t instanceof Function)return this.load({},t,e);var n=t||{};return n.local=!0,this._metadata.db.load(this.id,null,n).then(e,r)}},delete:{value:function(t,e,r){return t instanceof Function?this.delete({},t,e):this._metadata.db.delete(this,t).then(e,r)}},optimisticSave:{value:function(t,e,r){return this._metadata.db.optimisticSave(this,t).then(e,r)}},attr:{value:function(){throw new Error("Attr is not yet implemented.")}},validate:{value:function(){return this._metadata.db.validate(this)}},partialUpdate:{value:function(t){return new o(this,t)}},getReferencing:{value:function(t){var o=this,s=this._metadata.db,e=this._metadata.type.getReferencing(s,t),r=Array.from(e).map(function(t){var e=t[0],r=s.createQueryBuilder(e.typeConstructor),n=t[1],i=[];return n.forEach(function(t){i.push(r.equal(t,o))}),(1===i.length?i[0]:r.or(i)).resultList()});return Promise.all(r).then(function(t){return t.filter(function(t){return!!t.length})}).then(function(t){return[].concat.apply([],t)})}},toJSON:{value:function(t){var e=t;return"boolean"==typeof e&&(e={excludeMetadata:e}),"object"!==(void 0===e?"undefined":D.typeof(e))&&(e={}),this._metadata.getJson(e)}}}),e.exports=s},{14:14,51:51}],10:[function(t,e,r){"use strict";var n=t(15).extend({load:function(t,e,r,n){return e instanceof Function?this.load(t,{},e,r):this.db.load(this.managedType.typeConstructor,t,e).then(r,n)},ref:function(t){return this.db.getReference(this.managedType.ref,t)},fromJSON:function(t){var e=this.ref(t.id);return this.managedType.fromJsonValue(null,t,e)},find:function(){return this.db.createQueryBuilder(this.managedType.typeConstructor)},partialUpdate:function(t,e){return this.ref(t).partialUpdate(e)}});e.exports=n},{15:15}],11:[function(t,e,r){"use strict";var n=t(73);function i(t){for(var e=1,r=arguments.length;e<r;e+=1)for(var n=arguments[e],i=Object.getOwnPropertyNames(n),o=0,s=i.length;o<s;o+=1){var a=i[o];Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(n,a))}return t}var o=i({extend:function(t){return i({},this,t)},create:function(t){var e=function(t){return e.newInstance(arguments)};return i(e,this),e.prototype=t.prototype,e.type=t,e},new:function(){return this.newInstance(arguments)},newInstance:function(t){if(!t||0===t.length)return new this.type;var e=[null];return Array.prototype.push.apply(e,t),new(Function.prototype.bind.apply(this.type,e))}});n(o,"_type","type"),e.exports=o},{73:73}],12:[function(t,e,r){"use strict";var n=t(33),i=t(1),o=t(77).uuid,a=t(34),u=t(25).StatusCode,s=t(73),c=t(20).trailingSlashIt,h="/file".length,l=Symbol("Id"),p=Symbol("Metadata"),d=Symbol("Data"),f=(D.createClass(y,[{key:"id",get:function(){return this[l]}},{key:"url",get:function(){if(this.isFolder)throw new Error("Url can not be created for folders.");return this.db.createURL(this.id,"www"!==this.bucket)}},{key:"name",get:function(){return this.id.substring(this.id.lastIndexOf("/",this.id.length-2)+1)}},{key:"mimeType",get:function(){if(this.isFolder)throw new Error("A folder has no mimeType");return this.checkAvailable(),this[p].mimeType}},{key:"acl",get:function(){return this.checkAvailable(),this[p].acl}},{key:"lastModified",get:function(){if(this.isFolder)throw new Error("A folder has no lastModified");return this.checkAvailable(),this[p].lastModified}},{key:"createdAt",get:function(){if(this.isFolder)throw new Error("A folder has no creation date");return this.checkAvailable(),this[p].createdAt}},{key:"eTag",get:function(){if(this.isFolder)throw new Error("A folder has no eTag");return this.checkAvailable(),this[p].eTag}},{key:"headers",get:function(){if(this.isFolder)throw new Error("A folder has no custom headers");return this.checkAvailable(),this[p].headers}},{key:"size",get:function(){if(this.isFolder)throw new Error("A folder has no size");return this.checkAvailable(),this[p].size}},{key:"bucket",get:function(){return this.id.substring(h+1,this.id.indexOf("/",h+1))}},{key:"key",get:function(){return this.id.substring(this.id.indexOf("/",h+1)+1)}},{key:"path",get:function(){return this.id.substring(h)}},{key:"parent",get:function(){return this.id.substring(h,this.id.lastIndexOf("/",this.id.length-2))}},{key:"isMetadataLoaded",get:function(){return!!this[p]}}]),y.parseETag=function(t){if(!t)return null;var e=t.match(/^(?:[wW]\/)?["'](.*)["']$/);return e?e[1]:null},y.prototype.upload=function(t,e,r){var n=this,i=t||{};if(this.isFolder)throw new Error("A folder cannot be uploaded");this.setDataOptions(i);var o=new a.UploadFile(this.bucket,this.key).entity(this[d].data,this[d].type),s=this[p];return s&&(o.acl(s.acl),o.contentLength(s.size),o.mimeType(s.mimeType),o.customHeaders(s.headers)),o.progress(i.progress),this.conditional(o,i),this.db.addToBlackList(this.id),this.db.send(o).then(function(t){return n[d]=null,n.fromJSON(t.entity),n}).then(e,r)},y.prototype.download=function(t,e,r){var n=this,i=t||{};if(this.isFolder)throw new Error("A folder cannot be downloaded");var o=i.type||"blob",s=new a.DownloadFile(this.bucket,this.key).responseType(o);return this.db.ensureCacheHeader(this.id,s,i.refresh),this.db.send(s).then(function(t){return n.db.addToWhiteList(n.id),n.fromHeaders(t.headers),t.entity},function(t){if(t.status===u.OBJECT_NOT_FOUND)return null;throw t}).then(e,r)},y.prototype.delete=function(t,e,r){var n=this,i=t||{},o=new a.DeleteFile(this.bucket,this.key);return this.conditional(o,i),this.isFolder||this.db.addToBlackList(this.id),this.db.send(o).then(function(t){return n.isFolder?t.entity.map(function(t){return n.db.File(t)}):n}).then(e,r)},y.prototype.createIdFromOptions=function(t){var e=void 0;if(t.path)e=t.path;else{var r=c(t.parent||"/www");if(r.length<3)throw new Error("Invalid parent name: "+r);e=r+(t.name||t.data&&t.data.name||o())}if("/"!==e.charAt(0)&&(e="/"+e),-1!==e.indexOf("//")||e.length<3)throw new Error("Invalid path: "+e);return"/file"+e},y.prototype.conditional=function(t,e){var r;e.force||((r=this[p])&&(r.lastModified||r.eTag)?(t.ifUnmodifiedSince(r.lastModified),t.ifMatch(r.eTag)):t.ifNoneMatch("*"))},y.prototype.loadMetadata=function(t,e,r){var n=this,i=t||{};if(this.isFolder)throw new Error("A folder has no matadata.");var o=new a.GetFileMetadata(this.bucket,this.key);return this.db.ensureCacheHeader(this.id,o,i.refresh),this.db.send(o).then(function(t){return n.fromHeaders(t.headers),n},function(t){if(t.status===u.OBJECT_NOT_FOUND)return null;throw t}).then(e,r)},y.prototype.saveMetadata=function(t,e,r){var n=this,i=t||{},o=this.toJSON(),s=new a.UpdateFileMetadata(this.bucket,this.key).entity(o);return this.conditional(s,i),this.db.send(s).then(function(t){return n.fromJSON(t.entity),n}).then(e,r)},y.prototype.setDataOptions=function(t){var e,r=t.data,n=t.type;r&&(this[d]={type:n,data:r},e=this.guessMimeType(t),this.fromJSON(Object.assign({},t,{mimeType:e})))},y.prototype.guessMimeType=function(t){var e=t.mimeType;return e||("undefined"!=typeof Blob&&t.data instanceof Blob?t.data.type:"data-url"!==t.type?null:t.data.match(/^data:(.+?)(;base64)?,.*$/)[1])},y.prototype.fromHeaders=function(t){this.fromJSON({eTag:y.parseETag(t.etag),lastModified:t["last-modified"],createdAt:t["baqend-created-at"],mimeType:t["content-type"],acl:t["baqend-acl"]&&JSON.parse(t["baqend-acl"]),size:+t["baqend-size"],headers:t["baqend-custom-headers"]&&JSON.parse(t["baqend-custom-headers"])})},y.prototype.fromJSON=function(t){if(t.id&&this.id!==t.id)throw new Error("This file id "+this.id+" does not match the given json id "+t.id);var e=this[p]||{},r=void 0;t.acl instanceof i?r=t.acl:(r=e.acl||new i,t.acl&&r.fromJSON(t.acl)),this[p]=Object.assign({},this[p],{mimeType:t.mimeType,lastModified:t.lastModified&&new Date(t.lastModified)||e.lastModified,createdAt:t.createdAt&&new Date(t.createdAt)||e.createdAt,eTag:t.eTag||e.eTag,acl:r,size:"number"==typeof t.size?t.size:t.contentLength,headers:t.headers||e.headers||{}})},y.prototype.toJSON=function(){this.checkAvailable();var t=this[p];return{id:this.id,mimeType:t.mimeType,eTag:t.eTag,acl:t.acl.toJSON(),size:t.size,lastModified:t.lastModified&&t.lastModified.toISOString(),createdAt:t.createdAt&&t.createdAt.toISOString(),headers:t.headers}},y.prototype.checkAvailable=function(){if(!this.isMetadataLoaded)throw new n.PersistentError("The file metadata of "+this.id+" is not available.")},y);function y(t){D.classCallCheck(this,y);var e="string"==typeof t?{id:t}:t||{};if(e.id){if(-1===e.id.indexOf("/","/file/".length)||0!==e.id.indexOf("/file/"))throw new Error("Invalid file reference "+e.id);this[l]=e.id}else this[l]=this.createIdFromOptions(e);this.setDataOptions(e),this.isFolder="/"===this.id.charAt(this.id.length-1)}s(f.prototype,"_db","db"),s(f.prototype,"_conditional","conditional"),s(f.prototype,"_setMetadata","setDataOptions"),s(f.prototype,"_checkAvailable","checkAvailable"),e.exports=f},{1:1,20:20,25:25,33:33,34:34,73:73,77:77}],13:[function(t,e,r){"use strict";var n=t(11),i=t(12),h=t(20).trailingSlashIt,l=t(34),o=t(67),s=t(25).StatusCode,a=t(73),u=n.extend({create:function(t){var e=n.create.call(this,i);return e.db=t,e},newInstance:function(t){var e=n.newInstance.call(this,t);return e.db=this.db,e},fromJSON:function(t){var e=this.newInstance([t.id]);return e.fromJSON(t),e},saveMetadata:function(t,e,r,n){var i=new l.SetFileBucketMetadata(t,e);return this.db.send(i).then(r,n)},loadMetadata:function(t,e,r,n){var i=new l.GetFileBucketMetadata(t);return this.db.send(i).then(function(e){var r={};return o.BASE_PERMISSIONS.forEach(function(t){r[t]=o.fromJSON(e.entity[t]||{})}),r},function(t){if(t.status===s.OBJECT_NOT_FOUND)return null;throw t}).then(r,n)},listBuckets:function(t,e){var r=this;return this.db.send(new l.ListBuckets).then(function(t){return t.entity.map(function(t){return r.new(t+"/")})}).then(t,e)},listFiles:function(t,e,r,n,i){var o,s=this,a=void 0,u=(a=Object(t)instanceof String?(o=h(t),this.new({path:o})):t).key,c=a.bucket;return this.db.send(new l.ListFiles(c,u,e?e.key:null,r)).then(function(t){return t.entity.map(function(t){return s.new(t)})}).then(n,i)}});a(u,"_db","db"),e.exports=u},{11:11,12:12,20:20,25:25,34:34,67:67,73:73}],14:[function(t,e,r){"use strict";var n=t(8),i=t(65),o=(s.init=function(t,e){var r=n.getBaqendType(t.constructor);r&&Object.defineProperty(t,"_metadata",{value:i.create(r,t),configurable:!0}),e&&Object.assign(t,e)},s.extend=function(t){return t.prototype=Object.create(this.prototype,{constructor:{value:t,configurable:!0,writable:!0}}),t.extend=s.extend,t},s);function s(t){D.classCallCheck(this,s),s.init(this,t)}Object.defineProperties(o.prototype,{toJSON:{value:function(){return this._metadata.type.toJsonValue(this._metadata,this,{})}}}),e.exports=o},{65:65,8:8}],15:[function(t,e,r){"use strict";var n=t(11),i=t(73),o=n.extend({create:function(t,e){var r=n.create.call(this,t.typeConstructor);return r.methods=r.prototype,r.managedType=t,r.db=e,r},newInstance:function(t){var e=n.newInstance.call(this,t);return e._metadata.db=this.db,e},fromJSON:function(t){var e=this.newInstance(),r=e._metadata;return this.managedType.fromJsonValue(r,t,e,{})},addMethods:function(t){Object.assign(this.methods,t)},addMethod:function(t,e){this.methods[t]=e}});i(o,"_db","db"),i(o,"_managedType","managedType"),e.exports=o},{11:11,73:73}],16:[function(t,e,r){"use strict";var n,i=t(9),o=t(17),s=(n=i,D.inherits(a,n),a);function a(){return D.classCallCheck(this,a),D.possibleConstructorReturn(this,n.apply(this,arguments))}Object.defineProperties(s.prototype,{hasUser:{value:function(t){return this.users&&this.users.has(t)}},addUser:{value:function(t){if(!(t instanceof o))throw new Error("Only user instances can be added to a role.");this.users||(this.users=new Set),this.users.add(t)}},removeUser:{value:function(t){if(!(t instanceof o))throw new Error("Only user instances can be removed from a role.");this.users&&this.users.delete(t)}}}),e.exports=s},{17:17,9:9}],17:[function(t,e,r){"use strict";var n,i=t(9),o=(n=i,D.inherits(s,n),s);function s(){return D.classCallCheck(this,s),D.possibleConstructorReturn(this,n.apply(this,arguments))}Object.defineProperties(o.prototype,{newPassword:{value:function(t,e,r,n){return this._metadata.db.newPassword(this.username,t,e).then(r,n)}},changeUsername:{value:function(t,e,r,n){return this._metadata.db.changeUsername(this.username,t,e).then(r,n)}},requestAPIToken:{value:function(t,e){return this._metadata.db.requestAPIToken(this.constructor,this).then(t,e)}}}),e.exports=o},{9:9}],18:[function(t,e,r){"use strict";var a=t(10).extend({get me(){return this.db.me},register:function(t,e,r,n,i){if(r instanceof Function)return this.register(t,e,!0,r,n);var o="string"==typeof t?this.fromJSON({username:t}):t;return this.db.register(o,e,void 0===r||r).then(n,i)},login:function(t,e,r,n,i){return r instanceof Function?this.login(t,e,!0,r,n):this.db.login(t,e,void 0===r||r).then(n,i)},loginWithToken:function(t,e,r,n){return e instanceof Function?this.loginWithToken(t,!0,e,r):(this.db.token=t,this.db.renew(e).then(r,n))},logout:function(t,e){return this.db.logout().then(t,e)},newPassword:function(t,e,r,n,i){if("string"==typeof r)return this.db.newPassword(t,e,r).then(n,i);var o=arguments,s=o[0],a=o[1],u=o[2],c=o[3],h=o[4];return u instanceof Function&&(h=c,c=u,u=!0),this.db.newPasswordWithToken(s,a,u).then(c,h)},resetPassword:function(t,e,r){return this.db.resetPassword(t).then(e,r)},changeUsername:function(t,e,r,n,i){return this.db.changeUsername(t,e,r,n,i)},requestAPIToken:function(t,e,r){return this.db.requestAPIToken(this.managedType.typeConstructor,t).then(e,r)},revokeAllTokens:function(t,e,r){return this.db.revokeAllTokens(this.managedType.typeConstructor,t).then(e,r)}});a.LoginOption={NO_LOGIN:-1,SESSION_LOGIN:0,PERSIST_LOGIN:1},a.DefaultOptions={google:{width:585,height:545,scope:"email"},facebook:{width:1140,height:640,scope:"email"},github:{width:1040,height:580,scope:"user:email"},twitter:{width:740,height:730},linkedin:{width:630,height:530,scope:"r_liteprofile"},salesforce:{width:585,height:545,scope:"email"}},["Google","Facebook","GitHub","Twitter","LinkedIn","Salesforce"].forEach(function(o){var s="loginWith"+o;a[s]=function(t,e,r,n){if(e instanceof Function)return this[s](t,{},e,r);var i=Object.assign({},a.DefaultOptions[o.toLowerCase()],e||{});return this.db.loginWithOAuth(o,t,i).then(r,n)}}),e.exports=a},{10:10}],19:[function(t,e,r){"use strict";r.trailingSlashIt=t(20),r.Accessor=t(6),r.Enhancer=t(8),r.Factory=t(11),r.ManagedFactory=t(15),r.EntityFactory=t(10),r.UserFactory=t(18),r.DeviceFactory=t(7),r.FileFactory=t(13),r.Managed=t(14),r.Entity=t(9),r.Role=t(16),r.User=t(17),r.File=t(12)},{10:10,11:11,12:12,13:13,14:14,15:15,16:16,17:17,18:18,20:20,6:6,7:7,8:8,9:9}],20:[function(t,e,r){"use strict";r.trailingSlashIt=function(t){return"/"!==t.charAt(t.length-1)?t+"/":t}},{}],21:[function(t,e,r){"use strict";var n=t(72).atob,i=(a.prototype.contains=function(t){for(var e=a.getHashes(t,this.bits,this.hashes),r=0,n=e.length;r<n;r+=1)if(!this.isSet(e[r]))return!1;return!0},a.prototype.isSet=function(t){var e=Math.floor(t/8),r=1<<t%8;return 0!=(this.bytes.charCodeAt(e)&r)},a.getHashes=function(t,e,r){for(var n=new Array(this.hashes),i=a.murmur3(0,t),o=a.murmur3(i,t),s=0;s<r;s+=1)n[s]=(i+s*o)%e;return n},a.murmur3=function(t,e){for(var r=3&e.length,n=e.length-r,i=3432918353,o=461845907,s=void 0,a=void 0,u=void 0,c=void 0,s=t,c=0;c<n;)u=255&e.charCodeAt(c)|(255&e.charCodeAt(c+=1))<<8|(255&e.charCodeAt(c+=1))<<16|(255&e.charCodeAt(c+=1))<<24,c+=1,s=27492+(65535&(a=5*(65535&(s=(s^=u=(65535&(u=(u=(65535&u)*i+(((u>>>16)*i&65535)<<16)&4294967295)<<15|u>>>17))*o+(((u>>>16)*o&65535)<<16)&4294967295)<<13|s>>>19))+((5*(s>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(u=0,r){case 3:u^=(255&e.charCodeAt(c+2))<<16;case 2:u^=(255&e.charCodeAt(c+1))<<8;case 1:s^=u=(65535&(u=(u=(65535&(u^=255&e.charCodeAt(c)))*i+(((u>>>16)*i&65535)<<16)&4294967295)<<15|u>>>17))*o+(((u>>>16)*o&65535)<<16)&4294967295}return s^=e.length,s=2246822507*(65535&(s^=s>>>16))+((2246822507*(s>>>16)&65535)<<16)&4294967295,s=3266489909*(65535&(s^=s>>>13))+((3266489909*(s>>>16)&65535)<<16)&4294967295,(s^=s>>>16)>>>0},a);function a(t){D.classCallCheck(this,a),this.bytes=n(t.b),this.bits=t.m,this.hashes=t.h,this.creation=Date.now()}e.exports=i},{72:72}],22:[function(t,e,r){"use strict";r.BloomFilter=t(21)},{21:21}],23:[function(t,e,r){"use strict";var i=t(31),n=(d.create=function(t,e,r,n){var i=t,o=e,s=r,a=n;if("undefined"!=typeof location&&(i||(i=location.hostname,o=Number(location.port)),void 0===s&&(s="https:"===location.protocol)),s=!!s,void 0===a&&(a=d.DEFAULT_BASE_PATH),-1!==i.indexOf("/")){var u=/^(https?):\/\/([^/:]+|\[[^\]]+\])(:(\d*))?(\/\w+)?\/?$/.exec(i);if(!u)throw new Error("The connection uri host "+i+" seems not to be valid");s="https"===u[1],i=u[2].replace(/(\[|])/g,""),o=u[4],a=u[5]||""}else"localhost"!==i&&/^[a-z0-9-]*$/.test(i)&&(i+=d.HTTP_DOMAIN);o=o||(s?443:80);var c=d.toUri(i,o,s,a),h=this.connections[c];if(!h){for(var l=this.connectors.length-1;0<=l;--l){var p=this.connectors[l];if(p.isUsable&&p.isUsable(i,o,s,a)){h=new p(i,o,s,a);break}}if(!h)throw new Error("No connector is usable for the requested connection.");this.connections[c]=h}return h},d.toUri=function(t,e,r,n){var i=(r?"https://":"http://")+(-1!==t.indexOf(":")?"["+t+"]":t);return i+=r&&443!==e||!r&&80!==e?":"+e:"",i+=n},d.prototype.send=function(e){var r=this,n={status:0};return new Promise(function(t){r.prepareRequest(e),r.doSend(e,e.request,t)}).then(function(t){n=t}).then(function(){return r.prepareResponse(e,n)}).then(function(){return e.doReceive(n),n}).catch(function(t){throw n.entity=null,i.of(t)})},d.prototype.prepareRequest=function(t){var e;t.mimeType()||("json"===(e=t.request.type)?t.mimeType("application/json;charset=utf-8"):"text"===e&&t.mimeType("text/plain;charset=utf-8")),this.toFormat(t);var r,n,i=void 0;switch(t.responseType()){case"json":i="application/json";break;case"text":i="text/*";break;default:i="application/json,text/*;q=0.5,*/*;q=0.1"}t.accept()||t.accept(i),!this.gzip||(r=t.ifNoneMatch())&&'""'!==r&&"*"!==r&&t.ifNoneMatch(r.slice(0,-1)+'--gzip"'),"/connect"===t.request.path?(t.request.path=t.tokenStorage.signPath(this.basePath+t.request.path).substring(this.basePath.length),t.cacheControl()&&(t.request.path+=(t.tokenStorage.token?"&":"?")+"BCB")):!t.tokenStorage||(n=t.tokenStorage.token)&&t.header("authorization","BAT "+n)},d.prototype.toFormat=function(){},d.prototype.prepareResponse=function(e,r){var n=this;r.status=1223===r.status?204:r.status;var t,i,o=void 0,s=r.headers||{},a=204===r.status?null:r.entity;return a&&((o=e.responseType())&&!(400<=r.status)||(t=s["content-type"]||s["Content-Type"])&&-1<t.indexOf("application/json")&&(o="json")),s.etag&&(s.etag=s.etag.replace("--gzip","")),!e.tokenStorage||(i=s["baqend-authorization-token"]||s["Baqend-Authorization-Token"])&&e.tokenStorage.update(i),new Promise(function(t){t(a&&n.fromFormat(r,a,o))}).then(function(t){r.entity=t,-1!==e.request.path.indexOf("/connect")&&t&&(n.gzip=!!t.gzip)},function(t){throw new Error("Response was not valid "+o+": "+t.message)})},d.prototype.fromFormat=function(){},d);function d(t,e,r,n){D.classCallCheck(this,d),this.host=t,this.port=e,this.secure=r,this.basePath=n,this.origin=d.toUri(t,e,r,"")}Object.assign(n,{DEFAULT_BASE_PATH:"/v1",HTTP_DOMAIN:".app.baqend.com",RESPONSE_HEADERS:["baqend-authorization-token","content-type","baqend-size","baqend-acl","etag","last-modified","baqend-created-at","baqend-custom-headers"],connectors:[],connections:{},gzip:!1}),e.exports=n},{31:31}],24:[function(t,e,r){"use strict";var s,a=t(23),n=t(26),i=(s=n,D.inherits(o,s),o.isUsable=function(t,e,r){if("undefined"==typeof location||"undefined"==typeof document)return!1;var n="https:"===location.protocol;return location.hostname!==t||(location.port||(n?443:80))!==e||n!==r},o.prototype.load=function(t){this.iframe=document.createElement("iframe"),this.iframe.src=this.origin+this.basePath+t,this.iframe.setAttribute("style",o.style),document.body.appendChild(this.iframe),this.queue=[],this.iframe.addEventListener("load",this.onLoad.bind(this),!1)},o.prototype.onLoad=function(){for(var t=this.queue,e=0;e<t.length;e+=1)this.postMessage(t[e]);this.queue=null},o.prototype.doSend=function(t,e,r){var n,i,o=this;t.isBinary?s.prototype.doSend.call(this,t,e,r):(this.iframe||(this.load(t.request.path),t.request.path="/connect"),n={mid:this.mid+=1,method:e.method,path:e.path,headers:e.headers,entity:e.entity,responseHeaders:a.RESPONSE_HEADERS},this.messages[n.mid]=r,i=JSON.stringify(n),this.queue?this.queue.push(i):this.postMessage(i),this.connected||setTimeout(function(){o.messages[n.mid]&&(delete o.messages[n.mid],r({status:0,error:new Error("Connection refused.")}))},1e4))},o.prototype.postMessage=function(t){this.iframe.contentWindow.postMessage(t,this.origin)},o.prototype.doReceive=function(t){var e,r;t.origin===this.origin&&"{"===t.data[0]&&(e=JSON.parse(t.data),(r=this.messages[e.mid])&&(delete this.messages[e.mid],this.connected=!0,r({status:e.status,headers:e.headers,entity:e.entity})))},o);function o(t,e,r,n){D.classCallCheck(this,o);var i=D.possibleConstructorReturn(this,s.call(this,t,e,r,n));return i.mid=0,i.messages={},i.doReceive=i.doReceive.bind(i),addEventListener("message",i.doReceive,!1),i}i.style="width:1px;height:1px;position:absolute;top:-10px;left:-10px;",a.connectors.push(i),e.exports=i},{23:23,26:26}],25:[function(t,e,r){"use strict";var n=t(28),i="undefined"==typeof navigator||"undefined"!=typeof chrome&&/google/i.test(navigator.vendor)||/cros i686/i.test(navigator.platform),o=Symbol("ResponseType"),s=(u.create=function(t){var e,r=t.path.split("?"),n=r[0].split(/[:*]\w*/),i=[];return r[1]&&r[1].split("&").forEach(function(t){var e=t.split("=");i.push(e[0])}),t.dynamic=-1!==t.path.indexOf("*"),t.path=n,t.query=i,e=u,D.inherits(o,e),D.createClass(o,[{key:"spec",get:function(){return t}}]),o;function o(){return D.classCallCheck(this,o),D.possibleConstructorReturn(this,e.apply(this,arguments))}},u.createExternal=function(t,e){t.path=[t.path];var r,n=(r=u,D.inherits(i,r),D.createClass(i,[{key:"spec",get:function(){return t}}]),i);function i(){return D.classCallCheck(this,i),D.possibleConstructorReturn(this,r.apply(this,arguments))}return Object.assign(n.prototype,e),n},D.createClass(u,[{key:"isBinary",get:function(){return this.request.type in u.BINARY||this[o]in u.BINARY}}]),u.prototype.path=function(t){if(void 0===t)return this.request.path;var e=this.request.path.indexOf("?")+1;return this.request.path=t+(0<e?(-1<t.indexOf("?")?"&":"?")+this.request.path.substring(e):""),this},u.prototype.header=function(t,e){return void 0!==e?(this.request.headers[t]=e,this):this.request.headers[t]},u.prototype.entity=function(t,e){var r=(r=e)||("string"==typeof t?/^data:(.+?)(;base64)?,.*$/.test(t)?"data-url":"text":"undefined"!=typeof Blob&&t instanceof Blob?"blob":"undefined"!=typeof Buffer&&t instanceof Buffer?"buffer":"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?"arraybuffer":"undefined"!=typeof FormData&&t instanceof FormData?"form":"json");return this.request.type=r,this.request.entity=t,this},u.prototype.mimeType=function(t){return this.header("content-type",t)},u.prototype.contentLength=function(t){return this.header("content-length",t)},u.prototype.ifMatch=function(t){return this.header("If-Match",this.formatETag(t))},u.prototype.ifNoneMatch=function(t){return this.header("If-None-Match",this.formatETag(t))},u.prototype.ifUnmodifiedSince=function(t){return this.header("if-unmodified-since",t&&t.toUTCString().replace("UTC","GMT"))},u.prototype.noCache=function(){return i||this.ifMatch("").ifNoneMatch("-"),this.cacheControl("max-age=0, no-cache")},u.prototype.cacheControl=function(t){return this.header("cache-control",t)},u.prototype.acl=function(t){return this.header("baqend-acl",t&&JSON.stringify(t))},u.prototype.customHeaders=function(t){return this.header("baqend-custom-headers",t&&JSON.stringify(t))},u.prototype.accept=function(t){return this.header("accept",t)},u.prototype.responseType=function(t){return void 0!==t?(this[o]=t,this):this[o]},u.prototype.progress=function(t){return void 0!==t?(this.progressCallback=t,this):this.progressCallback},u.prototype.addQueryString=function(e){var r,n=this;return Object(e)instanceof String?this.request.path+=e:e&&(r=0<=this.request.path.indexOf("?")?"&":"?",Object.keys(e).forEach(function(t){n.request.path+=r+t+"="+encodeURIComponent(e[t]),r="&"})),this},u.prototype.formatETag=function(t){var e=t;return e&&"*"!==e&&-1===(e=""+e).indexOf('"')&&(e='"'+e+'"'),e},u.prototype.doReceive=function(t){if(-1===this.spec.status.indexOf(t.status))throw new n(this,t)},u);function u(){D.classCallCheck(this,u),this.withCredentials=!1,this.tokenStorage=null,this.progressCallback=null;var t=arguments,e=0,r=this.spec.path;if(Object(r)instanceof Array){r=this.spec.path[0];for(var n=this.spec.path.length,i=1;i<n;i+=1)this.spec.dynamic&&n-1===i?r+=t[e].split("/").map(encodeURIComponent).join("/"):r+=encodeURIComponent(t[e])+this.spec.path[i],e+=1}for(var o="",s=0;s<this.spec.query.length;s+=1){var a=t[e];e+=1,null!=a&&(o+=o||-1!==r.indexOf("?")?"&":"?",o+=this.spec.query[s]+"="+encodeURIComponent(a))}this.request={method:this.spec.method,path:r+o,entity:null,headers:{}},t[e]&&this.entity(t[e],"json"),this.responseType("json")}Object.assign(s,{StatusCode:{NOT_MODIFIED:304,BAD_CREDENTIALS:460,BUCKET_NOT_FOUND:461,INVALID_PERMISSION_MODIFICATION:462,INVALID_TYPE_VALUE:463,OBJECT_NOT_FOUND:404,OBJECT_OUT_OF_DATE:412,PERMISSION_DENIED:466,QUERY_DISPOSED:467,QUERY_NOT_SUPPORTED:468,SCHEMA_NOT_COMPATIBLE:469,SCHEMA_STILL_EXISTS:470,SYNTAX_ERROR:471,TRANSACTION_INACTIVE:472,TYPE_ALREADY_EXISTS:473,TYPE_STILL_REFERENCED:474,SCRIPT_ABORTION:475},BINARY:{blob:!0,buffer:!0,stream:!0,arraybuffer:!0,"data-url":!0,base64:!0},GoogleOAuth:s.createExternal({method:"OAUTH",path:"https://accounts.google.com/o/oauth2/auth?response_type=code&access_type=online",query:["client_id","scope","state"],status:[200]},{addRedirectOrigin:function(t){this.addQueryString({redirect_uri:t+"/db/User/OAuth/google"})}}),FacebookOAuth:s.createExternal({method:"OAUTH",path:"https://www.facebook.com/v7.0/dialog/oauth?response_type=code",query:["client_id","scope","state"],status:[200]},{addRedirectOrigin:function(t){this.addQueryString({redirect_uri:t+"/db/User/OAuth/facebook"})}}),GitHubOAuth:s.createExternal({method:"OAUTH",path:"https://github.com/login/oauth/authorize?response_type=code&access_type=online",query:["client_id","scope","state"],status:[200]},{addRedirectOrigin:function(t){this.addQueryString({redirect_uri:t+"/db/User/OAuth/github"})}}),LinkedInOAuth:s.createExternal({method:"OAUTH",path:"https://www.linkedin.com/oauth/v2/authorization?response_type=code",query:["client_id","scope","state"],status:[200]},{addRedirectOrigin:function(t){this.addQueryString({redirect_uri:t+"/db/User/OAuth/linkedin"})}}),TwitterOAuth:s.createExternal({method:"OAUTH",path:"",query:[],status:[200]},{addRedirectOrigin:function(t){this.request.path=t+"/db/User/OAuth1/twitter"}}),SalesforceOAuth:s.createExternal({method:"OAUTH",path:"",query:["client_id","scope","state"],status:[200]},{addRedirectOrigin:function(t){this.addQueryString({redirect_uri:t+"/db/User/OAuth/salesforce"})}})}),e.exports=s},{28:28}],26:[function(t,e,r){"use strict";var n,d=t(23),i=(n=d,D.inherits(o,n),o.isUsable=function(){return"undefined"!=typeof XMLHttpRequest},o.prototype.doSend=function(t,e,r){var n=this;if("OAUTH"===e.method){this.oAuthHandle&&this.oAuthHandle({status:409,entity:'{"message": "A new OAuth request was sent."}'}),localStorage.removeItem("oauth-response");var i=function(t){"oauth-response"===t.key&&n.oAuthHandle(JSON.parse(t.newValue))};return this.oAuthHandle=function(t){r(t),localStorage.removeItem("oauth-response"),removeEventListener("storage",i,!1)},void addEventListener("storage",i,!1)}var o=new XMLHttpRequest,s=this.origin+this.basePath+e.path;o.onreadystatechange=function(){var e;o.responseType&&2===o.readyState&&400<=o.status&&(o.responseType="text"),4===o.readyState&&(e={headers:{},status:o.status,entity:o.response||o.responseText},d.RESPONSE_HEADERS.forEach(function(t){e.headers[t]=o.getResponseHeader(t)}),r(e))},o.upload&&t.progress()&&(o.upload.onprogress=t.progress()),o.open(e.method,s,!0);for(var a=e.entity,u=e.headers,c=Object.keys(u),h=0,l=c.length;h<l;h+=1){var p=c[h];o.setRequestHeader(p,u[p])}switch(o.withCredentials=t.withCredentials,t.responseType()){case"arraybuffer":o.responseType="arraybuffer";break;case"blob":case"data-url":case"base64":o.responseType="blob"}o.send(a)},o.prototype.fromFormat=function(t,e,r){if("json"===r)return JSON.parse(e);if("data-url"!==r&&"base64"!==r)return e;var n=new FileReader;return n.readAsDataURL(e),new Promise(function(t,e){n.onload=t,n.onerror=e}).then(function(){var t=n.result;return"base64"===r&&(t=t.substring(t.indexOf(",")+1)),t})},o.prototype.toFormat=function(t){if(o=t.request.type){var e=t.request.entity,r=t.mimeType();switch(o){case"blob":r=r||e.type;break;case"arraybuffer":case"form":break;case"data-url":var n=e.match(/^data:(.+?)(;base64)?,(.*)$/),i=n[2],e=n[3],o="blob",r=r||n[1];if(!i){e=decodeURIComponent(e);break}case"base64":for(var s=atob(e),a=s.length,u=new Uint8Array(a),c=0;c<a;c+=1)u[c]=s.charCodeAt(c);o="blob",e=new Blob([u],{type:r});break;case"json":"string"!=typeof e&&(e=JSON.stringify(e));break;case"text":break;default:throw new Error("Supported request format:"+o)}t.entity(e,o).mimeType(r)}},o);function o(){return D.classCallCheck(this,o),D.possibleConstructorReturn(this,n.apply(this,arguments))}d.connectors.push(i),e.exports=i},{23:23}],27:[function(t,e,r){"use strict";r.Message=t(25),r.Connector=t(23),r.FetchConnector=t(78),r.XMLHttpConnector=t(26),r.IFrameConnector=t(24),r.NodeConnector=t(78)},{23:23,24:24,25:25,26:26,78:78}],28:[function(t,e,r){"use strict";var h,n=t(31),i=(h=n,D.inherits(l,h),l);function l(t,e){D.classCallCheck(this,l);var r=e.entity||e.error||{},n=0===e.status?"Request":"Response",i=r.message||"Handling the "+n+" for "+t.request.method+" "+t.request.path,o=D.possibleConstructorReturn(this,h.call(this,i,r));o.name=r.className||"CommunicationError",o.reason=r.reason||"Communication failed",o.status=e.status,r.data&&(o.data=r.data);for(var s=r;s&&s.stackTrace;){o.stack+="\nServerside Caused by: "+s.className+" "+s.message;for(var a=s.stackTrace,u=0;u<a.length;u+=1){var c=a[u];o.stack+="\n    at "+c.className+"."+c.methodName,o.stack+=" ("+c.fileName+":"+c.lineNumber+")"}s=s.cause}return o}e.exports=i},{31:31}],29:[function(t,e,r){"use strict";var n,i=t(31),o=(n=i,D.inherits(s,n),s);function s(t){D.classCallCheck(this,s);var e=D.possibleConstructorReturn(this,n.call(this,"The entity "+t+" is managed by a different db."));return e.entity=t,e}e.exports=o},{31:31}],30:[function(t,e,r){"use strict";var n,i=t(31),o=(n=i,D.inherits(s,n),s);function s(t){D.classCallCheck(this,s);var e=D.possibleConstructorReturn(this,n.call(this,"Entity "+t+" is not a valid entity"));return e.entity=t,e}e.exports=o},{31:31}],31:[function(t,e,r){"use strict";function n(t,e){Object.prototype.hasOwnProperty.call(Error,"captureStackTrace")?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t||"An unexpected persistent error occured.",this.name=this.constructor.name,e&&(this.cause=e).stack&&(this.stack+="\nCaused By: "+e.stack)}n.of=function(t){return t instanceof n?t:new n(null,t)},n.prototype=Object.create(Error.prototype,{constructor:{value:n,enumerable:!1,configurable:!0}}),e.exports=n},{}],32:[function(t,e,r){"use strict";var n,i=t(31),o=(n=i,D.inherits(s,n),s);function s(t){return D.classCallCheck(this,s),D.possibleConstructorReturn(this,n.call(this,"The transaction has been rollbacked",t))}e.exports=o},{31:31}],33:[function(t,e,r){"use strict";r.CommunicationError=t(28),r.IllegalEntityError=t(30),r.EntityExistsError=t(29),r.PersistentError=t(31),r.RollbackError=t(32)},{28:28,29:29,30:30,31:31,32:32}],34:[function(t,e,r){"use strict";var n=t(25);r.ListAllResources=n.create({method:"GET",path:"/",status:[200]}),r.ApiVersion=n.create({method:"GET",path:"/version",status:[200]}),r.Specification=n.create({method:"GET",path:"/spec",status:[200]}),r.GetBloomFilter=n.create({method:"GET",path:"/bloomfilter",status:[200]}),r.DeleteBloomFilter=n.create({method:"DELETE",path:"/bloomfilter",status:[204]}),r.GetOrestesConfig=n.create({method:"GET",path:"/config",status:[200]}),r.UpdateOrestesConfig=n.create({method:"PUT",path:"/config",status:[200,202]}),r.Connect=n.create({method:"GET",path:"/connect",status:[200]}),r.Status=n.create({method:"GET",path:"/status",status:[200]}),r.EventsUrl=n.create({method:"GET",path:"/events-url",status:[200]}),r.BannedIp=n.create({method:"GET",path:"/banned/:ip",status:[204]}),r.Banned=n.create({method:"GET",path:"/banned",status:[]}),r.Unban=n.create({method:"DELETE",path:"/banned",status:[204]}),r.UnbanIp=n.create({method:"DELETE",path:"/banned/:ip",status:[204]}),r.GetBucketNames=n.create({method:"GET",path:"/db",status:[200]}),r.GetBucketIds=n.create({method:"GET",path:"/db/:bucket/ids?start=0&count=-1",status:[200]}),r.ExportBucket=n.create({method:"GET",path:"/db/:bucket",status:[200]}),r.ImportBucket=n.create({method:"PUT",path:"/db/:bucket",status:[200]}),r.TruncateBucket=n.create({method:"DELETE",path:"/db/:bucket",status:[200]}),r.CreateObject=n.create({method:"POST",path:"/db/:bucket",status:[201,202]}),r.GetObject=n.create({method:"GET",path:"/db/:bucket/:oid",status:[200,304]}),r.ReplaceObject=n.create({method:"PUT",path:"/db/:bucket/:oid",status:[200,202]}),r.DeleteObject=n.create({method:"DELETE",path:"/db/:bucket/:oid",status:[202,204]}),r.GetAllSchemas=n.create({method:"GET",path:"/schema",status:[200]}),r.UpdateAllSchemas=n.create({method:"POST",path:"/schema",status:[200]}),r.ReplaceAllSchemas=n.create({method:"PUT",path:"/schema",status:[200]}),r.GetSchema=n.create({method:"GET",path:"/schema/:bucket",status:[200]}),r.UpdateSchema=n.create({method:"POST",path:"/schema/:bucket",status:[200]}),r.ReplaceSchema=n.create({method:"PUT",path:"/schema/:bucket",status:[200]}),r.DeleteSchema=n.create({method:"DELETE",path:"/schema/:bucket",status:[204]}),r.AdhocQuery=n.create({method:"GET",path:"/db/:bucket/query?q&start=0&count=-1&sort=&eager=&hinted=",status:[200]}),r.AdhocQueryPOST=n.create({method:"POST",path:"/db/:bucket/query?start=0&count=-1&sort=",status:[200]}),r.AdhocCountQuery=n.create({method:"GET",path:"/db/:bucket/count?q",status:[200]}),r.AdhocCountQueryPOST=n.create({method:"POST",path:"/db/:bucket/count",status:[200]}),r.ListQueryResources=n.create({method:"GET",path:"/query",status:[200]}),r.CreateQuery=n.create({method:"POST",path:"/query",status:[201]}),r.ListThisQueryResources=n.create({method:"GET",path:"/query/:qid",status:[200]}),r.GetQueryCode=n.create({method:"GET",path:"/query/:qid/source",status:[200]}),r.RunQuery=n.create({method:"GET",path:"/query/:qid/result?start=0&count=-1",status:[200]}),r.GetQueryParameters=n.create({method:"GET",path:"/query/:qid/parameters",status:[200]}),r.NewTransaction=n.create({method:"POST",path:"/transaction",status:[201]}),r.CommitTransaction=n.create({method:"PUT",path:"/transaction/:tid/committed",status:[200]}),r.UpdatePartially=n.create({method:"POST",path:"/db/:bucket/:oid",status:[200]}),r.UpdateField=n.create({method:"POST",path:"/db/:bucket/:oid/:field",status:[200]}),r.Login=n.create({method:"POST",path:"/db/User/login",status:[200]}),r.Register=n.create({method:"POST",path:"/db/User/register",status:[200,204]}),r.Me=n.create({method:"GET",path:"/db/User/me",status:[200]}),r.ValidateUser=n.create({method:"GET",path:"/db/User/validate",status:[200]}),r.Logout=n.create({method:"GET",path:"/db/User/logout",status:[204]}),r.NewPassword=n.create({method:"POST",path:"/db/User/password",status:[200]}),r.ResetPassword=n.create({method:"POST",path:"/db/User/reset",status:[200]}),r.Verify=n.create({method:"GET",path:"/db/User/verify?token=",status:[204]}),r.ChangeUsername=n.create({method:"POST",path:"/db/User/changeUsername",status:[204]}),r.VerifyUsername=n.create({method:"GET",path:"/db/User/verifyUsername?token=",status:[204]}),r.OAuth2=n.create({method:"GET",path:"/db/User/OAuth/:provider?state=&code=&oauth_verifier=&oauth_token=&error_description=",status:[200]}),r.OAuth1=n.create({method:"GET",path:"/db/User/OAuth1/:provider",status:[200]}),r.UserToken=n.create({method:"POST",path:"/db/User/:oid/token",status:[200]}),r.RevokeUserToken=n.create({method:"DELETE",path:"/db/User/:oid/token",status:[204]}),r.GetBaqendCode=n.create({method:"GET",path:"/code/:bucket/:type",status:[200]}),r.SetBaqendCode=n.create({method:"PUT",path:"/code/:bucket/:type",status:[200,202]}),r.DeleteBaqendCode=n.create({method:"DELETE",path:"/code/:bucket/:type",status:[202,204]}),r.PostBaqendModule=n.create({method:"POST",path:"/code/:bucket",status:[200,204]}),r.GetBaqendModule=n.create({method:"GET",path:"/code/:bucket",status:[200,204]}),r.GetAllModules=n.create({method:"GET",path:"/code",status:[200]}),r.ListFiles=n.create({method:"GET",path:"/file/:bucket/ids?path=/&start=&count=-1&deep=false",status:[200]}),r.ListBuckets=n.create({method:"GET",path:"/file/buckets",status:[200]}),r.DownloadArchive=n.create({method:"GET",path:"/file",status:[200]}),r.UploadPatchArchive=n.create({method:"POST",path:"/file",status:[200]}),r.GetFileBucketMetadata=n.create({method:"GET",path:"/file/:bucket",status:[200]}),r.SetFileBucketMetadata=n.create({method:"PUT",path:"/file/:bucket",status:[204]}),r.DeleteFileBucket=n.create({method:"DELETE",path:"/file/:bucket",status:[204]}),r.CreateFile=n.create({method:"POST",path:"/file/:bucket",status:[200]}),r.DownloadFile=n.create({method:"GET",path:"/file/:bucket/*oid",status:[200,304]}),r.UploadFile=n.create({method:"PUT",path:"/file/:bucket/*oid",status:[200]}),r.GetFileMetadata=n.create({method:"HEAD",path:"/file/:bucket/*oid",status:[200]}),r.UpdateFileMetadata=n.create({method:"POST",path:"/file/:bucket/*oid",status:[200]}),r.DeleteFile=n.create({method:"DELETE",path:"/file/:bucket/*oid",status:[200,204]}),r.CreateManifest=n.create({method:"POST",path:"/pwa/manifest",status:[202]}),r.DownloadAsset=n.create({method:"GET",path:"/asset/*url",status:[200,304]}),r.RevalidateAssets=n.create({method:"POST",path:"/asset/revalidate",status:[202]}),r.GetRevalidationStatus=n.create({method:"GET",path:"/asset/revalidate/:id",status:[200,202]}),r.ListIndexes=n.create({method:"GET",path:"/index/:bucket",status:[200]}),r.CreateDropIndex=n.create({method:"POST",path:"/index/:bucket",status:[202]}),r.DropAllIndexes=n.create({method:"DELETE",path:"/index/:bucket",status:[202]}),r.DeviceRegister=n.create({method:"POST",path:"/db/Device/register",status:[200]}),r.DevicePush=n.create({method:"POST",path:"/db/Device/push",status:[204]}),r.DeviceRegistered=n.create({method:"GET",path:"/db/Device/registered",status:[200]}),r.VAPIDKeys=n.create({method:"POST",path:"/config/VAPIDKeys",status:[200]}),r.VAPIDPublicKey=n.create({method:"GET",path:"/config/VAPIDPublicKey",status:[200]}),r.GCMAKey=n.create({method:"POST",path:"/config/GCMKey",status:[204]}),r.UploadAPNSCertificate=n.create({method:"POST",path:"/config/APNSCert",status:[204]})},{25:25}],35:[function(t,e,r){"use strict";var n=t(6),i=(D.createClass(o,[{key:"persistentAttributeType",get:function(){return-1}},{key:"isAssociation",get:function(){return this.persistentAttributeType>o.PersistentAttributeType.EMBEDDED}},{key:"isCollection",get:function(){return this.persistentAttributeType===o.PersistentAttributeType.ELEMENT_COLLECTION}}]),o.prototype.init=function(t,e){if(this.declaringType)throw new Error("The attribute is already initialized.");this.order=e,this.accessor=new n,this.declaringType=t},o.prototype.getValue=function(t){return this.accessor.getValue(t,this)},o.prototype.setValue=function(t,e){this.accessor.setValue(t,this,e)},o.prototype.hasMetadata=function(t){return this.metadata&&!!this.metadata[t]},o.prototype.getMetadata=function(t){return this.hasMetadata(t)?this.metadata[t]:null},o.prototype.getJsonValue=function(){},o.prototype.setJsonValue=function(){},o.prototype.toJSON=function(){return{name:this.name,metadata:this.metadata||void 0,order:this.order}},o);function o(t,e){D.classCallCheck(this,o),this.isMetadata=!!e,this.isId=!1,this.isVersion=!1,this.isAcl=!1,this.name=t,this.order=null,this.accessor=null,this.declaringType=null,this.metadata=null}i.PersistentAttributeType={BASIC:0,ELEMENT_COLLECTION:1,EMBEDDED:2,MANY_TO_MANY:3,MANY_TO_ONE:4,ONE_TO_MANY:5,ONE_TO_ONE:6},e.exports=i},{6:6}],36:[function(t,e,r){"use strict";var o,n,i,s,a,u,c,h,l,p,d,f,y=t(49),g=t(4),m=t(12),b=(o=y,D.inherits(v,o),D.createClass(v,[{key:"persistenceType",get:function(){return y.PersistenceType.BASIC}}]),v.prototype.toJsonValue=function(t,e){return null==e?null:this.typeConstructor(e)},v.prototype.fromJsonValue=function(t,e){return null==e?null:e},v.prototype.toString=function(){return"BasicType("+this.ref+")"},v);function v(t,e,r){D.classCallCheck(this,v);var n=0===t.indexOf("/db/")?t:"/db/"+t,i=D.possibleConstructorReturn(this,o.call(this,n,e));return i.noResolving=r,i}function w(t){return t instanceof Date?t.toISOString().replace(/\.?0*Z/,"Z"):null}function O(t,e){var r="string"==typeof t?new Date(t):null;return e&&r&&e.toISOString()===r.toISOString()?e:r}function T(){return D.classCallCheck(this,T),D.possibleConstructorReturn(this,n.apply(this,arguments))}function E(){return D.classCallCheck(this,E),D.possibleConstructorReturn(this,i.apply(this,arguments))}function S(){return D.classCallCheck(this,S),D.possibleConstructorReturn(this,s.apply(this,arguments))}function C(){return D.classCallCheck(this,C),D.possibleConstructorReturn(this,a.apply(this,arguments))}function A(){return D.classCallCheck(this,A),D.possibleConstructorReturn(this,u.apply(this,arguments))}function k(){return D.classCallCheck(this,k),D.possibleConstructorReturn(this,c.apply(this,arguments))}function _(){return D.classCallCheck(this,_),D.possibleConstructorReturn(this,h.apply(this,arguments))}function x(){return D.classCallCheck(this,x),D.possibleConstructorReturn(this,l.apply(this,arguments))}function F(){return D.classCallCheck(this,F),D.possibleConstructorReturn(this,p.apply(this,arguments))}function R(){return D.classCallCheck(this,R),D.possibleConstructorReturn(this,d.apply(this,arguments))}function P(){return D.classCallCheck(this,P),D.possibleConstructorReturn(this,f.apply(this,arguments))}Object.assign(b,{Boolean:(f=b,D.inherits(P,f),P.prototype.fromJsonValue=function(t,e,r){return"string"==typeof e?"false"!==e:f.prototype.fromJsonValue.call(this,t,e,r)},new P("Boolean",Boolean)),Double:(d=b,D.inherits(R,d),R.prototype.fromJsonValue=function(t,e,r){return"string"==typeof e?parseFloat(e):d.prototype.fromJsonValue.call(this,t,e,r)},new R("Double",Number)),Integer:(p=b,D.inherits(F,p),F.prototype.fromJsonValue=function(t,e,r){return"string"==typeof e?parseInt(e,10):p.prototype.fromJsonValue.call(this,t,e,r)},new F("Integer",Number)),String:(l=b,D.inherits(x,l),new x("String",String)),DateTime:(h=b,D.inherits(_,h),_.prototype.toJsonValue=function(t,e){return w(e)},_.prototype.fromJsonValue=function(t,e,r){return O(e,r)},new _("DateTime",Date)),Date:(c=b,D.inherits(k,c),k.prototype.toJsonValue=function(t,e){var r=w(e);return r?r.substring(0,r.indexOf("T")):null},k.prototype.fromJsonValue=function(t,e,r){return O(e,r)},new k("Date",Date)),Time:(u=b,D.inherits(A,u),A.prototype.toJsonValue=function(t,e){var r=w(e);return r?r.substring(r.indexOf("T")+1):null},A.prototype.fromJsonValue=function(t,e,r){return"string"==typeof e?O("1970-01-01T"+e,r):e},new A("Time",Date)),File:(a=b,D.inherits(C,a),C.prototype.toJsonValue=function(t,e){return e instanceof m?e.id:null},C.prototype.fromJsonValue=function(t,e,r){return e?r&&r.id===e?r:new t.db.File(e):null},new C("File",m)),GeoPoint:(s=b,D.inherits(S,s),S.prototype.toJsonValue=function(t,e){return e instanceof g?e:null},S.prototype.fromJsonValue=function(t,e){return e?new g(e):null},new S("GeoPoint",g)),JsonArray:(i=b,D.inherits(E,i),E.prototype.toJsonValue=function(t,e){return Array.isArray(e)?e:null},E.prototype.fromJsonValue=function(t,e){return Array.isArray(e)?e:null},new E("JsonArray",Array)),JsonObject:(n=b,D.inherits(T,n),T.prototype.toJsonValue=function(t,e){return e&&e.constructor===Object?e:null},new T("JsonObject",Object))}),e.exports=b},{12:12,4:4,49:49}],37:[function(t,e,r){"use strict";var n,i=t(46),o=(n=i,D.inherits(s,n),D.createClass(s,[{key:"collectionType",get:function(){return i.CollectionType.COLLECTION}}]),s);function s(t,e){D.classCallCheck(this,s);var r=D.possibleConstructorReturn(this,n.call(this,t,e));return r.typeConstructor=null,r}e.exports=o},{46:46}],38:[function(t,e,r){"use strict";var n=(i.prototype.hasKey=function(t){for(var e=0;e<this.keys.length;e+=1)if(this.keys[e][t])return!0;return!1},i.prototype.toJSON=function(){return{unique:this.unique,keys:this.keys,drop:this.drop}},D.createClass(i,[{key:"isCompound",get:function(){return 1<this.keys.length}},{key:"isUnique",get:function(){return this.unique}}]),i);function i(t,e){if(D.classCallCheck(this,i),Object(t)instanceof String){var r={};r[t]=i.ASC,this.keys=[r]}else if(Object(t)instanceof Array)this.keys=t;else{if(!t)throw new Error("The keys parameter must be an String, Object or Array.");this.keys=[t]}this.drop=!1,this.unique=!0===e}Object.assign(n,{ASC:"asc",DESC:"desc",GEO:"geo",fromJSON:function(t){return new n(t.keys,t.unique)}}),e.exports=n},{}],39:[function(t,e,r){"use strict";var o,n=t(42),i=t(49),s=t(19),a=(o=n,D.inherits(u,o),u.prototype.createProxyClass=function(){return this.enhancer.createProxy(s.Managed)},u.prototype.createObjectFactory=function(t){return s.ManagedFactory.create(this,t)},u.prototype.toJsonValue=function(t,e,r){return t.root&&e instanceof this.typeConstructor&&!e._metadata.root&&(e._metadata.root=t.root),o.prototype.toJsonValue.call(this,t,e,r)},u.prototype.fromJsonValue=function(t,e,r,n){var i=r;return e&&(i instanceof this.typeConstructor||(i=this.create()),t.root&&!i._metadata.root&&(i._metadata.root=t.root)),o.prototype.fromJsonValue.call(this,t,e,i,n)},u.prototype.toString=function(){return"EmbeddableType("+this.ref+")"},D.createClass(u,[{key:"persistenceType",get:function(){return i.PersistenceType.EMBEDDABLE}}]),u);function u(){return D.classCallCheck(this,u),D.possibleConstructorReturn(this,o.apply(this,arguments))}e.exports=a},{19:19,42:42,49:49}],40:[function(t,e,r){"use strict";var u,n=t(19),a=t(48),c=t(36),i=t(49),o=t(42),s=t(67),h=t(65),l=(u=o,D.inherits(p,u),D.createClass(p,[{key:"persistenceType",get:function(){return i.PersistenceType.ENTITY}},{key:"id",get:function(){return this.declaredId||this.superType.id}},{key:"version",get:function(){return this.declaredVersion||this.superType.version}},{key:"acl",get:function(){return this.declaredAcl||this.superType.acl}}]),p.prototype.createProxyClass=function(){var t=this.superType.typeConstructor;if(t===Object)switch(this.name){case"User":t=n.User;break;case"Role":t=n.Role;break;default:t=n.Entity}return this.enhancer.createProxy(t)},p.prototype.getReferencing=function(t,e){for(var r=Object.assign({},e),n=t.metamodel.entities,i=new Map,o=Object.keys(n),s=0,a=o.length;s<a;s+=1){var u=o[s];if(!r.classes||-1!==r.classes.indexOf(u))for(var c=n[u].attributes(),h=c.next();!h.done;h=c.next()){var l,p=h.value;p.type!==this&&p.elementType!==this||((l=i.get(p.declaringType)||new Set).add(p.name),i.set(p.declaringType,l))}}return i},p.prototype.createObjectFactory=function(t){switch(this.name){case"User":return n.UserFactory.create(this,t);case"Device":return n.DeviceFactory.create(this,t);case"Object":return;default:return n.EntityFactory.create(this,t)}},p.prototype.fromJsonValue=function(t,e,r,n){if("string"==typeof e)return t.db.getReference(e);if(!e||"object"!==(void 0===e?"undefined":D.typeof(e)))return null;var i,o=Object.assign({persisting:!1,onlyMetadata:!1},n),s=void 0,a=void 0;return r&&(i=h.get(r),e.id&&i.id&&e.id!==i.id||(s=r,a=i)),s||(s=t.db.getReference(this.typeConstructor,e.id),a=h.get(s)),a.enable(!1),u.prototype.fromJsonValue.call(this,a,e,s,o),a.enable(!0),o.persisting?a.setPersistent():o.onlyMetadata||a.setDirty(),s},p.prototype.toJsonValue=function(t,e,r){var n=Object.assign({excludeMetadata:!1,depth:0,persisting:!1},r),i=!0===n.depth||-1<n.depth,o=e&&h.get(e);if(i&&o&&o.isAvailable){o.enable(!1);var s=u.prototype.toJsonValue.call(this,o,e,Object.assign({},n,{depth:!0===n.depth||n.depth-1}));return o.enable(!0),s}return e instanceof this.typeConstructor?(e.attach(t.db),e.id):null},p.prototype.toString=function(){return"EntityType("+this.ref+")"},p.prototype.toJSON=function(){var t=u.prototype.toJSON.call(this);return t.acl.schemaSubclass=this.schemaSubclassPermission,t.acl.insert=this.insertPermission,t.acl.update=this.updatePermission,t.acl.delete=this.deletePermission,t.acl.query=this.queryPermission,t},p);function p(t,e,r){D.classCallCheck(this,p);var n=D.possibleConstructorReturn(this,u.call(this,t,r));return n.declaredId=null,n.declaredVersion=null,n.declaredAcl=null,n.superType=e,n.loadPermission=new s,n.updatePermission=new s,n.deletePermission=new s,n.queryPermission=new s,n.schemaSubclassPermission=new s,n.insertPermission=new s,n}var d,f=(d=l,D.inherits(y,d),D.createClass(y,null,[{key:"ref",get:function(){return"/db/Object"}}]),y);function y(){D.classCallCheck(this,y);var t,e,r,n=D.possibleConstructorReturn(this,d.call(this,l.Object.ref,null,Object));function i(){return D.classCallCheck(this,i),D.possibleConstructorReturn(this,t.call(this,"id",c.String,!0))}function o(){return D.classCallCheck(this,o),D.possibleConstructorReturn(this,e.call(this,"version",c.Integer,!0))}function s(){return D.classCallCheck(this,s),D.possibleConstructorReturn(this,r.call(this,"acl",c.JsonObject,!0))}return n.declaredId=(t=a,D.inherits(i,t),i.prototype.getJsonValue=function(t){return t.id||void 0},i.prototype.setJsonValue=function(t,e,r){this.id||(t.id=r)},new i),n.declaredId.init(n,0),n.declaredId.isId=!0,n.declaredVersion=(e=a,D.inherits(o,e),o.prototype.getJsonValue=function(t){return t.version||void 0},o.prototype.setJsonValue=function(t,e,r){r&&(t.version=r)},new o),n.declaredVersion.init(n,1),n.declaredVersion.isVersion=!0,n.declaredAcl=(r=a,D.inherits(s,r),s.prototype.getJsonValue=function(t){return t.acl.toJSON()},s.prototype.setJsonValue=function(t,e,r){t.acl.fromJSON(r||{})},new s),n.declaredAcl.init(n,2),n.declaredAcl.isAcl=!0,n.declaredAttributes=[n.declaredId,n.declaredVersion,n.declaredAcl],n}l.Object=f,e.exports=l},{19:19,36:36,42:42,48:48,49:49,65:65,67:67}],41:[function(t,e,r){"use strict";var n,p=t(46),i=(n=p,D.inherits(o,n),D.createClass(o,[{key:"collectionType",get:function(){return p.CollectionType.LIST}}],[{key:"ref",get:function(){return"/db/collection.List"}}]),o.prototype.getJsonValue=function(t,e,r){var n=this.getValue(e);if(!(n instanceof this.typeConstructor))return null;for(var i=n.length,o=new Array(i),s=p.getAttachedState(n),a=s||[],u=!s||s.length!==i,c=new Array(i),h=0;h<i;h+=1){var l=n[h];c[h]=this.elementType.toJsonValue(t,l,r),o[h]=l,u=u||a[h]!==l}return r.persisting&&p.attachState(n,o),t.isPersistent&&u&&t.setDirty(),c},o.prototype.setJsonValue=function(t,e,r,n){var i=null;if(r){i=this.getValue(e);var o=r.length;i instanceof this.typeConstructor||(i=new this.typeConstructor(o));var s=new Array(o),a=p.getAttachedState(i)||[];o<i.length&&i.splice(o,i.length-o);for(var u=0;u<o;u+=1){var c=this.elementType.fromJsonValue(t,r[u],a[u],n);i[u]=c,s[u]=c}n.persisting&&p.attachState(i,s)}this.setValue(e,i)},o.prototype.toJSON=function(){return Object.assign({},n.prototype.toJSON.call(this),{type:o.ref+"["+this.elementType.ref+"]"})},o);function o(t,e){D.classCallCheck(this,o);var r=D.possibleConstructorReturn(this,n.call(this,t,e));return r.typeConstructor=Array,r}e.exports=i},{46:46}],42:[function(t,e,r){"use strict";var n,i=t(49),o=t(67),s=t(71),a=t(19),u=t(73),c=Symbol("ValidationCode"),h=i.TYPE_CONSTRUCTOR,l=(n=i,D.inherits(p,n),D.createClass(p,[{key:"validationCode",get:function(){return this[c]},set:function(t){this[c]=t?s.compile(this,t):null}},{key:"typeConstructor",get:function(){return this[h]||(this.typeConstructor=this.createProxyClass()),this[h]},set:function(t){if(this[h])throw new Error("Type constructor has already been set.");var e=t.prototype instanceof a.Entity;if(this.isEntity){if(!e)throw new TypeError("Entity classes must extends the Entity class.")}else if(!(t.prototype instanceof a.Managed)||e)throw new TypeError("Embeddable classes must extends the Managed class.");this.enhancer.enhance(this,t),this[h]=t}}]),p.prototype.init=function(t){this.enhancer=t,this[h]&&!a.Enhancer.getIdentifier(this[h])&&a.Enhancer.setIdentifier(this[h],this.ref)},p.prototype.createProxyClass=function(){},p.prototype.createObjectFactory=function(){},p.prototype.create=function(){var t=Object.create(this.typeConstructor.prototype);return a.Managed.init(t),t},p.prototype.attributes=function(){var t,r=void 0,n=0,i=this;return this.superType&&(r=this.superType.attributes()),(t={})[Symbol.iterator]=function(){return this},t.next=function(){if(r){var t=r.next();if(!t.done)return t;r=null}if(n<i.declaredAttributes.length){var e=i.declaredAttributes[n];return n+=1,{value:e,done:!1}}return{done:!0}},t},p.prototype.addAttribute=function(t,e){if(this.getAttribute(t.name))throw new Error("An attribute with the name "+t.name+" is already declared.");var r=void 0,r=t.order?t.order:void 0===e?this.declaredAttributes.length:e;t.init(this,r),this.declaredAttributes.push(t),this[h]&&"Object"!==this.name&&this.enhancer.enhanceProperty(this[h],t)},p.prototype.removeAttribute=function(e){var t=this.declaredAttributes.length;if(this.declaredAttributes=this.declaredAttributes.filter(function(t){return t.name!==e}),t===this.declaredAttributes.length)throw new Error("An Attribute with the name "+e+" is not declared.")},p.prototype.getAttribute=function(t){var e=this.getDeclaredAttribute(t);return!e&&this.superType&&(e=this.superType.getAttribute(t)),e},p.prototype.getDeclaredAttribute=function(e){return this.declaredAttributes.filter(function(t){return t.name===e||t.order===e})[0]||null},p.prototype.fromJsonValue=function(t,e,r,n){if(!e)return null;for(var i=this.attributes(),o=i.next();!o.done;o=i.next()){var s=o.value;n.onlyMetadata&&!s.isMetadata||s.setJsonValue(t,r,e[s.name],n)}return r},p.prototype.toJsonValue=function(t,e,r){if(!(e instanceof this.typeConstructor))return null;for(var n={},i=this.attributes(),o=i.next();!o.done;o=i.next()){var s=o.value;r.excludeMetadata&&s.isMetadata||(n[s.name]=s.getJsonValue(t,e,r))}return n},p.prototype.toJSON=function(){var e={};this.declaredAttributes.forEach(function(t){t.isMetadata||(e[t.name]=t)});var t={class:this.ref,fields:e,acl:{load:this.loadPermission,schemaAdd:this.schemaAddPermission,schemaReplace:this.schemaReplacePermission}};return this.superType&&(t.superClass=this.superType.ref),this.isEmbeddable&&(t.embedded=!0),this.metadata&&(t.metadata=this.metadata),t},p.prototype.references=function(){var n=this.attributes(),i=void 0,o=void 0,t={};return t[Symbol.iterator]=function(){return this},t.next=function(){for(;;){if(o){var t=o.next();if(!t.done)return{value:{path:[i.name].concat(t.value.path)}};o=null}var e=n.next();if(e.done)return e;var r=(i=e.value).isCollection?i.elementType:i.type;if(r.isEntity)return{value:{path:[i.name]}};r.isEmbeddable&&(o=r.references())}},t},p.prototype.hasMetadata=function(t){return this.metadata&&!!this.metadata[t]},p.prototype.getMetadata=function(t){return this.hasMetadata(t)?this.metadata[t]:null},p);function p(t,e){D.classCallCheck(this,p);var r=D.possibleConstructorReturn(this,n.call(this,0!==t.indexOf("/db/")?"/db/"+t:t,e));return r.enhancer=null,r.declaredAttributes=[],r.schemaAddPermission=new o,r.schemaReplacePermission=new o,r.metadata=null,r}u(l.prototype,"_enhancer","enhancer"),e.exports=l},{19:19,49:49,67:67,71:71,73:73}],43:[function(t,e,r){"use strict";var o,f=t(46),p=t(31),n=(o=f,D.inherits(s,o),D.createClass(s,[{key:"collectionType",get:function(){return f.CollectionType.MAP}}],[{key:"ref",get:function(){return"/db/collection.Map"}}]),s.prototype.getJsonValue=function(t,e,r){var n=this.getValue(e);if(!(n instanceof this.typeConstructor))return null;for(var i={},o=f.getAttachedState(n)||{},s=f.getAttachedSize(n)!==n.size,a={},u=n.entries(),c=u.next();!c.done;c=u.next()){var h=c.value;if(null===h[0]||void 0===h[0])throw new p("Map keys can't be null nor undefined.");var l=this.keyType.toJsonValue(t,h[0],r);a[l]=this.elementType.toJsonValue(t,h[1],r),i[l]=[h[0],h[1]],s=s||(o[l]||[])[1]!==h[1]}return r.persisting&&(f.attachState(n,i),f.attachSize(n,n.size)),t.isPersistent&&s&&t.setDirty(),a},s.prototype.setJsonValue=function(t,e,r,n){var i=null;if(r){(i=this.getValue(e))instanceof this.typeConstructor||(i=new this.typeConstructor);var o={},s=f.getAttachedState(i)||{};i.clear();for(var a=Object.keys(r),u=0,c=a.length;u<c;u+=1){var h=a[u],l=s[h]||[],p=this.keyType.fromJsonValue(t,h,l[0],n),d=this.elementType.fromJsonValue(t,r[h],l[1],n);o[h]=[p,d],i.set(p,d)}n.persisting&&(f.attachState(i,o),f.attachSize(i,i.size))}this.setValue(e,i)},s.prototype.toJSON=function(){return Object.assign({},o.prototype.toJSON.call(this),{type:s.ref+"["+this.keyType.ref+","+this.elementType.ref+"]"})},s);function s(t,e,r,n){D.classCallCheck(this,s);var i=D.possibleConstructorReturn(this,o.call(this,t,r,n));return i.keyType=e,i.typeConstructor=Map,i}e.exports=n},{31:31,46:46}],44:[function(t,e,r){"use strict";var n,i=t(42),o=t(40),s=t(8),a=t(45),u=t(38),c=t(63),h=t(73),l=t(25).StatusCode,p=t(34),d=(n=c,D.inherits(f,n),f.prototype.init=function(t){if(this.isInitialized)throw new Error("Metamodel is already initialized.");this.fromJSON(t||[]),this.isInitialized=!0},f.prototype.getRef=function(t){var e=void 0;return Object(t)instanceof String?0!==(e=t).indexOf("/db/")&&(e="/db/"+t):e=s.getIdentifier(t),e},f.prototype.entity=function(t){var e=this.getRef(t);return e?this.entities[e]:null},f.prototype.baseType=function(t){var e=null;if(Object(t)instanceof String)e=this.getRef(t);else for(var r=Object.keys(this.baseTypes),n=0,i=r.length;n<i;n+=1){var o=r[n],s=this.baseTypes[o];if(!s.noResolving&&s.typeConstructor===t){e=o;break}}return e?this.baseTypes[e]:null},f.prototype.embeddable=function(t){var e=this.getRef(t);return e?this.embeddables[e]:null},f.prototype.managedType=function(t){return this.baseType(t)||this.entity(t)||this.embeddable(t)},f.prototype.addType=function(t){var e=void 0;if(t.isBasic?e=this.baseTypes:t.isEmbeddable?(t.init(this.enhancer),e=this.embeddables):t.isEntity&&(t.init(this.enhancer),e=this.entities,null===t.superType&&t.ref!==o.Object.ref&&(t.superType=this.entity(o.Object.ref))),e[t.ref])throw new Error("The type "+t.ref+" is already declared.");return e[t.ref]=t},f.prototype.load=function(){var e=this;if(!this.isInitialized)return this.withLock(function(){var t=new p.GetAllSchemas;return e.entityManagerFactory.send(t).then(function(t){return e.init(t.entity),e})});throw new Error("Metamodel is already initialized.")},f.prototype.save=function(t){var e=this;return this.sendUpdate(t||this.toJSON()).then(function(){return e})},f.prototype.update=function(t){var e=this;return this.sendUpdate(t).then(function(t){return e.fromJSON(t.entity),e})},f.prototype.sendUpdate=function(e){var r=this;return this.withLock(function(){var t=void 0,t=e instanceof i?new p.UpdateSchema(e.name,e.toJSON()):new p.UpdateAllSchemas(e);return r.entityManagerFactory.send(t)})},f.prototype.toJSON=function(){var e=this;if(!this.isInitialized)throw new Error("Metamodel is not initialized.");return[].concat(Object.keys(this.entities).map(function(t){return e.entities[t].toJSON()}),Object.keys(this.embeddables).map(function(t){return e.embeddables[t].toJSON()}))},f.prototype.fromJSON=function(t){var e=this,r=(new a).buildModels(t);this.baseTypes={},this.embeddables={},this.entities={},Object.keys(r).forEach(function(t){return e.addType(r[t])})},f.prototype.createIndex=function(t,e){e.drop=!1;var r=new p.CreateDropIndex(t,e.toJSON());return this.entityManagerFactory.send(r)},f.prototype.dropIndex=function(t,e){e.drop=!0;var r=new p.CreateDropIndex(t,e.toJSON());return this.entityManagerFactory.send(r)},f.prototype.dropAllIndexes=function(t){var e=new p.DropAllIndexes(t);return this.entityManagerFactory.send(e)},f.prototype.getIndexes=function(t){var e=new p.ListIndexes(t);return this.entityManagerFactory.send(e).then(function(t){return t.entity.map(function(t){return new u(t.keys,t.unique)})}).catch(function(t){if(t.status===l.BUCKET_NOT_FOUND||t.status===l.OBJECT_NOT_FOUND)return null;throw t})},f);function f(t){D.classCallCheck(this,f);var e=D.possibleConstructorReturn(this,n.call(this));return e.isInitialized=!1,e.entityManagerFactory=t,e.entities=null,e.embeddables=null,e.baseTypes=null,e.enhancer=new s,e}h(d.prototype,"_enhancer","enhancer"),h(d.prototype,"_send","sendUpdate"),h(d.prototype,"_getRef","getRef"),e.exports=d},{25:25,34:34,38:38,40:40,42:42,45:45,63:63,73:73,8:8}],45:[function(t,e,r){"use strict";var n=t(36),o=t(40),s=t(39),c=t(41),h=t(43),l=t(47),p=t(48),i=t(31),a=(u.prototype.getModel=function(t){if(t in this.models)return this.models[t];var e=this.buildModel(t);return this.models[t]=e},u.prototype.buildModels=function(t){var r=this;return this.modelDescriptors={},t.forEach(function(t){r.modelDescriptors[t.class]=t}),Object.keys(this.modelDescriptors).forEach(function(e){try{var t=r.getModel(e);r.buildAttributes(t)}catch(t){throw new i("Can't create model for entity class "+e,t)}}),this.getModel(o.Object.ref),this.models},u.prototype.buildModel=function(t){var e,r,n=this.modelDescriptors[t],i=void 0;if(t===o.Object.ref)i=new o.Object;else{if(!n)throw new TypeError("No model available for "+t);i=n.embedded?new s(t):(e=n.superClass||o.Object.ref,new o(t,this.getModel(e)))}return i.metadata={},n&&(i.metadata=n.metadata||{},r=n.acl||{},Object.keys(r).forEach(function(t){i[t+"Permission"].fromJSON(r[t])})),i},u.prototype.buildAttributes=function(r){var n=this,t=this.modelDescriptors[r.ref],i=t.fields;Object.keys(i).forEach(function(t){var e=i[t];r.getAttribute(t)||r.addAttribute(n.buildAttribute(e),e.order)}),t.validationCode&&(r.validationCode=t.validationCode)},u.prototype.buildAttribute=function(t){var e=t.flags&&(-1!==t.flags.indexOf("METADATA")||-1!==t.flags.indexOf("READONLY")),r=t.name,n=t.type;if(0!==n.indexOf("/db/collection.")){var i=new p(r,this.getModel(n),e);return i.metadata=t.metadata,i}var o=n.substring(0,n.indexOf("[")),s=n.substring(n.indexOf("[")+1,n.indexOf("]")).trim();switch(o){case c.ref:return new c(r,this.getModel(s));case l.ref:return new l(r,this.getModel(s));case h.ref:var a=s.substring(0,s.indexOf(",")).trim(),u=s.substring(s.indexOf(",")+1).trim();return new h(r,this.getModel(a),this.getModel(u));default:throw new TypeError("No collection available for "+n)}},u);function u(){var r=this;D.classCallCheck(this,u),this.models={},this.modelDescriptors=null,Object.keys(n).forEach(function(t){var e=n[t];e instanceof n&&(r.models[e.ref]=e)})}e.exports=a},{31:31,36:36,39:39,40:40,41:41,43:43,47:47,48:48}],46:[function(t,e,r){"use strict";var n,i=t(35),o=Symbol("AttachedState"),s=Symbol("AttachedSize"),a=(n=i,D.inherits(u,n),u.getAttachedState=function(t){return t[o]||null},u.attachState=function(t,e){Object.defineProperty(t,o,{value:e,configurable:!0})},u.getAttachedSize=function(t){return t[s]},u.attachSize=function(t,e){Object.defineProperty(t,s,{value:e,configurable:!0})},D.createClass(u,[{key:"persistentAttributeType",get:function(){return i.PersistentAttributeType.ELEMENT_COLLECTION}}]),u);function u(t,e){D.classCallCheck(this,u);var r=D.possibleConstructorReturn(this,n.call(this,t));return r.elementType=e,r.typeConstructor=null,r}a.CollectionType={COLLECTION:0,LIST:1,MAP:2,SET:3},e.exports=a},{35:35}],47:[function(t,e,r){"use strict";var i,p=t(46),n=(i=p,D.inherits(o,i),D.createClass(o,[{key:"collectionType",get:function(){return p.CollectionType.SET}}],[{key:"ref",get:function(){return"/db/collection.Set"}}]),o.prototype.getJsonValue=function(t,e,r){var n=this.getValue(e);if(!(n instanceof this.typeConstructor))return null;for(var i={},o=p.getAttachedState(n)||{},s=p.getAttachedSize(n)!==n.size,a=[],u=n.values(),c=u.next();!c.done;c=u.next()){var h=c.value,l=this.elementType.toJsonValue(t,h,r);a.push(l),i[l]=h,s=s||o[l]!==h}return r.persisting&&(p.attachState(n,i),p.attachSize(n,n.size)),t.isPersistent&&s&&t.setDirty(),a},o.prototype.setJsonValue=function(t,e,r,n){var i=null;if(r){(i=this.getValue(e))instanceof this.typeConstructor||(i=new this.typeConstructor);var o={},s=p.getAttachedState(i)||{};i.clear();for(var a=0,u=r.length;a<u;a+=1){var c=r[a],h=c&&c.id?c.id:c,l=this.elementType.fromJsonValue(t,c,s[h],n);i.add(l),o[h]=l}n.persisting&&(p.attachState(i,o),p.attachSize(i,i.size))}this.setValue(e,i)},o.prototype.toJSON=function(){return Object.assign({},i.prototype.toJSON.call(this),{type:o.ref+"["+this.elementType.ref+"]"})},o);function o(t,e,r){D.classCallCheck(this,o);var n=D.possibleConstructorReturn(this,i.call(this,t,e,r));return n.typeConstructor=Set,n}e.exports=n},{46:46}],48:[function(t,e,r){"use strict";var i,n=t(35),o=t(49),s=(i=n,D.inherits(a,i),D.createClass(a,[{key:"typeConstructor",get:function(){return this.type.typeConstructor}},{key:"persistentAttributeType",get:function(){switch(this.type.persistenceType){case o.PersistenceType.BASIC:return n.PersistentAttributeType.BASIC;case o.PersistenceType.EMBEDDABLE:return n.PersistentAttributeType.EMBEDDED;case o.PersistenceType.ENTITY:return n.PersistentAttributeType.ONE_TO_MANY;default:throw new Error("Unknown persistent attribute type.")}}}]),a.prototype.getJsonValue=function(t,e,r){return this.type.toJsonValue(t,this.getValue(e),r)},a.prototype.setJsonValue=function(t,e,r,n){this.setValue(e,this.type.fromJsonValue(t,r,this.getValue(e),n))},a.prototype.toJSON=function(){return Object.assign({},i.prototype.toJSON.call(this),{type:this.type.ref})},a);function a(t,e,r){D.classCallCheck(this,a);var n=D.possibleConstructorReturn(this,i.call(this,t,r));return n.type=e,n}e.exports=s},{35:35,49:49}],49:[function(t,e,r){"use strict";var n=Symbol("TypeConstructor"),i=(D.createClass(o,[{key:"persistenceType",get:function(){return-1}},{key:"isBasic",get:function(){return this.persistenceType===o.PersistenceType.BASIC}},{key:"isEmbeddable",get:function(){return this.persistenceType===o.PersistenceType.EMBEDDABLE}},{key:"isEntity",get:function(){return this.persistenceType===o.PersistenceType.ENTITY}},{key:"isMappedSuperclass",get:function(){return this.persistenceType===o.PersistenceType.MAPPED_SUPERCLASS}},{key:"typeConstructor",get:function(){return this[n]},set:function(t){if(this[n])throw new Error("typeConstructor has already been set.");this[n]=t}}]),o.prototype.fromJsonValue=function(){},o.prototype.toJsonValue=function(){},o);function o(t,e){if(D.classCallCheck(this,o),0!==t.indexOf("/db/"))throw new SyntaxError("Type ref "+t+" is invalid.");this.ref=t,this.name=t.substring(4),this[n]=e}i.PersistenceType={BASIC:0,EMBEDDABLE:1,ENTITY:2,MAPPED_SUPERCLASS:3},i.TYPE_CONSTRUCTOR=n,e.exports=i},{}],50:[function(t,e,r){"use strict";var n=t(44);n.prototype.Attribute=t(35),n.prototype.BasicType=t(36),n.prototype.CollectionAttribute=t(37),n.prototype.EmbeddableType=t(39),n.prototype.EntityType=t(40),n.prototype.ListAttribute=t(41),n.prototype.ManagedType=t(42),n.prototype.MapAttribute=t(43),n.prototype.Metamodel=t(44),n.prototype.ModelBuilder=t(45),n.prototype.PluralAttribute=t(46),n.prototype.SetAttribute=t(47),n.prototype.SingularAttribute=t(48),n.prototype.Type=t(49),n.prototype.DbIndex=t(38),e.exports=new n},{35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49}],51:[function(t,e,r){"use strict";var n,i=t(52),o=t(65),s=t(73),a=t(34),u=(n=i,D.inherits(c,n),c.prototype.execute=function(){var e=this,r=o.get(this.entity),t=JSON.stringify(this),n=new a.UpdatePartially(r.bucket,r.key,t);return r.withLock(function(){return r.db.send(n).then(function(t){return r.setJson(t.entity,!0),e.entity})})},c);function c(t,e){D.classCallCheck(this,c);var r=D.possibleConstructorReturn(this,n.call(this,e));return r.entity=t,r}s(i.prototype,"_entity","entity"),e.exports=u},{34:34,52:52,65:65,73:73}],52:[function(t,e,r){"use strict";var i=["$add","$and","$currentDate","$dec","$inc","$max","$min","$mul","$or","$pop","$push","$put","$remove","$rename","$replace","$set","$shift","$unshift","$xor"],o=t(53),n=t(73),s=(a.prototype.set=function(t,e){var r,n=e;return n instanceof Set?n=Array.from(n):n instanceof Map&&(r={},n.forEach(function(t,e){r[e]=t}),n=r),this.addOperation(t,"$set",n)},a.prototype.inc=function(t,e){return this.addOperation(t,"$inc","number"==typeof e?e:1)},a.prototype.dec=function(t,e){return this.increment(t,"number"==typeof e?-e:-1)},a.prototype.mul=function(t,e){if("number"!=typeof e)throw new Error("Multiplicator must be a number.");return this.addOperation(t,"$mul",e)},a.prototype.div=function(t,e){if("number"!=typeof e)throw new Error("Divisor must be a number.");return this.addOperation(t,"$mul",1/e)},a.prototype.min=function(t,e){if("number"!=typeof e)throw new Error("Value must be a number");return this.addOperation(t,"$min",e)},a.prototype.max=function(t,e){if("number"!=typeof e)throw new Error("Value must be a number");return this.addOperation(t,"$max",e)},a.prototype.remove=function(t,e){return this.addOperation(t,"$remove",e)},a.prototype.put=function(t,e,r){var n={};return"string"==typeof e||"number"==typeof e?n[e]=r:"object"===(void 0===e?"undefined":D.typeof(e))&&Object.assign(n,e),this.addOperation(t,"$put",n)},a.prototype.push=function(t,e){return this.addOperation(t,"$push",e)},a.prototype.unshift=function(t,e){return this.addOperation(t,"$unshift",e)},a.prototype.pop=function(t){return this.addOperation(t,"$pop")},a.prototype.shift=function(t){return this.addOperation(t,"$shift")},a.prototype.add=function(t,e){return this.addOperation(t,"$add",e)},a.prototype.replace=function(t,e,r){if(this.hasOperationOnPath(t))throw new Error("You cannot update "+t+" multiple times");return this.addOperation(t+"."+e,"$replace",r)},a.prototype.currentDate=function(t){return this.addOperation(t,"$currentDate")},a.prototype.and=function(t,e){return this.addOperation(t,"$and",e)},a.prototype.or=function(t,e){return this.addOperation(t,"$or",e)},a.prototype.xor=function(t,e){return this.addOperation(t,"$xor",e)},a.prototype.rename=function(t,e){return this.addOperation(t,"$rename",e)},a.prototype.toJSON=function(){return this.operations.reduce(function(t,e){var r={};return r[e.path]=e.value,t[e.name]=Object.assign({},t[e.name],r),t},{})},a.prototype.execute=function(){throw new Error('Cannot call "execute" on abstract PartialUpdateBuilder')},a.prototype.addOperation=function(t,e,r){if("string"!=typeof t)throw new Error("Path must be a string");if(-1===i.indexOf(e))throw new Error("Operation invalid: "+e);if(this.hasOperationOnPath(t))throw new Error("You cannot update "+t+" multiple times");if("number"==typeof r){if(Number.isNaN(r))throw new Error("NaN is not a supported value");if(!Number.isFinite(r))throw new Error("Infinity is not a supported value")}var n=new o(e,t,void 0===r?null:r);return this.operations.push(n),this},a.prototype.addOperations=function(t){var i=this;Object.keys(t).forEach(function(r){var n=t[r];Object.keys(n).forEach(function(t){var e=n[t];i.operations.push(new o(r,t,e))})})},a.prototype.hasOperationOnPath=function(e){return this.operations.some(function(t){return t.path===e})},a);function a(t){D.classCallCheck(this,a),this.operations=[],t&&this.addOperations(t)}Object.assign(s.prototype,{increment:s.prototype.inc,decrement:s.prototype.dec,multiply:s.prototype.mul,divide:s.prototype.div,atMost:s.prototype.min,atLeast:s.prototype.max,toNow:s.prototype.currentDate}),n(s.prototype,"_operations","operations"),n(s.prototype,"_addOperation","addOperation"),n(s.prototype,"_hasOperationOnPath","hasOperationOnPath"),e.exports=s},{53:53,73:73}],53:[function(t,e,r){"use strict";e.exports=function t(e,r,n){D.classCallCheck(this,t),this.name=e,this.path=r,this.value=n}},{}],54:[function(t,e,r){"use strict";r.EntityPartialUpdateBuilder=t(51),r.PartialUpdateBuilder=t(52)},{51:51,52:52}],55:[function(t,e,r){"use strict";var n,i=t(57),o=t(56),s=t(59),a=t(60),u=t(73),c=a.varargs,h=(n=a,D.inherits(l,n),l.prototype.and=function(){return this.addOperator("$and",c(0,arguments))},l.prototype.or=function(){return this.addOperator("$or",c(0,arguments))},l.prototype.nor=function(){return this.addOperator("$nor",c(0,arguments))},l.prototype.eventStream=function(t,e,r,n){return this.where({}).eventStream(t,e,r,n)},l.prototype.resultStream=function(t,e,r,n){return this.where({}).resultStream(t,e,r,n)},l.prototype.resultList=function(t,e,r){return this.where({}).resultList(t,e,r)},l.prototype.singleResult=function(t,e,r){return this.where({}).singleResult(t,e,r)},l.prototype.count=function(t,e){return this.where({}).count(t,e)},l.prototype.addOperator=function(t,e){if(e.length<2)throw new Error("Only two or more queries can be joined with an "+t+" operator.");return e.forEach(function(t,e){if(!(t instanceof a))throw new Error("Argument at index "+e+" is not a query.")}),new s(this.entityManager,this.resultClass,t,e)},l.prototype.addOrder=function(t,e){return new i(this.entityManager,this.resultClass).addOrder(t,e)},l.prototype.addFilter=function(t,e,r){return new i(this.entityManager,this.resultClass).addFilter(t,e,r)},l.prototype.addOffset=function(t){return new i(this.entityManager,this.resultClass).addOffset(t)},l.prototype.addLimit=function(t){return new i(this.entityManager,this.resultClass).addLimit(t)},l);function l(){return D.classCallCheck(this,l),D.possibleConstructorReturn(this,n.apply(this,arguments))}Object.assign(h.prototype,o),u(h.prototype,"_addOperator","addOperator"),u(h.prototype,"_addOrder","addOrder"),u(h.prototype,"_addFilter","addFilter"),u(h.prototype,"_addOffset","addOffset"),u(h.prototype,"_addLimit","addLimit"),e.exports=h},{56:56,57:57,59:59,60:60,73:73}],56:[function(t,e,r){"use strict";var n=t(60).varargs,i={};Object.assign(i,{where:function(t){return this.addFilter(null,null,t)},equal:function(t,e){return this.addFilter(t,null,e)},notEqual:function(t,e){return this.addFilter(t,"$ne",e)},greaterThan:function(t,e){return this.addFilter(t,"$gt",e)},greaterThanOrEqualTo:function(t,e){return this.addFilter(t,"$gte",e)},lessThan:function(t,e){return this.addFilter(t,"$lt",e)},lessThanOrEqualTo:function(t,e){return this.addFilter(t,"$lte",e)},between:function(t,e,r){return this.addFilter(t,"$gt",e).addFilter(t,"$lt",r)},in:function(t){return this.addFilter(t,"$in",n(1,arguments))},notIn:function(t){return this.addFilter(t,"$nin",n(1,arguments))},isNull:function(t){return this.equal(t,null)},isNotNull:function(t){return this.addFilter(t,"$exists",!0).addFilter(t,"$ne",null)},containsAll:function(t){return this.addFilter(t,"$all",n(1,arguments))},mod:function(t,e,r){return this.addFilter(t,"$mod",[e,r])},matches:function(t,e){var r=e instanceof RegExp?e:new RegExp(e);if(r.ignoreCase)throw new Error("RegExp.ignoreCase flag is not supported.");if(r.global)throw new Error("RegExp.global flag is not supported.");if(0!==r.source.indexOf("^"))throw new Error("regExp must be an anchored expression, i.e. it must be started with a ^.");var n=this.addFilter(t,"$regex",r.source);return r.multiline&&n.addFilter(t,"$options","m"),n},size:function(t,e){return this.addFilter(t,"$size",e)},near:function(t,e,r){return this.addFilter(t,"$nearSphere",{$geometry:{type:"Point",coordinates:[e.longitude,e.latitude]},$maxDistance:r})},withinPolygon:function(t){var e=n(1,arguments);return this.addFilter(t,"$geoWithin",{$geometry:{type:"Polygon",coordinates:[e.map(function(t){return[t.longitude,t.latitude]})]}})}}),Object.assign(i,{eq:i.equal,ne:i.notEqual,lt:i.lessThan,le:i.lessThanOrEqualTo,gt:i.greaterThan,ge:i.greaterThanOrEqualTo,containsAny:i.in}),e.exports=i},{60:60}],57:[function(t,e,r){"use strict";var n,i=t(58),o=t(56),s=t(73),a=(n=i,D.inherits(u,n),u.prototype.addFilter=function(t,e,r){if(null!==t){if(!(Object(t)instanceof String))throw new Error("Field must be a string.");var n;e?((n=this.filter[t])instanceof Object&&Object.getPrototypeOf(n)===Object.prototype||(n={},this.filter[t]=n),n[e]=r):this.filter[t]=r}else Object.assign(this.filter,r);return this},u.prototype.toJSON=function(){return this.filter},u);function u(t,e){D.classCallCheck(this,u);var r=D.possibleConstructorReturn(this,n.call(this,t,e));return r.filter={},r}Object.assign(a.prototype,o),s(a.prototype,"_filter","filter"),s(a.prototype,"_addFilter","addFilter"),e.exports=a},{56:56,58:58,73:73}],58:[function(t,e,r){"use strict";var n,u=t(60),c=t(34),i=t(65),o=t(9),s=t(73),a=(n=u,D.inherits(h,n),h.prototype.eventStream=function(){throw new Error("Streaming features not available! Please use Streaming SDK!")},h.prototype.resultStream=function(){throw new Error("Streaming features not available! Please use Streaming SDK!")},h.prototype.resultList=function(e,t,r){var n=this;if(e instanceof Function)return this.resultList({},e,t);var i=this.resultClass?this.entityManager.metamodel.entity(this.resultClass):null;if(!i)throw new Error("Only typed queries can be executed.");var o=this.serializeQuery(),s=this.serializeSort(),a=void 0,a=this.entityManager.connection.host.length+o.length+s.length>u.MAX_URI_SIZE?new c.AdhocQueryPOST(i.name,this.firstResult,this.maxResults,s).entity(o,"text"):new c.AdhocQuery(i.name,o,this.firstResult,this.maxResults,s);return this.entityManager.send(a).then(function(t){return n.createResultList(t.entity,e)}).then(t,r)},h.prototype.singleResult=function(e,t,r){var n=this;if(e instanceof Function)return this.singleResult({},e,t);var i=this.resultClass?this.entityManager.metamodel.entity(this.resultClass):null;if(!i)throw new Error("Only typed queries can be executed.");var o=this.serializeQuery(),s=this.serializeSort(),a=void 0,a=this.entityManager.connection.host.length+o.length>u.MAX_URI_SIZE?new c.AdhocQueryPOST(i.name,o,this.firstResult,1,s).entity(o,"text"):new c.AdhocQuery(i.name,o,this.firstResult,1,s);return this.entityManager.send(a).then(function(t){return n.createResultList(t.entity,e)}).then(function(t){return t.length?t[0]:null}).then(t,r)},h.prototype.count=function(t,e){var r=this.resultClass?this.entityManager.metamodel.entity(this.resultClass):null;if(!r)throw new Error("Only typed queries can be executed.");var n=this.serializeQuery(),i=void 0,i=this.entityManager.connection.host.length+n.length>u.MAX_URI_SIZE?new c.AdhocCountQueryPOST(r.name).entity(n,"text"):new c.AdhocCountQuery(r.name,n);return this.entityManager.send(i).then(function(t){return t.entity.count}).then(t,e)},h.prototype.serializeQuery=function(){return JSON.stringify(this,function(t,e){var r=this[t];return r instanceof Date?{$date:e}:r instanceof o?r.id:e})},h.prototype.serializeSort=function(){return JSON.stringify(this.order)},h.prototype.createResultList=function(t,r){var n=this;return t.length?Promise.all(t.map(function(t){if(t.id){var e=n.entityManager.getReference(n.resultClass,t.id);return i.get(e).setJson(t,{persisting:!0}),n.entityManager.resolveDepth(e,r)}return n.entityManager.load(Object.keys(t)[0])},this)).then(function(t){return t.filter(function(t){return!!t})}):Promise.resolve([])},h.prototype.addOrder=function(t,e){return e?this.order[t]=e:this.order=t,this},h.prototype.addOffset=function(t){return this.firstResult=t,this},h.prototype.addLimit=function(t){return this.maxResults=t,this},h);function h(t,e){D.classCallCheck(this,h);var r=D.possibleConstructorReturn(this,n.call(this,t,e));return r.firstResult=0,r.maxResults=-1,r.order={},r}s(a.prototype,"_sort","order"),s(a.prototype,"_serializeQuery","serializeQuery"),s(a.prototype,"_serializeSort","serializeSort"),s(a.prototype,"_createResultList","createResultList"),s(a.prototype,"_addOrder","addOrder"),s(a.prototype,"_addOffset","addOffset"),s(a.prototype,"_addLimit","addLimit"),e.exports=a},{34:34,60:60,65:65,73:73,9:9}],59:[function(t,e,r){"use strict";var o,n=t(58),i=t(73),s=(o=n,D.inherits(a,o),a.prototype.toJSON=function(){var t={};return t[this.operator]=this.childs,t},a);function a(t,e,r,n){D.classCallCheck(this,a);var i=D.possibleConstructorReturn(this,o.call(this,t,e));return i.operator=r,i.childs=n,i}i(s.prototype,"_operator","operator"),i(s.prototype,"_childs","childs"),e.exports=s},{58:58,73:73}],60:[function(t,e,r){"use strict";var n=(i.prototype.ascending=function(t){return this.addOrder(t,1)},i.prototype.descending=function(t){return this.addOrder(t,-1)},i.prototype.sort=function(t){if(!(t instanceof Object)||Object.getPrototypeOf(t)!==Object.prototype)throw new Error("sort must be an object.");return this.addOrder(t)},i.prototype.offset=function(t){if(t<0)throw new Error("The offset can't be nagative.");return this.addOffset(t)},i.prototype.limit=function(t){if(t<0)throw new Error("The limit can't be nagative.");return this.addLimit(t)},i.prototype.resultList=function(){},i.prototype.singleResult=function(){},i.prototype.eventStream=function(){},i.prototype.resultStream=function(){},i.prototype.count=function(){},i);function i(t,e){D.classCallCheck(this,i),this.entityManager=t,this.resultClass=e}n.MAX_URI_SIZE=2e3,n.varargs=function(t,e){return Array.prototype.concat.apply([],Array.prototype.slice.call(e,t))},e.exports=n},{}],61:[function(t,e,r){"use strict";r.Builder=t(55),r.Condition=t(56),r.Filter=t(57),r.Node=t(58),r.Operator=t(59),r.Query=t(60)},{55:55,56:56,57:57,58:58,59:59,60:60}],62:[function(t,e,r){"use strict";var a=t(34),s=t(25).StatusCode,n=t(73),i=(o.prototype.functionToString=function(t){if(!t)return"";var e=t.toString();return"\n"===(e=e.substring(e.indexOf("{")+1,e.lastIndexOf("}"))).charAt(0)&&(e=e.substring(1)),"\n"===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1)),e},o.prototype.stringToFunction=function(t,e){return new Function(t,e)},o.prototype.loadModules=function(){var t=new a.GetAllModules;return this.entityManagerFactory.send(t).then(function(t){return t.entity})},o.prototype.loadCode=function(t,e,r){var n=this,i=Object(t)instanceof String?t:t.name,o=new a.GetBaqendCode(i,e).responseType("text");return this.entityManagerFactory.send(o).then(function(t){return n.parseCode(i,e,r,t.entity)},function(t){if(t.status===s.OBJECT_NOT_FOUND)return null;throw t})},o.prototype.saveCode=function(t,e,r){var n=this,i=Object(t)instanceof String?t:t.name,o=r instanceof Function,s=new a.SetBaqendCode(i,e).entity(o?this.functionToString(r):r,"text").responseType("text");return this.entityManagerFactory.send(s).then(function(t){return n.parseCode(i,e,o,t.entity)})},o.prototype.deleteCode=function(t,e){var r=this,n=Object(t)instanceof String?t:t.name,i=new a.DeleteBaqendCode(n,e);return this.entityManagerFactory.send(i).then(function(){return r.parseCode(n,e,!1,null)})},o.prototype.parseCode=function(t,e,r,n){if("validate"!==e)return r?this.stringToFunction(["module","exports"],n):n;var i=this.metamodel.entity(t);return i.validationCode=n,r?i.validationCode:n},o);function o(t,e){D.classCallCheck(this,o),this.metamodel=t,this.entityManagerFactory=e}n(i.prototype,"_metamodel","metamodel"),n(i.prototype,"_parseCode","parseCode"),e.exports=i},{25:25,34:34,73:73}],63:[function(t,e,r){"use strict";var n=t(73),i=Symbol("IsLocked"),o=Symbol("ReadyPromise"),s=(a.prototype.ready=function(t,e){return this[o].then(t,e)},a.prototype.withLock=function(t,e){var r=this;if(this[i])throw new Error("Current operation has not been finished.");try{this[i]=!0;var n=t().then(function(t){return r[i]=!1,t},function(t){throw e||(r[i]=!1),t});return this[o]=n.then(function(){return r},function(t){if(!e)return r;throw t}),n}catch(t){throw e?this[o]=Promise.reject(t):this[i]=!1,t}},D.createClass(a,[{key:"isReady",get:function(){return!this[i]}}]),a);function a(){D.classCallCheck(this,a),this[i]=!1,this[o]=Promise.resolve(this)}n(s.prototype,"_isLocked",i),n(s.prototype,"_readyPromise",o),e.exports=s},{73:73}],64:[function(t,e,r){"use strict";var n=t(34),i=t(73),o=(s.create=function(t){var e=this.prototype;function r(){e.log.apply(r,arguments)}return Object.getOwnPropertyNames(e).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}),r.init(t),r},s.prototype.log=function(){var t=Array.prototype.slice.call(arguments),e=-1===s.LEVELS.indexOf(t[0])?"info":t.shift();if(this.levelIndex>s.LEVELS.indexOf(e))return null;var r="string"==typeof t[0]?this.format(t.shift(),t):"[no message]",n=null;return t.length&&("object"===(void 0===(n=t.pop())?"undefined":D.typeof(n))&&!Array.isArray(n)||(n={data:n}),n instanceof Error&&(n={name:n.name,message:n.message,stack:n.stack,status:n.status,data:n.data})),t.length&&(r+=", "+t.join(", ")),this.logJSON({date:new Date,message:r,level:e,user:this.entityManager.me&&this.entityManager.me.id,data:n})},s.prototype.format=function(t,e){return 0===e.length?t:String(t).replace(s.FORMAT_REGEXP,function(t){if("%%"===t)return"%";if(!e.length)return t;switch(t){case"%s":return String(e.shift());case"%d":return Number(e.shift());case"%j":try{return JSON.stringify(e.shift())}catch(t){return"[Circular]"}default:return t}})},s.prototype.init=function(t){var e=this;this.entityManager=t,this.levelIndex=2,s.LEVELS.forEach(function(t){e[t]=e.log.bind(e,t)})},s.prototype.logJSON=function(t){return this.entityManager.isReady?this.entityManager.send(new n.CreateObject("logs.AppLog",t)):this.entityManager.ready(this.logJSON.bind(this,t))},D.createClass(s,[{key:"level",get:function(){return s.LEVELS[this.levelIndex]},set:function(t){var e=s.LEVELS.indexOf(t);if(-1===e)throw new Error("Unknown logging level "+t);this.levelIndex=e}}]),s);function s(){D.classCallCheck(this,s)}Object.assign(o,{LEVELS:["trace","debug","info","warn","error"],FORMAT_REGEXP:/%[sdj%]/g}),i(o.prototype,"_init","init"),i(o.prototype,"_format","format"),i(o.prototype,"_log","logJSON"),e.exports=o},{34:34,73:73}],65:[function(t,e,r){"use strict";var n,i=t(33),o=t(1),s=t(63),a=t(73),u=(n=s,D.inherits(c,n),c.create=function(t,e){var r=void 0;if(t.isEntity)r=new c(e,t);else{if(!t.isEmbeddable)throw new Error("Illegal type "+t);r={type:t,readAccess:function(){var t=this.root&&this.root._metadata;t&&t.readAccess()},writeAccess:function(){var t=this.root&&this.root._metadata;t&&t.writeAccess()}}}return r},c.get=function(t){return t._metadata},D.createClass(c,[{key:"db",get:function(){return this.entityManager||(this.entityManager=t(5)),this.entityManager},set:function(t){if(this.entityManager)throw new Error("DB has already been set.");this.entityManager=t}},{key:"bucket",get:function(){return this.type.name}},{key:"key",get:function(){var t;return!this.decodedKey&&this.id&&(t=this.id.lastIndexOf("/"),this.decodedKey=decodeURIComponent(this.id.substring(t+1))),this.decodedKey},set:function(t){var e=t+"";if(this.id)throw new Error("The id can't be set twice.");this.id="/db/"+this.bucket+"/"+encodeURIComponent(e),this.decodedKey=e}},{key:"isAttached",get:function(){return!!this.entityManager}},{key:"isAvailable",get:function(){return this.state>c.Type.UNAVAILABLE}},{key:"isPersistent",get:function(){return this.state===c.Type.PERSISTENT}},{key:"isDirty",get:function(){return this.state===c.Type.DIRTY}}]),c.prototype.enable=function(t){this.enabled=t},c.prototype.readAccess=function(){if(this.enabled&&!this.isAvailable)throw new i.PersistentError("This object "+this.id+" is not available.")},c.prototype.writeAccess=function(){if(this.enabled){if(!this.isAvailable)throw new i.PersistentError("This object "+this.id+" is not available.");this.setDirty()}},c.prototype.setUnavailable=function(){this.state=c.Type.UNAVAILABLE},c.prototype.setPersistent=function(){this.state=c.Type.PERSISTENT},c.prototype.setDirty=function(){this.state=c.Type.DIRTY},c.prototype.setRemoved=function(){this.isAvailable&&(this.setDirty(),this.version=null)},c.prototype.getJson=function(t){return this.type.toJsonValue(this,this.root,t)},c.prototype.setJson=function(t,e){this.type.fromJsonValue(this,t,this.root,e)},c);function c(t,e){D.classCallCheck(this,c);var r=D.possibleConstructorReturn(this,n.call(this));return r.root=t,r.state=c.Type.DIRTY,r.enabled=!0,r.id=null,r.version=null,r.type=e,r.acl=new o(r),r}u.Type={UNAVAILABLE:-1,PERSISTENT:0,DIRTY:1},a(u.prototype,"_root","root"),a(u.prototype,"_state","state"),a(u.prototype,"_enabled","enabled"),e.exports=u},{1:1,33:33,5:5,63:63,73:73}],66:[function(t,e,r){"use strict";var a=t(34),n=t(73),i=(o.prototype.get=function(t,e,r,n,i){if(e instanceof Function)return this.get(t,{},e,r,n);if(r instanceof Function)return this.get(t,e,{},r,n);var o=r||{},s=new a.GetBaqendModule(t).addQueryString(e).responseType(o.responseType||null);return this.send(s,n,i)},o.prototype.post=function(t,e,r,n,i){if(r instanceof Function)return this.post(t,e,{},r,n);var o=r||{},s=new a.PostBaqendModule(t).entity(e,o.requestType).mimeType(o.mimeType||null).responseType(o.responseType||null);return this.send(s,n,i)},o.prototype.send=function(t,e,r){return this.entityManager.send(t).then(function(t){return t.entity}).then(e,r)},o);function o(t){D.classCallCheck(this,o),this.entityManager=t}n(i.prototype,"_entityManager","entityManager"),n(i.prototype,"_send","send"),e.exports=i},{34:34,73:73}],67:[function(t,e,r){"use strict";var n=t(73),i=(o.prototype.allRules=function(){return Object.keys(this.rules)},o.prototype.clear=function(){this._metadata&&this._metadata.writeAccess(),this.rules={}},o.prototype.copy=function(t){return this._metadata&&this._metadata.writeAccess(),this.rules=Object.assign({},t.rules),this},o.prototype.isPublicAllowed=function(){var e=this;return!("*"in this.rules||this.allRules().some(function(t){return"allow"===e.rules[t]}))},o.prototype.setPublicAllowed=function(){var e=this;this._metadata&&this._metadata.writeAccess(),this.allRules().forEach(function(t){"allow"===e.rules[t]&&delete e.rules[t]})},o.prototype.getRule=function(t){return this.rules[this.ref(t)]},o.prototype.isAllowed=function(t){return"allow"===this.rules[this.ref(t)]},o.prototype.isDenied=function(t){return"deny"===this.rules[this.ref(t)]},o.prototype.allowAccess=function(){var t=arguments;this._metadata&&this._metadata.writeAccess();for(var e=0;e<t.length;e+=1)this.rules[this.ref(t[e])]="allow";return this},o.prototype.denyAccess=function(){var t=arguments;this._metadata&&this._metadata.writeAccess();for(var e=0;e<t.length;e+=1)this.rules[this.ref(t[e])]="deny";return this},o.prototype.deleteAccess=function(){var t=arguments;this._metadata&&this._metadata.writeAccess();for(var e=0;e<t.length;e+=1)delete this.rules[this.ref(t[e])];return this},o.prototype.toJSON=function(){return Object.assign({},this.rules)},o.prototype.fromJSON=function(t){this.rules=t},o.fromJSON=function(t){var e=new this;return e.fromJSON(t),e},o.prototype.ref=function(t){var e="string"==typeof t?t:t.id;if(0===e.indexOf("/db/User/")||0===e.indexOf("/db/Role/"))return e;throw new TypeError("The given object isn't a user, role or a valid reference.")},o);function o(t){D.classCallCheck(this,o),this.rules={},this._metadata=t}i.BASE_PERMISSIONS=["load","update","delete","query","insert"],n(i.prototype,"_rules","rules"),e.exports=i},{73:73}],68:[function(t,e,r){"use strict";var n=t(9),i=(a.initDevices=function(t){if(t instanceof Set)return t;if(!t||t[Symbol.iterator])return new Set(t);if(t instanceof n)return new Set([t]);throw new Error("Only Sets, Lists and Arrays can be used as devices.")},a.prototype.addDevice=function(t){this.devices||(this.devices=new Set),this.devices.add(t)},a.prototype.toJSON=function(){if(!this.devices||!this.devices.size)throw new Error("Set of devices is empty.");return Object.assign({},this,{devices:Array.from(this.devices,function(t){return t.id})})},a);function a(t,e,r,n,i,o){D.classCallCheck(this,a);var s="string"==typeof n?{sound:n,badge:i,data:o}:n||{};this.devices=a.initDevices(t),this.message=e,this.subject=r,Object.assign(this,s)}e.exports=i},{9:9}],69:[function(t,e,r){"use strict";var n=t(74).hmac,i=t(73),o=(s.parse=function(t){return{val:t,createdAt:1e3*parseInt(t.substring(0,8),16),expireAt:1e3*parseInt(t.substring(8,16),16),sig:t.substring(t.length-40),data:t.substring(0,t.length-40)}},s.create=function(t){return Promise.resolve(new s(t))},D.createClass(s,[{key:"token",get:function(){return this.tokenData?this.tokenData.val:null}}]),s.prototype.saveToken=function(t,e,r){this._saveToken!==s.prototype._saveToken&&(console.log("Using deprecated TokenStorage._saveToken implementation."),this._saveToken(t,e,r))},s.prototype._saveToken=function(){},s.prototype.update=function(t){var e=t?s.parse(t):null;this.tokenData&&e&&this.tokenData.expireAt>e.expireAt||(this.tokenData=e,this.saveToken(this.origin,t,this.temporary))},s.prototype.signPath=function(t){if(this.tokenData){var e=t.split("/").map(encodeURIComponent).join("/");return e+"?BAT="+(this.tokenData.data+n(e+this.tokenData.data,this.tokenData.sig))}return t},s);function s(t,e,r){D.classCallCheck(this,s),this.tokenData=e?s.parse(e):null,this.origin=t,this.temporary=r}i(o.prototype,"_token","tokenData"),i(o.prototype,"_origin","origin");var a,u={},c=(a=o,D.inherits(h,a),h.create=function(t){return Promise.resolve(new h(t,u[t]))},h.prototype.saveToken=function(t,e,r){r||(e?u[t]=e:delete u[t])},h);function h(){return D.classCallCheck(this,h),D.possibleConstructorReturn(this,a.apply(this,arguments))}o.GLOBAL=c;var l,p=(l=o,D.inherits(d,l),d.isAvailable=function(){try{return"undefined"!=typeof localStorage&&(localStorage.setItem("bq_webstorage_test","bq"),localStorage.removeItem("bq_webstorage_test"),!0)}catch(t){return!1}},d.create=function(t){var e=!1,r=localStorage.getItem("BAT:"+t);return r||"undefined"==typeof sessionStorage||(e=!!(r=sessionStorage.getItem("BAT:"+t))),Promise.resolve(new d(t,r,e))},d.prototype.saveToken=function(t,e,r){var n=r?sessionStorage:localStorage;e?n.setItem("BAT:"+t,e):n.removeItem("BAT:"+t)},d);function d(){return D.classCallCheck(this,d),D.possibleConstructorReturn(this,l.apply(this,arguments))}p.isAvailable()&&(o.WEB_STORAGE=p),e.exports=o},{73:73,74:74}],70:[function(t,e,r){"use strict";var n=(D.createClass(i,[{key:"isValid",get:function(){var e=this;return Object.keys(this.fields).every(function(t){return e.fields[t].isValid})}}]),i.prototype.toJSON=function(){var e=this,r={};return Object.keys(this.fields).forEach(function(t){r[t]=e.fields[t].toJSON()}),r},i);function i(){D.classCallCheck(this,i),this.fields={}}e.exports=n},{}],71:[function(t,e,r){"use strict";var i=t(87),n=t(73),o=(s.compile=function(t,e){for(var r=[],n=t.attributes(),i=n.next();!i.done;i=n.next()){var o=i.value;r.push(o.name)}var s=new Function(r,e);return function(e){var t=r.map(function(t){return e[t]});return s.apply({},t)}},s.prototype.is=function(t,e){return t instanceof Function?this.is("is",t):(!1===e(this.value,i)&&this.errors.push(t),this)},D.createClass(s,[{key:"value",get:function(){return this.entity[this.key]}},{key:"isValid",get:function(){return 0===this.errors.length}}]),s.prototype.callMethod=function(t,e,r){var n=r||[];return n.unshift(this.value),!1===i[t].apply(this,n)&&this.errors.push(e),this},s.prototype.toString=function(){return this.value},s.prototype.toJSON=function(){return{isValid:this.isValid,errors:this.errors}},s);function s(t,e){D.classCallCheck(this,s),this.key=t,this.entity=e,this.errors=[]}Object.keys(i).forEach(function(e){"function"==typeof i[e]&&"toString"!==e&&"toDate"!==e&&"extend"!==e&&"init"!==e&&(o.prototype[e]=function(t){return this.callMethod(e,t||e,Array.prototype.slice.call(arguments,t?1:0))})}),n(o.prototype,"_callMethod","callMethod"),n(o.prototype,"_entity","entity"),e.exports=o},{73:73,87:87}],72:[function(t,e,r){"use strict";r.atob=atob},{}],73:[function(t,e,r){"use strict";e.exports=function(t,e,r){var n=t.constructor.name;Object.defineProperty(t,e,{get:function(){return console.log("Usage of "+n+"."+e+" is deprecated, use "+n+"."+r+" instead."),this[r]},set:function(t){console.log("Usage of "+n+"."+e+" is deprecated, use "+n+"."+r+" instead."),this[r]=t},enumerable:!1})}},{}],74:[function(t,e,r){"use strict";r.hmac=t(80)},{80:80}],75:[function(t,e,r){"use strict";r.isNode=t(76).isNode,r.atob=t(72).atob,r.hmac=t(74).hmac,r.Metadata=t(65),r.Permission=t(67),r.Validator=t(71),r.ValidationResult=t(70),r.Code=t(62),r.Modules=t(66),r.Lockable=t(63),r.Logger=t(64),r.PushMessage=t(68),r.TokenStorage=t(69),r.uuid=t(77).uuid},{62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,74:74,76:76,77:77}],76:[function(t,e,r){"use strict";r.isNode=!1},{}],77:[function(t,e,r){"use strict";r.uuid=t(86)},{86:86}],78:[function(t,e,r){},{}],79:[function(t,e,r){var n,i;n=this,i=function(){var h,r,t,e,n,l,i,o,s,a,u,c,p=p||(h=Math,r=Object.create||function(t){var e;return d.prototype=t,e=new d,d.prototype=null,e},e=(t={}).lib={},n=e.Base={extend:function(t){var e=r(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),(e.init.prototype=e).$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},l=e.WordArray=n.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||o).stringify(this)},concat:function(t){var e=this.words,r=t.words,n=this.sigBytes,i=t.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var s=r[o>>>2]>>>24-o%4*8&255;e[n+o>>>2]|=s<<24-(n+o)%4*8}else for(o=0;o<i;o+=4)e[n+o>>>2]=r[o>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=h.ceil(e/4)},clone:function(){var t=n.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],r=0;r<t;r+=4){var n=function(e){var e=e,r=987654321,n=4294967295;return function(){var t=((r=36969*(65535&r)+(r>>16)&n)<<16)+(e=18e3*(65535&e)+(e>>16)&n)&n;return t/=4294967296,(t+=.5)*(.5<h.random()?1:-1)}}(4294967296*(i||h.random())),i=987654071*n();e.push(4294967296*n()|0)}return new l.init(e,t)}}),i=t.enc={},o=i.Hex={stringify:function(t){for(var e=t.words,r=t.sigBytes,n=[],i=0;i<r;i++){var o=e[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new l.init(r,e/2)}},s=i.Latin1={stringify:function(t){for(var e=t.words,r=t.sigBytes,n=[],i=0;i<r;i++){var o=e[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(t){for(var e=t.length,r=[],n=0;n<e;n++)r[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new l.init(r,e)}},a=i.Utf8={stringify:function(t){try{return decodeURIComponent(escape(s.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return s.parse(unescape(encodeURIComponent(t)))}},u=e.BufferedBlockAlgorithm=n.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=a.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var e=this._data,r=e.words,n=e.sigBytes,i=this.blockSize,o=n/(4*i),s=(o=t?h.ceil(o):h.max((0|o)-this._minBufferSize,0))*i,a=h.min(4*s,n);if(s){for(var u=0;u<s;u+=i)this._doProcessBlock(r,u);var c=r.splice(0,s);e.sigBytes-=a}return new l.init(c,a)},clone:function(){var t=n.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),e.Hasher=u.extend({cfg:n.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(r){return function(t,e){return new r.init(e).finalize(t)}},_createHmacHelper:function(r){return function(t,e){return new c.HMAC.init(r,e).finalize(t)}}}),c=t.algo={},t);function d(){}return p},"object"==typeof r?e.exports=r=i():n.CryptoJS=i()},{}],80:[function(t,e,r){var n,i;n=this,i=function(t){return t.HmacSHA1},"object"==typeof r?e.exports=r=i(t(79),t(82),t(81)):i(n.CryptoJS)},{79:79,81:81,82:82}],81:[function(t,e,r){var n,i;n=this,i=function(t){var e,c;e=t.lib.Base,c=t.enc.Utf8,t.algo.HMAC=e.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=c.parse(e));var r=t.blockSize,n=4*r;e.sigBytes>n&&(e=t.finalize(e)),e.clamp();for(var i=this._oKey=e.clone(),o=this._iKey=e.clone(),s=i.words,a=o.words,u=0;u<r;u++)s[u]^=1549556828,a[u]^=909522486;i.sigBytes=o.sigBytes=n,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,r=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(r))}})},"object"==typeof r?e.exports=r=i(t(79)):i(n.CryptoJS)},{79:79}],82:[function(t,e,r){var n,i;n=this,i=function(t){var e,r,n,i,o,l,s;return r=(e=t).lib,n=r.WordArray,i=r.Hasher,o=e.algo,l=[],s=o.SHA1=i.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var r,n=this._hash.words,i=n[0],o=n[1],s=n[2],a=n[3],u=n[4],c=0;c<80;c++){c<16?l[c]=0|t[e+c]:(r=l[c-3]^l[c-8]^l[c-14]^l[c-16],l[c]=r<<1|r>>>31);var h=(i<<5|i>>>27)+u+l[c];h+=c<20?1518500249+(o&s|~o&a):c<40?1859775393+(o^s^a):c<60?(o&s|o&a|s&a)-1894007588:(o^s^a)-899497514,u=a,a=s,s=o<<30|o>>>2,o=i,i=h}n[0]=n[0]+i|0,n[1]=n[1]+o|0,n[2]=n[2]+s|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0},_doFinalize:function(){var t=this._data,e=t.words,r=8*this._nDataBytes,n=8*t.sigBytes;return e[n>>>5]|=128<<24-n%32,e[14+(64+n>>>9<<4)]=Math.floor(r/4294967296),e[15+(64+n>>>9<<4)]=r,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}}),e.SHA1=i._createHelper(s),e.HmacSHA1=i._createHmacHelper(s),t.SHA1},"object"==typeof r?e.exports=r=i(t(79)):i(n.CryptoJS)},{79:79}],83:[function(t,e,r){"use strict";function n(t,e){if("function"!=typeof t)throw new TypeError("argument fn must be a function");return t}function i(t,e,r){if(!t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("argument obj must be object");var n=Object.getOwnPropertyDescriptor(t,e);if(!n)throw new TypeError("must call property on owner object");if(!n.configurable)throw new TypeError("property must be configurable")}e.exports=function(t){if(!t)throw new TypeError("argument namespace is required");function e(t){}return e._file=void 0,e._ignored=!0,e._namespace=t,e._traced=!1,e._warned=Object.create(null),e.function=n,e.property=i,e}},{}],84:[function(t,e,r){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(t,e){var r=e||0;return[n[t[r++]],n[t[r++]],n[t[r++]],n[t[r++]],"-",n[t[r++]],n[t[r++]],"-",n[t[r++]],n[t[r++]],"-",n[t[r++]],n[t[r++]],"-",n[t[r++]],n[t[r++]],n[t[r++]],n[t[r++]],n[t[r++]],n[t[r++]]].join("")}},{}],85:[function(t,e,r){var n,i,o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);o?(n=new Uint8Array(16),e.exports=function(){return o(n),n}):(i=new Array(16),e.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),i[e]=t>>>((3&e)<<3)&255;return i})},{}],86:[function(t,e,r){var s=t(85),a=t(84);e.exports=function(t,e,r){var n=e&&r||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var i=(t=t||{}).random||(t.rng||s)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e)for(var o=0;o<16;++o)e[n+o]=i[o];return e||a(i)}},{84:84,85:85}],87:[function(B,J,r){!function(t,e){void 0!==r&&void 0!==J?J.exports=e():this[t]=e()}("validator",function(h){"use strict";h={version:"4.9.0",coerce:!0};for(var t,l=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~]+$/i,p=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f]))*$/i,d=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+$/i,f=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*$/i,y=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\.\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\.\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF\s]*<(.+)>$/i,a=/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/,u=/^[A-Z]{2}[0-9A-Z]{9}[0-9]$/,s=/^(?:[0-9]{9}X|[0-9]{10})$/,c=/^(?:[0-9]{13})$/,e=/^([0-9a-fA-F][0-9a-fA-F]:){5}([0-9a-fA-F][0-9a-fA-F])$/,g=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,m=/^[0-9A-F]{1,4}$/i,n={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i},r={"en-US":/^[A-Z]+$/i,"de-DE":/^[A-ZÄÖÜß]+$/i,"es-ES":/^[A-ZÁÉÍÑÓÚÜ]+$/i,"fr-FR":/^[A-ZÀÂÆÇÉÈÊËÏÎÔŒÙÛÜŸ]+$/i,"nl-NL":/^[A-ZÉËÏÓÖÜ]+$/i,"pt-PT":/^[A-ZÃÁÀÂÇÉÊÍÕÓÔÚÜ]+$/i,"ru-RU":/^[А-ЯЁа-яё]+$/i},i={"en-US":/^[0-9A-Z]+$/i,"de-DE":/^[0-9A-ZÄÖÜß]+$/i,"es-ES":/^[0-9A-ZÁÉÍÑÓÚÜ]+$/i,"fr-FR":/^[0-9A-ZÀÂÆÇÉÈÊËÏÎÔŒÙÛÜŸ]+$/i,"nl-NL":/^[0-9A-ZÉËÏÓÖÜ]+$/i,"pt-PT":/^[0-9A-ZÃÁÀÂÇÉÊÍÕÓÔÚÜ]+$/i,"ru-RU":/^[0-9А-ЯЁа-яё]+$/i},o=["AU","GB","HK","IN","NZ","ZA","ZM"],b=0;b<o.length;b++)r[t="en-"+o[b]]=r["en-US"],i[t]=i["en-US"];var v=/^[-+]?[0-9]+$/,w=/^(?:[-+]?(?:0|[1-9][0-9]*))$/,O=/^(?:[-+]?(?:[0-9]+))?(?:\.[0-9]*)?(?:[eE][\+\-]?(?:[0-9]+))?$/,T=/^[0-9A-F]+$/i,E=/^[-+]?([0-9]+|\.[0-9]+|[0-9]+\.[0-9]+)$/,S=/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i,C=/^[\x00-\x7F]+$/,A=/[^\x00-\x7F]/,k=/[^\u0020-\u007E\uFF61-\uFF9F\uFFA0-\uFFDC\uFFE8-\uFFEE0-9a-zA-Z]/,_=/[\u0020-\u007E\uFF61-\uFF9F\uFFA0-\uFFDC\uFFE8-\uFFEE0-9a-zA-Z]/,x=/[\uD800-\uDBFF][\uDC00-\uDFFF]/,F=/^(?:[A-Z0-9+\/]{4})*(?:[A-Z0-9+\/]{2}==|[A-Z0-9+\/]{3}=|[A-Z0-9+\/]{4})$/i,R={"en-US":/^(\+?1)?[2-9]\d{2}[2-9](?!11)\d{6}$/,"de-DE":/^(\+?49[ \.\-])?([\(]{1}[0-9]{1,6}[\)])?([0-9 \.\-\/]{3,20})((x|ext|extension)[ ]?[0-9]{1,4})?$/,"el-GR":/^(\+?30)?(69\d{8})$/,"en-AU":/^(\+?61|0)4\d{8}$/,"en-GB":/^(\+?44|0)7\d{9}$/,"en-HK":/^(\+?852\-?)?[569]\d{3}\-?\d{4}$/,"en-IN":/^(\+?91|0)?[789]\d{9}$/,"en-NZ":/^(\+?64|0)2\d{7,9}$/,"en-ZA":/^(\+?27|0)\d{9}$/,"en-ZM":/^(\+?26)?09[567]\d{7}$/,"es-ES":/^(\+?34)?(6\d{1}|7[1234])\d{7}$/,"fi-FI":/^(\+?358|0)\s?(4(0|1|2|4|5)?|50)\s?(\d\s?){4,8}\d$/,"fr-FR":/^(\+?33|0)[67]\d{8}$/,"nb-NO":/^(\+?47)?[49]\d{7}$/,"nn-NO":/^(\+?47)?[49]\d{7}$/,"pt-BR":/^(\+?55|0)\-?[1-9]{2}\-?[2-9]{1}\d{3,4}\-?\d{4}$/,"pt-PT":/^(\+?351)?9[1236]\d{7}$/,"ru-RU":/^(\+?7|8)?9\d{9}$/,"vi-VN":/^(\+?84|0)?((1(2([0-9])|6([2-9])|88|99))|(9((?!5)[0-9])))([0-9]{7})$/,"zh-CN":/^(\+?0?86\-?)?((13\d|14[57]|15[^4,\D]|17[678]|18\d)\d{8}|170[059]\d{7})$/,"zh-TW":/^(\+?886\-?|0)?9\d{8}$/},P=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/;h.extend=function(t,e){h[t]=function(){var t=Array.prototype.slice.call(arguments);return t[0]=h.toString(t[0]),e.apply(h,t)}},h.init=function(){for(var t in h)"function"==typeof h[t]&&"toString"!==t&&"toDate"!==t&&"extend"!==t&&"init"!==t&&"isServerSide"!==t&&h.extend(t,h[t])},h.isServerSide=function(){return"object"==typeof J&&J&&"object"==typeof J.exports&&"object"==typeof process&&"function"==typeof B};var D=null;h.deprecation=function(t){if(null===D){if(!h.isServerSide())return;D=B(83)("validator")}D(t)},h.toString=function(t){if("string"!=typeof t){if(!h.coerce)throw new Error("this library validates strings only");h.deprecation("you tried to validate a "+typeof t+" but this library (validator.js) validates strings only. Please update your code as this will be an error soon.")}return"object"==typeof t&&null!==t?t="function"==typeof t.toString?t.toString():"[object Object]":(null==t||isNaN(t)&&!t.length)&&(t=""),""+t},h.toDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)?t:(t=Date.parse(t),isNaN(t)?null:new Date(t))},h.toFloat=function(t){return parseFloat(t)},h.toInt=function(t,e){return parseInt(t,e||10)},h.toBoolean=function(t,e){return e?"1"===t||"true"===t:"0"!==t&&"false"!==t&&""!==t},h.equals=function(t,e){return t===h.toString(e)},h.contains=function(t,e){return 0<=t.indexOf(h.toString(e))};var N={allow_display_name:!(h.matches=function(t,e,r){return"[object RegExp]"!==Object.prototype.toString.call(e)&&(e=new RegExp(e,r)),e.test(t)}),allow_utf8_local_part:!0,require_tld:!0},M={protocols:["http","https","ftp"],require_tld:!0,require_protocol:!(h.isEmail=function(t,e){var r;!(e=U(e,N)).allow_display_name||(r=t.match(y))&&(t=r[1]);var n=t.split("@"),i=n.pop(),o=n.join("@"),s=i.toLowerCase();if("gmail.com"!==s&&"googlemail.com"!==s||(o=o.replace(/\./g,"").toLowerCase()),!h.isByteLength(o,{max:64})||!h.isByteLength(i,{max:256}))return!1;if(!h.isFQDN(i,{require_tld:e.require_tld}))return!1;if('"'===o[0])return o=o.slice(1,o.length-1),e.allow_utf8_local_part?f.test(o):p.test(o);for(var a=e.allow_utf8_local_part?d:l,u=o.split("."),c=0;c<u.length;c++)if(!a.test(u[c]))return!1;return!0}),require_valid_protocol:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_protocol_relative_urls:!1};h.isURL=function(t,e){if(!t||2083<=t.length||/\s/.test(t))return!1;if(0===t.indexOf("mailto:"))return!1;var r,n,i,o,s,a;if(e=U(e,M),1<(a=t.split("://")).length){if(r=a.shift(),e.require_valid_protocol&&-1===e.protocols.indexOf(r))return!1}else{if(e.require_protocol)return!1;e.allow_protocol_relative_urls&&"//"===t.substr(0,2)&&(a[0]=t.substr(2))}return!(1<(a=(t=(a=(t=(a=(t=(a=(t=a.join("://")).split("#")).shift()).split("?")).shift()).split("/")).shift()).split("@")).length&&0<=(n=a.shift()).indexOf(":")&&2<n.split(":").length)&&(i=(a=a.join("@").split(":")).shift(),!(a.length&&(s=a.join(":"),o=parseInt(s,10),!/^[0-9]+$/.test(s)||o<=0||65535<o))&&(!(!h.isIP(i)&&!h.isFQDN(i,e)&&"localhost"!==i)&&((!e.host_whitelist||-1!==e.host_whitelist.indexOf(i))&&(!e.host_blacklist||-1===e.host_blacklist.indexOf(i)))))},h.isMACAddress=function(t){return e.test(t)};var I={require_tld:!0,allow_underscores:!(h.isIP=function(t,e){if(!(e=e?e+"":""))return h.isIP(t,4)||h.isIP(t,6);if("4"===e)return!!g.test(t)&&t.split(".").sort(function(t,e){return t-e})[3]<=255;if("6"!==e)return!1;var r=t.split(":"),n=!1,i=h.isIP(r[r.length-1],4),o=i?7:8;if(r.length>o)return!1;if("::"===t)return!0;"::"===t.substr(0,2)?(r.shift(),r.shift(),n=!0):"::"===t.substr(t.length-2)&&(r.pop(),r.pop(),n=!0);for(var s=0;s<r.length;++s)if(""===r[s]&&0<s&&s<r.length-1){if(n)return!1;n=!0}else if(!(i&&s==r.length-1||m.test(r[s])))return!1;return n?1<=r.length:r.length===o}),allow_trailing_dot:!1};h.isFQDN=function(t,e){(e=U(e,I)).allow_trailing_dot&&"."===t[t.length-1]&&(t=t.substring(0,t.length-1));var r=t.split(".");if(e.require_tld){var n=r.pop();if(!r.length||!/^([a-z\u00a1-\uffff]{2,}|xn[a-z0-9-]{2,})$/i.test(n))return!1}for(var i,o=0;o<r.length;o++){if(i=r[o],e.allow_underscores){if(0<=i.indexOf("__"))return!1;i=i.replace(/_/g,"")}if(!/^[a-z\u00a1-\uffff0-9-]+$/i.test(i))return!1;if(/[\uff01-\uff5e]/.test(i))return!1;if("-"===i[0]||"-"===i[i.length-1])return!1}return!0},h.isBoolean=function(t){return 0<=["true","false","1","0"].indexOf(t)},h.isAlpha=function(t,e){if((e=e||"en-US")in r)return r[e].test(t);throw new Error("Invalid locale '"+e+"'")},h.isAlphanumeric=function(t,e){if((e=e||"en-US")in i)return i[e].test(t);throw new Error("Invalid locale '"+e+"'")},h.isNumeric=function(t){return v.test(t)},h.isDecimal=function(t){return""!==t&&E.test(t)},h.isHexadecimal=function(t){return T.test(t)},h.isHexColor=function(t){return S.test(t)},h.isLowercase=function(t){return t===t.toLowerCase()},h.isUppercase=function(t){return t===t.toUpperCase()},h.isInt=function(t,e){return e=e||{},w.test(t)&&(!e.hasOwnProperty("min")||t>=e.min)&&(!e.hasOwnProperty("max")||t<=e.max)},h.isFloat=function(t,e){return e=e||{},""!==t&&"."!==t&&(O.test(t)&&(!e.hasOwnProperty("min")||t>=e.min)&&(!e.hasOwnProperty("max")||t<=e.max))},h.isDivisibleBy=function(t,e){return h.toFloat(t)%parseInt(e,10)==0},h.isNull=function(t){return 0===t.length},h.isLength=function(t,e){var r,n="object"==typeof e?(r=e.min||0,e.max):(r=e,arguments[2]),i=t.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g)||[],o=t.length-i.length;return r<=o&&(void 0===n||o<=n)},h.isByteLength=function(t,e){var r,n="object"==typeof e?(r=e.min||0,e.max):(r=e,arguments[2]),i=encodeURI(t).split(/%..|./).length-1;return r<=i&&(void 0===n||i<=n)},h.isUUID=function(t,e){var r=n[e||"all"];return r&&r.test(t)},h.isDate=function(t){var e=new Date(Date.parse(t));if(isNaN(e))return!1;var r,n=function(t){var e,r,n,i,o=t.match(P);if(o){if(!(e=o[21]))return o[12]?null:0;if("z"===e||"Z"===e)return 0;r=o[22],i=-1!==e.indexOf(":")?(n=parseInt(o[23]),parseInt(o[24])):(n=0,parseInt(o[23]))}else{if(!(e=(t=t.toLowerCase()).match(/(?:\s|gmt\s*)(-|\+)(\d{1,4})(\s|$)/)))return-1!==t.indexOf("gmt")?0:null;r=e[1];var s=e[2];3===s.length&&(s="0"+s),i=s.length<=2?(n=0,parseInt(s)):(n=parseInt(s.slice(0,2)),parseInt(s.slice(2,4)))}return(60*n+i)*("-"===r?1:-1)}(t);null!==n&&(r=e.getTimezoneOffset()-n,e=new Date(e.getTime()+6e4*r));var i,o,s=String(e.getDate()),a=t.match(/(^|[^:\d])[23]\d([^:\d]|$)/g);return!a||(i=a.map(function(t){return t.match(/\d+/g)[0]}).join("/"),o=String(e.getFullYear()).slice(-2),i===s||i===o||(i===s+"/"+o||i===o+"/"+s))},h.isAfter=function(t,e){var r=h.toDate(e||new Date),n=h.toDate(t);return!!(n&&r&&r<n)},h.isBefore=function(t,e){var r=h.toDate(e||new Date),n=h.toDate(t);return!!(n&&r&&n<r)},h.isIn=function(t,e){var r;if("[object Array]"!==Object.prototype.toString.call(e))return"object"==typeof e?e.hasOwnProperty(t):!(!e||"function"!=typeof e.indexOf)&&0<=e.indexOf(t);var n=[];for(r in e)n[r]=h.toString(e[r]);return 0<=n.indexOf(t)},h.isWhitelisted=function(t,e){for(var r=t.length-1;0<=r;r--)if(-1===e.indexOf(t[r]))return!1;return!0},h.isCreditCard=function(t){var e=t.replace(/[^0-9]+/g,"");if(!a.test(e))return!1;for(var r,n,i,o=0,s=e.length-1;0<=s;s--)r=e.substring(s,s+1),n=parseInt(r,10),o+=i&&10<=(n*=2)?n%10+1:n,i=!i;return!(o%10!=0||!e)},h.isISIN=function(t){if(!u.test(t))return!1;for(var e,r,n=t.replace(/[A-Z]/g,function(t){return parseInt(t,36)}),i=0,o=!0,s=n.length-2;0<=s;s--)e=n.substring(s,s+1),r=parseInt(e,10),i+=o&&10<=(r*=2)?r+1:r,o=!o;return parseInt(t.substr(t.length-1),10)===(1e4-i)%10},h.isISBN=function(t,e){if(!(e=e?e+"":""))return h.isISBN(t,10)||h.isISBN(t,13);var r=t.replace(/[\s-]+/g,""),n=0;if("10"===e){if(!s.test(r))return!1;for(o=0;o<9;o++)n+=(o+1)*r.charAt(o);if("X"===r.charAt(9)?n+=100:n+=10*r.charAt(9),n%11==0)return!!r}else if("13"===e){if(!c.test(r))return!1;for(var i=[1,3],o=0;o<12;o++)n+=i[o%2]*r.charAt(o);if(r.charAt(12)-(10-n%10)%10==0)return!!r}return!1};var j={symbol:"$",require_symbol:!(h.isMobilePhone=function(t,e){return e in R&&R[e].test(t)}),allow_space_after_symbol:!1,symbol_after_digits:!1,allow_negatives:!0,parens_for_negatives:!1,negative_sign_before_digits:!1,negative_sign_after_digits:!1,allow_negative_sign_placeholder:!1,thousands_separator:",",decimal_separator:".",allow_space_after_digits:!1};h.isCurrency=function(t,e){return function(t){var e="(\\"+t.symbol.replace(/\./g,"\\.")+")"+(t.require_symbol?"":"?"),r="[1-9]\\d{0,2}(\\"+t.thousands_separator+"\\d{3})*",n="("+["0","[1-9]\\d*",r].join("|")+")?",i="(\\"+t.decimal_separator+"\\d{2})?",o=n+i;t.allow_negatives&&!t.parens_for_negatives&&(t.negative_sign_after_digits?o+="-?":t.negative_sign_before_digits&&(o="-?"+o));t.allow_negative_sign_placeholder?o="( (?!\\-))?"+o:t.allow_space_after_symbol?o=" ?"+o:t.allow_space_after_digits&&(o+="( (?!$))?");t.symbol_after_digits?o+=e:o=e+o;t.allow_negatives&&(t.parens_for_negatives?o="(\\("+o+"\\)|"+o+")":t.negative_sign_before_digits||t.negative_sign_after_digits||(o="-?"+o));return new RegExp("^(?!-? )(?=.*\\d)"+o+"$")}(e=U(e,j)).test(t)},h.isJSON=function(t){try{var e=JSON.parse(t);return!!e&&"object"==typeof e}catch(t){}return!1},h.isMultibyte=function(t){return A.test(t)},h.isAscii=function(t){return C.test(t)},h.isFullWidth=function(t){return k.test(t)},h.isHalfWidth=function(t){return _.test(t)},h.isVariableWidth=function(t){return k.test(t)&&_.test(t)},h.isSurrogatePair=function(t){return x.test(t)},h.isBase64=function(t){return F.test(t)},h.isMongoId=function(t){return h.isHexadecimal(t)&&24===t.length},h.isISO8601=function(t){return P.test(t)},h.ltrim=function(t,e){var r=e?new RegExp("^["+e+"]+","g"):/^\s+/g;return t.replace(r,"")},h.rtrim=function(t,e){var r=e?new RegExp("["+e+"]+$","g"):/\s+$/g;return t.replace(r,"")},h.trim=function(t,e){var r=e?new RegExp("^["+e+"]+|["+e+"]+$","g"):/^\s+|\s+$/g;return t.replace(r,"")},h.escape=function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#x2F;").replace(/\`/g,"&#96;")},h.stripLow=function(t,e){var r=e?"\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F":"\\x00-\\x1F\\x7F";return h.blacklist(t,r)},h.whitelist=function(t,e){return t.replace(new RegExp("[^"+e+"]+","g"),"")},h.blacklist=function(t,e){return t.replace(new RegExp("["+e+"]+","g"),"")};var L={lowercase:!0,remove_dots:!0,remove_extension:!0};function U(t,e){for(var r in t=t||{},e)void 0===t[r]&&(t[r]=e[r]);return t}return h.normalizeEmail=function(t,e){if(e=U(e,L),!h.isEmail(t))return!1;var r=t.split("@",2);if(r[1]=r[1].toLowerCase(),"gmail.com"===r[1]||"googlemail.com"===r[1]){if(e.remove_extension&&(r[0]=r[0].split("+")[0]),e.remove_dots&&(r[0]=r[0].replace(/\./g,"")),!r[0].length)return!1;r[0]=r[0].toLowerCase(),r[1]="gmail.com"}else e.lowercase&&(r[0]=r[0].toLowerCase());return r.join("@")},h.init(),h})},{83:83}]},{},[5])(5)});