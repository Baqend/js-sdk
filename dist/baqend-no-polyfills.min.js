/*! baqend 2.13.0 | Copyright (c) 2015 Baqend GmbH | MIT */

!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.DB=a()}}(function(){var a,b={};return b.typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},b.classCallCheck=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},b.createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),b.defaults=function(a,b){for(var c=Object.getOwnPropertyNames(b),d=0;d<c.length;d++){var e=c[d],f=Object.getOwnPropertyDescriptor(b,e);f&&f.configurable&&void 0===a[e]&&Object.defineProperty(a,e,f)}return a},b.inherits=function(a,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):b.defaults(a,c))},b.possibleConstructorReturn=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b},function(){function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){return e(b[g][1][a]||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}return a}()({1:[function(a,c,d){"use strict";var e=a(67),f=function(){function a(c){b.classCallCheck(this,a),this.read=new e(c),this.write=new e(c)}return a.prototype.clear=function(){this.read.clear(),this.write.clear()},a.prototype.copy=function(a){return this.read.copy(a.read),this.write.copy(a.write),this},a.prototype.isPublicReadAllowed=function(){return this.read.isPublicAllowed()},a.prototype.setPublicReadAllowed=function(){return this.read.setPublicAllowed()},a.prototype.isReadAllowed=function(a){return this.read.isAllowed(a)},a.prototype.isReadDenied=function(a){return this.read.isDenied(a)},a.prototype.allowReadAccess=function(){return e.prototype.allowAccess.apply(this.read,arguments),this},a.prototype.denyReadAccess=function(){return e.prototype.denyAccess.apply(this.read,arguments),this},a.prototype.deleteReadAccess=function(){return e.prototype.deleteAccess.apply(this.read,arguments),this},a.prototype.isPublicWriteAllowed=function(){return this.write.isPublicAllowed()},a.prototype.setPublicWriteAllowed=function(){return this.write.setPublicAllowed()},a.prototype.isWriteAllowed=function(a){return this.write.isAllowed(a)},a.prototype.isWriteDenied=function(a){return this.write.isDenied(a)},a.prototype.allowWriteAccess=function(){return e.prototype.allowAccess.apply(this.write,arguments),this},a.prototype.denyWriteAccess=function(){return e.prototype.denyAccess.apply(this.write,arguments),this},a.prototype.deleteWriteAccess=function(){return e.prototype.deleteAccess.apply(this.write,arguments),this},a.prototype.toJSON=function(){return{read:this.read.toJSON(),write:this.write.toJSON()}},a.prototype.fromJSON=function(a){this.read.fromJSON(a.read||{}),this.write.fromJSON(a.write||{})},a}();c.exports=f},{67:67}],2:[function(a,c,d){"use strict";var e=a(34),f=a(33),g=a(19),h=a(75),i=a(61),j=a(18),k=a(65),l=a(25),m=a(21),n=a(73),o=l.StatusCode,p=function(a){function c(d){b.classCallCheck(this,c);var e=b.possibleConstructorReturn(this,a.call(this));return e.log=h.Logger.create(e),e.connection=null,e.entities=null,e.entityManagerFactory=d,e.metamodel=d.metamodel,e.code=d.code,e.modules=null,e.me=null,e.deviceMe=null,e.tokenStorage=null,e.bloomFilter=null,e.cacheWhiteList=null,e.cacheBlackList=null,e.bloomFilterRefresh=60,e.bloomFilterLock=new h.Lockable,e}return b.inherits(c,a),b.createClass(c,[{key:"isOpen",get:function(){return!!this.connection}},{key:"token",get:function(){return this.tokenStorage.token},set:function(a){this.tokenStorage.update(a)}},{key:"isCachingDisabled",get:function(){return!this.bloomFilter}},{key:"isDeviceRegistered",get:function(){return!!this.deviceMe}}]),c.prototype.connected=function(a,b,c){this.connection=a,this.tokenStorage=c,this.bloomFilterRefresh=this.entityManagerFactory.staleness,this.entities={},this.File=g.FileFactory.create(this),this._createObjectFactory(this.metamodel.embeddables),this._createObjectFactory(this.metamodel.entities),this.transaction={},this.modules=new h.Modules(this,a),b&&(b.device&&this.updateDevice(b.device),b.user&&c.token&&this._updateUser(b.user,!0),this.bloomFilterRefresh>0&&b.bloomFilter&&h.atob&&!h.isNode&&this.updateBloomFilter(b.bloomFilter))},c.prototype._createObjectFactory=function(a){var b=this;Object.keys(a).forEach(function(a){var c=b.metamodel.managedType(a),d=c.name;b[d]?(c.typeConstructor=b[d],Object.defineProperty(b,d,{value:c.createObjectFactory(b)})):Object.defineProperty(b,d,{get:function(){return Object.defineProperty(this,d,{value:c.createObjectFactory(this)}),this[d]},set:function(a){c.typeConstructor=a},configurable:!0})},this)},c.prototype.send=function(a,b){var c=this,d=a;d.tokenStorage=this.tokenStorage;var e=this.connection.send(d);return b||(e=e.catch(function(a){throw a.status===o.BAD_CREDENTIALS&&c._logout(),a})),e},c.prototype.getReference=function(a,b){var c=void 0,d=void 0;if(b){var e=b;d=this.metamodel.entity(a),c=0===e.indexOf("/db/")?e:d.ref+"/"+encodeURIComponent(e)}else if("string"==typeof a){var f=a.indexOf("/","/db/".length);-1!==f&&(c=a),d=this.metamodel.entity(-1===f?a:c.substring(0,f))}else d=this.metamodel.entity(a);var g=this.entities[c];if(!g){g=d.create();var h=k.get(g);c&&(h.id=c),h.setUnavailable(),this._attach(g)}return g},c.prototype.createQueryBuilder=function(a){return new i.Builder(this,a)},c.prototype.clear=function(){this.entities={}},c.prototype.close=function(){return this.connection=null,this.clear()},c.prototype.contains=function(a){return!!a&&this.entities[a.id]===a},c.prototype.containsById=function(a){return!(!a||!this.entities[a.id])},c.prototype.detach=function(a){var b=this;return k.get(a).withLock(function(){return b.removeReference(a),Promise.resolve(a)})},c.prototype.resolveDepth=function(a,b){var c=this;if(!b||!b.depth)return Promise.resolve(a);b.resolved=b.resolved||[];var d=[],e=Object.assign({},b,{depth:!0===b.depth||b.depth-1});return this.getSubEntities(a,1).forEach(function(a){null!==a&&-1===b.resolved.indexOf(a)&&(b.resolved.push(a),d.push(c.load(a.id,null,e)))}),Promise.all(d).then(function(){return a})},c.prototype.load=function(a,b,c){var d=this,f=c||{},g=this.getReference(a,b),h=k.get(g);if(!f.refresh&&f.local&&h.isAvailable)return this.resolveDepth(g,f);var i=new e.GetObject(h.bucket,h.key);return this.ensureCacheHeader(g.id,i,f.refresh),this.send(i).then(function(c){return g.version>c.entity.version?(f.refresh=!0,d.load(a,b,f)):(d.addToWhiteList(c.entity.id),c.status!==o.NOT_MODIFIED&&h.setJson(c.entity,{persisting:!0}),d.resolveDepth(g,f))},function(a){if(a.status===o.OBJECT_NOT_FOUND)return d.removeReference(g),h.setRemoved(),null;throw a})},c.prototype.insert=function(a,b){var c=this,d=b||{},g=void 0;return this._save(a,d,function(a,b){if(a.version)throw new f.PersistentError("Existing objects can't be inserted.");return g=!a.id,new e.CreateObject(a.bucket,b)}).then(function(b){return g&&c._attach(a),b})},c.prototype.update=function(a,b){var c=b||{};return this._save(a,c,function(a,b){if(!a.version)throw new f.PersistentError("New objects can't be inserted.");return c.force?(delete b.version,new e.ReplaceObject(a.bucket,a.key,b).ifMatch("*")):new e.ReplaceObject(a.bucket,a.key,b).ifMatch(a.version)})},c.prototype.save=function(a,b,c){var d=b||{},g=function(a,b){if(d.force){if(!a.id)throw new f.PersistentError("New special objects can't be forcedly saved.");return delete b.version,new e.ReplaceObject(a.bucket,a.key,b)}return a.version?new e.ReplaceObject(a.bucket,a.key,b).ifMatch(a.version):new e.CreateObject(a.bucket,b)};return c?this._locklessSave(a,d,g):this._save(a,d,g)},c.prototype.optimisticSave=function(a,b){var c=this;return k.get(a).withLock(function(){return c._optimisticSave(a,b)})},c.prototype._optimisticSave=function(a,b){var c=this,d=!1,e=function(){d=!0},f=Promise.resolve(b(a,e));return d?Promise.resolve(a):f.then(function(){return c.save(a,{},!0).catch(function(d){if(412===d.status)return c.refresh(a,{}).then(function(){return c._optimisticSave(a,b)});throw d})})},c.prototype._locklessSave=function(a,b,c){var d=this;this.attach(a);var e=k.get(a),f=void 0,g=void 0;if(e.isAvailable&&(g=e.getJson({persisting:!0})),e.isDirty){b.refresh||e.setPersistent();var h=this.send(c(e,g)).then(function(c){return e.id&&e.id!==c.entity.id&&(d.removeReference(a),e.id=c.entity.id,d._attach(a)),e.setJson(c.entity,{persisting:b.refresh,onlyMetadata:!b.refresh}),a},function(b){if(b.status===o.OBJECT_NOT_FOUND)return d.removeReference(a),e.setRemoved(),null;throw e.setDirty(),b});f=[h]}else f=[Promise.resolve(a)];var i=Object.assign({},b);return i.depth=0,this.getSubEntities(a,b.depth).forEach(function(a){f.push(d._save(a,i,c))}),Promise.all(f).then(function(){return a})},c.prototype._save=function(a,b,c){var d=this;this.ensureBloomFilterFreshness();var e=k.get(a);return e.version&&this.addToBlackList(a.id),e.withLock(function(){return d._locklessSave(a,b,c)})},c.prototype.getSubEntities=function(a,b,c,d){var e=c||[];if(!b)return e;for(var f=d||a,g=k.get(a),h=g.type.references(),i=h.next();!i.done;i=h.next())for(var j=i.value,l=this.getSubEntitiesByPath(a,j.path),m=0,n=l.length;m<n;m+=1){var o=l[m];-1===e.indexOf(o)&&o!==f&&(e.push(o),e=this.getSubEntities(o,!0===b?b:b-1,e,f))}return e},c.prototype.getSubEntitiesByPath=function(a,b){var c=this,d=[a];return b.forEach(function(a){var b=[];d.forEach(function(d){var e=d[a];if(e){var f=c.metamodel.managedType(d.constructor).getAttribute(a);if(f.isCollection)for(var g=e.entries(),h=g.next();!h.done;h=g.next()){var i=h.value;b.push(i[1]),f.keyType&&f.keyType.isEntity&&b.push(i[0])}else b.push(e)}}),d=b}),d},c.prototype.delete=function(a,b){var c=this,d=b||{};this.attach(a);var g=k.get(a);return g.withLock(function(){if(!g.version&&!d.force)throw new f.IllegalEntityError(a);var b=new e.DeleteObject(g.bucket,g.key);c.addToBlackList(a.id),d.force||b.ifMatch(g.version);var h=[c.send(b).then(function(){return c.removeReference(a),g.setRemoved(),a})],i=Object.assign({},d);return i.depth=0,c.getSubEntities(a,d.depth).forEach(function(a){h.push(c.delete(a,i))}),Promise.all(h).then(function(){return a})})},c.prototype.flush=function(){},c.prototype.persist=function(a){this.attach(a)},c.prototype.refresh=function(a,b){var c=b||{};return c.refresh=!0,this.load(a.id,null,c)},c.prototype.attach=function(a){if(!this.contains(a)){if(!this.metamodel.entity(a.constructor))throw new f.IllegalEntityError(a);if(this.containsById(a))throw new f.EntityExistsError(a);this._attach(a)}},c.prototype._attach=function(a){var b=k.get(a);if(b.isAttached){if(b.db!==this)throw new f.EntityExistsError(a)}else b.db=this;b.id||"User"!==b.type.name&&"Role"!==b.type.name&&"logs.AppLog"!==b.type.name&&(b.id="/db/"+b.type.name+"/"+h.uuid()),b.id&&(this.entities[b.id]=a)},c.prototype.removeReference=function(a){var b=k.get(a);if(!b)throw new f.IllegalEntityError(a);delete this.entities[b.id]},c.prototype.register=function(a,b,c){var d=this,g=c>j.LoginOption.NO_LOGIN;if(this.me&&g)throw new f.PersistentError("User is already logged in.");return this.withLock(function(){var f=new e.Register({user:a,password:b,login:g});return d._userRequest(f,c)})},c.prototype.login=function(a,b,c){var d=this;if(this.me)throw new f.PersistentError("User is already logged in.");return this.withLock(function(){var f=new e.Login({username:a,password:b});return d._userRequest(f,c)})},c.prototype.logout=function(){var a=this;return this.withLock(function(){return a.send(new e.Logout).then(a._logout.bind(a))})},c.prototype.loginWithOAuth=function(a,b,c){if(this.me)throw new f.PersistentError("User is already logged in.");var d=Object.assign({title:"Login with "+a,timeout:3e5,state:{},loginOption:!0},c);d.redirect&&Object.assign(d.state,{redirect:d.redirect,loginOption:d.loginOption});var e=void 0;if(!l[a+"OAuth"])throw new Error("OAuth provider "+a+" not supported.");e=new l[a+"OAuth"](b,d.scope,JSON.stringify(d.state)),e.addRedirectOrigin(this.connection.origin+this.connection.basePath);var g={width:d.width,height:d.height};if(d.redirect){var h=-1!==document.URL.indexOf("http://")||-1!==document.URL.indexOf("https://");return this.openOAuthWindow(e.request.path,h?"_self":"_system",g),new Promise(function(){})}var i=this._userRequest(e,d.loginOption);return this.openOAuthWindow(e.request.path,d.title,g),new Promise(function(a,b){var c=setTimeout(function(){b(new f.PersistentError("OAuth login timeout."))},d.timeout);i.then(a,b).then(function(){clearTimeout(c)})})},c.prototype.openOAuthWindow=function(a,b,c){var d=Object.keys(c).filter(function(a){return void 0!==c[a]}).map(function(a){return a+"="+c[a]}).join(",");open(a,b,d)},c.prototype.renew=function(a){var b=this;return this.withLock(function(){var c=new e.Me;return b._userRequest(c,a)})},c.prototype.newPassword=function(a,b,c){var d=this;return this.withLock(function(){var f=new e.NewPassword({username:a,password:b,newPassword:c});return d.send(f,!0).then(function(a){return d._updateUser(a.entity)})})},c.prototype.newPasswordWithToken=function(a,b,c){var d=this;return this.withLock(function(){return d._userRequest(new e.NewPassword({token:a,newPassword:b}),c)})},c.prototype.resetPassword=function(a){return this.send(new e.ResetPassword({username:a}))},c.prototype.changeUsername=function(a,b,c){return this.send(new e.ChangeUsername({username:a,newUsername:b,password:c}))},c.prototype._updateUser=function(a,b){var c=this.getReference(a.id);return k.get(c).setJson(a,{persisting:!0}),b&&(this.me=c),c},c.prototype._logout=function(){this.me=null,this.token=null},c.prototype._userRequest=function(a,b){var c=this,d=void 0===b||b,e=d>j.LoginOption.NO_LOGIN;return e&&(this.tokenStorage.temporary=d<j.LoginOption.PERSIST_LOGIN),this.send(a,!e).then(function(a){return a.entity?c._updateUser(a.entity,e):null},function(a){if(a.status===o.OBJECT_NOT_FOUND)return e&&c._logout(),null;throw a})},c.prototype.registerDevice=function(a,b,c){var d=this,f=new e.DeviceRegister({devicetype:a,subscription:b,device:c});return f.withCredentials=!0,this.send(f).then(function(a){return d.updateDevice(a.entity)})},c.prototype.updateDevice=function(a){var b=this.getReference(a.id);return k.get(b).setJson(a,{persisting:!0}),this.deviceMe=b,b},c.prototype.checkDeviceRegistration=function(){var a=this;return this.send(new e.DeviceRegistered).then(function(){return a.isDeviceRegistered=!0,!0},function(b){if(b.status===o.OBJECT_NOT_FOUND)return a.isDeviceRegistered=!1,!1;throw b})},c.prototype.pushDevice=function(a){return this.send(new e.DevicePush(a))},c.prototype.validate=function(a){for(var b=k.get(a).type,c=new h.ValidationResult,d=b.attributes(),e=d.next();!e.done;e=d.next()){var f=new h.Validator(e.value.name,a);c.fields[f.key]=f}var g=b.validationCode;return g&&g(c.fields),c},c.prototype.addToWhiteList=function(a){this.isCachingDisabled||(this.bloomFilter.contains(a)&&this.cacheWhiteList.add(a),this.cacheBlackList.delete(a))},c.prototype.addToBlackList=function(a){this.isCachingDisabled||(this.bloomFilter.contains(a)||this.cacheBlackList.add(a),this.cacheWhiteList.delete(a))},c.prototype.refreshBloomFilter=function(){var a=this;if(this.isCachingDisabled)return Promise.resolve();var b=new e.GetBloomFilter;return b.noCache(),this.send(b).then(function(b){return a.updateBloomFilter(b.entity),a.bloomFilter})},c.prototype.updateBloomFilter=function(a){this.bloomFilter=new m(a),this.cacheWhiteList=new Set,this.cacheBlackList=new Set},c.prototype.ensureBloomFilterFreshness=function(){var a=this;if(!this.isCachingDisabled){var b=(new Date).getTime(),c=1e3*this.bloomFilterRefresh;this.bloomFilterLock.isReady&&b-this.bloomFilter.creation>c&&this.bloomFilterLock.withLock(function(){return a.refreshBloomFilter()})}},c.prototype.mustRevalidate=function(a){if(h.isNode)return!1;this.ensureBloomFilterFreshness();var b=this.isCachingDisabled||!this.bloomFilterLock.isReady;return b=b||!this.cacheWhiteList.has(a)&&(this.cacheBlackList.has(a)||this.bloomFilter.contains(a))},c.prototype.ensureCacheHeader=function(a,b,c){(c||this.mustRevalidate(a))&&b.noCache()},c.prototype.createURL=function(a,b){var c=this.connection.basePath+a,d=!1;return b&&this.me?(c=this.tokenStorage.signPath(c),d=!0):c=c.split("/").map(encodeURIComponent).join("/"),this.mustRevalidate(a)&&(c=c+(d?"&":"?")+"BCB"),this.connection.origin+c},c.prototype.requestAPIToken=function(a,b){var c=this._getUserReference(a,b),d=new e.UserToken(c.key);return this.send(d).then(function(a){return a.entity})},c.prototype.revokeAllTokens=function(a,b){var c=this._getUserReference(a,b),d=new e.RevokeUserToken(c.key);return this.send(d)},c.prototype._getUserReference=function(a,b){return"string"==typeof b?this.getReference(a,b):b},c}(h.Lockable);p.prototype.List=Array,p.prototype.Set=Set,p.prototype.Map=Map,p.prototype.GeoPoint=a(4),n(p.prototype,"_connector","connection"),n(p.prototype,"_entities","entities"),n(p.prototype,"_bloomFilterLock","bloomFilterLock"),c.exports=p},{18:18,19:19,21:21,25:25,33:33,34:34,4:4,61:61,65:65,73:73,75:75}],3:[function(a,c,d){"use strict";var e=a(34),f=a(50),g=a(75),h=a(73),i=a(23),j=a(2),k=Symbol("Connected"),l=function(a){function c(d){b.classCallCheck(this,c);var f=b.possibleConstructorReturn(this,a.call(this)),h=Object(d)instanceof String?{host:d}:d||{};f.connection=null,f.metamodel=f.createMetamodel(),f.code=new g.Code(f.metamodel,f),f.tokenStorageFactory=g.TokenStorage.WEB_STORAGE||g.TokenStorage.GLOBAL,f.configure(h);var i=!0,j=new Promise(function(a){f[k]=a});return h.host?f.connect(h.host,h.port,h.secure,h.basePath):i=!1,f.tokenStorage||(i=!1,j=j.then(function(){return f.tokenStorageFactory.create(f.connection.origin)}).then(function(a){f.tokenStorage=a})),h.schema?(f.connectData=h,f.metamodel.init(h.schema)):(i=!1,j=j.then(function(){var a=new e.Connect;return a.withCredentials=!0,0===f.staleness&&a.noCache(),f.send(a)}).then(function(a){f.connectData=a.entity,void 0===f.staleness&&(f.staleness=f.connectData.bloomFilterRefresh||60),f.metamodel.isInitialized||f.metamodel.init(f.connectData.schema),f.tokenStorage.update(f.connectData.token)})),i||f.withLock(function(){return j},!0),f}return b.inherits(c,a),c.prototype.configure=function(a){if(this.connection)throw new Error("The EntityManagerFactory can only be configured before is is connected.");a.tokenStorage&&(this.tokenStorage=a.tokenStorage),a.tokenStorageFactory&&(this.tokenStorageFactory=a.tokenStorageFactory),void 0!==a.staleness&&(this.staleness=a.staleness)},c.prototype.connect=function(a,b,c,d){if(this.connection)throw new Error("The EntityManagerFactory is already connected.");return Object(b)instanceof Boolean?this.connect(a,0,b,c):(this.connection=i.create(a,b,c,d),this[k](),this.ready())},c.prototype.createMetamodel=function(){return new f.Metamodel(this)},c.prototype.createEntityManager=function(a){var b=this,c=new j(this);return this.isReady?c.connected(this.connection,this.connectData,a?this.tokenStorage:new g.TokenStorage(this.connection.origin)):c.withLock(function(){return b.ready().then(function(){c.connected(b.connection,b.connectData,a?b.tokenStorage:new g.TokenStorage(b.connection.origin))})},!0),c},c.prototype.send=function(a){return a.tokenStorage||(a.tokenStorage=this.tokenStorage),this.connection.send(a)},c}(g.Lockable);h(l.prototype,"_connector","connection"),h(l.prototype,"_connected",k),c.exports=l},{2:2,23:23,34:34,50:50,73:73,75:75}],4:[function(a,c,d){"use strict";var e=function(){function a(c,d){b.classCallCheck(this,a);var e=void 0,f=void 0;if(Object(c)instanceof String){var g=c.indexOf(";");e=c.substring(0,g),f=c.substring(g+1)}else Object(c)instanceof Number?(e=c,f=d):Object(c)instanceof Array?(e=c[0],f=c[1]):c instanceof Object?(e=c.latitude,f=c.longitude):(e=0,f=0);if(this.longitude=f,this.latitude=e,this.latitude<-90||this.latitude>90)throw new Error("Latitude "+this.latitude+" is not in bound of -90 <= latitude <= 90");if(this.longitude<-180||this.longitude>180)throw new Error("Longitude "+this.longitude+" is not in bound of -180 <= longitude <= 180")}return a.current=function(){return new Promise(function(b,c){navigator||c(new Error("This seems not to be a browser context.")),navigator.geolocation||c(new Error("This browser does not support geolocation.")),navigator.geolocation.getCurrentPosition(function(c){b(new a(c.coords.latitude,c.coords.longitude))},function(a){c(a)})})},a.prototype.kilometersTo=function(b){return Number((a.EARTH_RADIUS_IN_KILOMETERS*this.radiansTo(b)).toFixed(3))},a.prototype.milesTo=function(b){return Number((a.EARTH_RADIUS_IN_MILES*this.radiansTo(b)).toFixed(3))},a.prototype.radiansTo=function(b){var c=this,d=b,e=c.latitude*a.DEG_TO_RAD,f=d.latitude*a.DEG_TO_RAD,g=(d.longitude-c.longitude)*a.DEG_TO_RAD;return Math.acos(Math.sin(e)*Math.sin(f)+Math.cos(e)*Math.cos(f)*Math.cos(g))},a.prototype.toString=function(){return this.latitude+";"+this.longitude},a.prototype.toJSON=function(){return{latitude:this.latitude,longitude:this.longitude}},a}();e.DEG_TO_RAD=Math.PI/180,e.EARTH_RADIUS_IN_KILOMETERS=6371,e.EARTH_RADIUS_IN_MILES=3956,c.exports=e},{}],5:[function(a,b,c){"use strict";var d=a(3),e=a(2);e.prototype.binding=a(19),e.prototype.connector=a(27),e.prototype.error=a(33),e.prototype.message=a(34),e.prototype.metamodel=a(50),e.prototype.util=a(75),e.prototype.caching=a(22),e.prototype.query=a(61),e.prototype.partialupdate=a(54),e.prototype.EntityManager=a(2),e.prototype.EntityManagerFactory=a(3),e.prototype.Acl=a(1);var f=new d,g=f.createEntityManager(!0);g.configure=function(a){return f.configure(a),this},g.connect=function(a,b,c,d){return b instanceof Function?this.connect(a,void 0,b,c):(f.connect(a,b),this.ready(c,d))},c=g,c.db=g,c.default=g,b.exports=c},{1:1,19:19,2:2,22:22,27:27,3:3,33:33,34:34,50:50,54:54,61:61,75:75}],6:[function(a,c,d){"use strict";var e=function(){function a(){b.classCallCheck(this,a)}return a.prototype.getValue=function(a,b){return a[b.name]},a.prototype.setValue=function(a,b,c){a[b.name]=c},a}();c.exports=e},{}],7:[function(a,b,c){"use strict";var d=a(10),e=a(34),f=d.extend({get me(){return this.db.deviceMe},get isRegistered(){return this.db.isDeviceRegistered},loadWebPushKey:function(){var a=new e.VAPIDPublicKey;return a.responseType("arraybuffer"),this.db.send(a).then(function(a){return a.entity})},register:function(a,b,c,d,e){if(c instanceof Function)return this.register(a,b,null,c,d);var f="string"==typeof b?{token:b}:b;return this.db.registerDevice(a,f,c).then(d,e)},push:function(a,b,c){return this.db.pushDevice(a).then(b,c)}});f.PushMessage=a(68),b.exports=f},{10:10,34:34,68:68}],8:[function(a,c,d){"use strict";var e=Symbol("BaqendId"),f=Symbol("BaqendType"),g=function(){function a(){b.classCallCheck(this,a)}return a.prototype.createProxy=function(a){return function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c}(a)},a.getBaqendType=function(a){return a[f]},a.getIdentifier=function(a){return a[e]},a.setIdentifier=function(a,b){a[e]=b},a.prototype.enhance=function(b,c){if(c[f]!==b){if(Object.prototype.hasOwnProperty.call(c,f))throw new Error("Type is already used by a different manager");c[f]=b,a.setIdentifier(c,b.ref),this.enhancePrototype(c.prototype,b)}},a.prototype.enhancePrototype=function(a,b){var c=this;a.toString===Object.prototype.toString&&Object.defineProperty(a,"toString",{value:function(){return this._metadata.id||this._metadata.bucket},enumerable:!1}),b.superType&&"Object"===b.superType.name&&b.superType.declaredAttributes.forEach(function(b){b.isMetadata||c.enhanceProperty(a,b)}),b.declaredAttributes.forEach(function(b){c.enhanceProperty(a,b)})},a.prototype.enhanceProperty=function(a,b){var c="$"+b.name;Object.defineProperty(a,b.name,{get:function(){var a=this._metadata;return a.readAccess(),a[c]},set:function(a){var b=this._metadata;b.writeAccess(),b[c]=a},configurable:!0,enumerable:!0})},a}();c.exports=g},{}],9:[function(a,c,d){"use strict";var e=a(14),f=a(51),g=function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c}(e);Object.defineProperties(g.prototype,{id:{get:function(){return this._metadata.id},set:function(a){if(this._metadata.id)throw new Error("The id can't be set twice: "+a);0===(a+"").indexOf("/db/"+this._metadata.bucket+"/")?this._metadata.id=a:this.key=a},enumerable:!0},key:{get:function(){return this._metadata.key},set:function(a){this._metadata.key=a}},version:{get:function(){return this._metadata.version},enumerable:!0},acl:{get:function(){return this._metadata.acl},enumerable:!0},ready:{value:function(a){return this._metadata.ready(a)}},attach:{value:function(a){a.attach(this)}},save:{value:function(a,b,c){return a instanceof Function?this.save({},a,b):this._metadata.db.save(this,a).then(b,c)}},insert:{value:function(a,b,c){return a instanceof Function?this.insert({},a,b):this._metadata.db.insert(this,a).then(b,c)}},update:{value:function(a,b,c){return a instanceof Function?this.update({},a,b):this._metadata.db.update(this,a).then(b,c)}},load:{value:function(a,b,c){if(a instanceof Function)return this.load({},a,b);var d=a||{};return d.local=!0,this._metadata.db.load(this.id,null,d).then(b,c)}},delete:{value:function(a,b,c){return a instanceof Function?this.delete({},a,b):this._metadata.db.delete(this,a).then(b,c)}},optimisticSave:{value:function(a,b,c){return this._metadata.db.optimisticSave(this,a).then(b,c)}},attr:{value:function(){throw new Error("Attr is not yet implemented.")}},validate:{value:function(){return this._metadata.db.validate(this)}},partialUpdate:{value:function(a){return new f(this,a)}},getReferencing:{value:function(a){var b=this,c=this._metadata.db,d=this._metadata.type.getReferencing(c,a),e=Array.from(d).map(function(a){var d=a[0],e=c.createQueryBuilder(d.typeConstructor),f=a[1],g=[];return f.forEach(function(a){g.push(e.equal(a,b))}),(1===g.length?g[0]:e.or(g)).resultList()});return Promise.all(e).then(function(a){return a.filter(function(a){return!!a.length})}).then(function(a){return[].concat.apply([],a)})}},toJSON:{value:function(a){var c=a;return"boolean"==typeof c&&(c={excludeMetadata:c}),"object"!==(void 0===c?"undefined":b.typeof(c))&&(c={}),this._metadata.getJson(c)}}}),c.exports=g},{14:14,51:51}],10:[function(a,b,c){"use strict";var d=a(15),e=d.extend({load:function(a,b,c,d){return b instanceof Function?this.load(a,{},b,c):this.db.load(this.managedType.typeConstructor,a,b).then(c,d)},ref:function(a){return this.db.getReference(this.managedType.ref,a)},fromJSON:function(a){var b=this.ref(a.id);return this.managedType.fromJsonValue(null,a,b)},find:function(){return this.db.createQueryBuilder(this.managedType.typeConstructor)},partialUpdate:function(a,b){return this.ref(a).partialUpdate(b)}});b.exports=e},{15:15}],11:[function(a,b,c){"use strict";function d(a){for(var b=1,c=arguments.length;b<c;b+=1)for(var d=arguments[b],e=Object.getOwnPropertyNames(d),f=0,g=e.length;f<g;f+=1){var h=e[f];Object.defineProperty(a,h,Object.getOwnPropertyDescriptor(d,h))}return a}var e=a(73),f=d({extend:function(a){return d({},this,a)},create:function(a){var b=function(a){return b.newInstance(arguments)};return d(b,this),b.prototype=a.prototype,b.type=a,b},new:function(){return this.newInstance(arguments)},newInstance:function(a){if(!a||0===a.length)return new this.type;var b=[null];return Array.prototype.push.apply(b,a),new(Function.prototype.bind.apply(this.type,b))}});e(f,"_type","type"),b.exports=f},{73:73}],12:[function(a,c,d){"use strict";var e=a(33),f=a(1),g=a(77).uuid,h=a(34),i=a(25).StatusCode,j=a(73),k=a(20).trailingSlashIt,l="/file".length,m=Symbol("Id"),n=Symbol("Metadata"),o=Symbol("Data"),p=function(){function a(c){b.classCallCheck(this,a);var d="string"==typeof c?{id:c}:c||{};if(d.id){if(-1===d.id.indexOf("/","/file/".length)||0!==d.id.indexOf("/file/"))throw new Error("Invalid file reference "+d.id);this[m]=d.id}else this[m]=this.createIdFromOptions(d);this.setDataOptions(d),this.isFolder="/"===this.id.charAt(this.id.length-1)}return b.createClass(a,[{key:"id",get:function(){return this[m]}},{key:"url",get:function(){if(this.isFolder)throw new Error("Url can not be created for folders.");return this.db.createURL(this.id,"www"!==this.bucket)}},{key:"name",get:function(){return this.id.substring(this.id.lastIndexOf("/",this.id.length-2)+1)}},{key:"mimeType",get:function(){if(this.isFolder)throw new Error("A folder has no mimeType");return this.checkAvailable(),this[n].mimeType}},{key:"acl",get:function(){return this.checkAvailable(),this[n].acl}},{key:"lastModified",get:function(){if(this.isFolder)throw new Error("A folder has no lastModified");return this.checkAvailable(),this[n].lastModified}},{key:"createdAt",get:function(){if(this.isFolder)throw new Error("A folder has no creation date");return this.checkAvailable(),this[n].createdAt}},{key:"eTag",get:function(){if(this.isFolder)throw new Error("A folder has no eTag");return this.checkAvailable(),this[n].eTag}},{key:"headers",get:function(){if(this.isFolder)throw new Error("A folder has no custom headers");return this.checkAvailable(),this[n].headers}},{key:"size",get:function(){if(this.isFolder)throw new Error("A folder has no size");return this.checkAvailable(),this[n].size}},{key:"bucket",get:function(){return this.id.substring(l+1,this.id.indexOf("/",l+1))}},{key:"key",get:function(){return this.id.substring(this.id.indexOf("/",l+1)+1)}},{key:"path",get:function(){return this.id.substring(l)}},{key:"parent",get:function(){return this.id.substring(l,this.id.lastIndexOf("/",this.id.length-2))}},{key:"isMetadataLoaded",get:function(){return!!this[n]}}]),a.parseETag=function(a){if(!a)return null;var b=a.match(/^(?:[wW]\/)?["'](.*)["']$/);return b?b[1]:null},a.prototype.upload=function(a,b,c){var d=this,e=a||{};if(this.isFolder)throw new Error("A folder cannot be uploaded");this.setDataOptions(e);var f=new h.UploadFile(this.bucket,this.key).entity(this[o].data,this[o].type),g=this[n];return g&&(f.acl(g.acl),f.contentLength(g.size),f.mimeType(g.mimeType),f.customHeaders(g.headers)),f.progress(e.progress),this.conditional(f,e),this.db.addToBlackList(this.id),this.db.send(f).then(function(a){return d[o]=null,d.fromJSON(a.entity),d}).then(b,c)},a.prototype.download=function(a,b,c){var d=this,e=a||{};if(this.isFolder)throw new Error("A folder cannot be downloaded");var f=e.type||"blob",g=new h.DownloadFile(this.bucket,this.key).responseType(f);return this.db.ensureCacheHeader(this.id,g,e.refresh),this.db.send(g).then(function(a){return d.db.addToWhiteList(d.id),d.fromHeaders(a.headers),a.entity},function(a){if(a.status===i.OBJECT_NOT_FOUND)return null;throw a}).then(b,c)},a.prototype.delete=function(a,b,c){var d=this,e=a||{},f=new h.DeleteFile(this.bucket,this.key);return this.conditional(f,e),this.isFolder||this.db.addToBlackList(this.id),this.db.send(f).then(function(a){return d.isFolder?a.entity.map(function(a){return d.db.File(a)}):d}).then(b,c)},a.prototype.createIdFromOptions=function(a){var b=void 0;if(a.path)b=a.path;else{
var c=k(a.parent||"/www");if(c.length<3)throw new Error("Invalid parent name: "+c);b=c+(a.name||a.data&&a.data.name||g())}if("/"!==b.charAt(0)&&(b="/"+b),-1!==b.indexOf("//")||b.length<3)throw new Error("Invalid path: "+b);return"/file"+b},a.prototype.conditional=function(a,b){if(!b.force){var c=this[n];if(!c||!c.lastModified&&!c.eTag)return void a.ifNoneMatch("*");a.ifUnmodifiedSince(c.lastModified),a.ifMatch(c.eTag)}},a.prototype.loadMetadata=function(a,b,c){var d=this,e=a||{};if(this.isFolder)throw new Error("A folder has no matadata.");var f=new h.GetFileMetadata(this.bucket,this.key);return this.db.ensureCacheHeader(this.id,f,e.refresh),this.db.send(f).then(function(a){return d.fromHeaders(a.headers),d},function(a){if(a.status===i.OBJECT_NOT_FOUND)return null;throw a}).then(b,c)},a.prototype.saveMetadata=function(a,b,c){var d=this,e=a||{},f=this.toJSON(),g=new h.UpdateFileMetadata(this.bucket,this.key).entity(f);return this.conditional(g,e),this.db.send(g).then(function(a){return d.fromJSON(a.entity),d}).then(b,c)},a.prototype.setDataOptions=function(a){var b=a.data,c=a.type;if(b){this[o]={type:c,data:b};var d=this.guessMimeType(a);this.fromJSON(Object.assign({},a,{mimeType:d}))}},a.prototype.guessMimeType=function(a){var b=a.mimeType;if(b)return b;if("undefined"!=typeof Blob&&a.data instanceof Blob)return a.data.type;if("data-url"===a.type){return a.data.match(/^data:(.+?)(;base64)?,.*$/)[1]}return null},a.prototype.fromHeaders=function(b){this.fromJSON({eTag:a.parseETag(b.etag),lastModified:b["last-modified"],createdAt:b["baqend-created-at"],mimeType:b["content-type"],acl:b["baqend-acl"]&&JSON.parse(b["baqend-acl"]),size:+b["baqend-size"],headers:b["baqend-custom-headers"]&&JSON.parse(b["baqend-custom-headers"])})},a.prototype.fromJSON=function(a){if(a.id&&this.id!==a.id)throw new Error("This file id "+this.id+" does not match the given json id "+a.id);var b=this[n]||{},c=void 0;a.acl instanceof f?c=a.acl:(c=b.acl||new f,a.acl&&c.fromJSON(a.acl)),this[n]=Object.assign({},this[n],{mimeType:a.mimeType,lastModified:a.lastModified&&new Date(a.lastModified)||b.lastModified,createdAt:a.createdAt&&new Date(a.createdAt)||b.createdAt,eTag:a.eTag||b.eTag,acl:c,size:"number"==typeof a.size?a.size:a.contentLength,headers:a.headers||b.headers||{}})},a.prototype.toJSON=function(){this.checkAvailable();var a=this[n];return{id:this.id,mimeType:a.mimeType,eTag:a.eTag,acl:a.acl.toJSON(),size:a.size,lastModified:a.lastModified&&a.lastModified.toISOString(),createdAt:a.createdAt&&a.createdAt.toISOString(),headers:a.headers}},a.prototype.checkAvailable=function(){if(!this.isMetadataLoaded)throw new e.PersistentError("The file metadata of "+this.id+" is not available.")},a}();j(p.prototype,"_db","db"),j(p.prototype,"_conditional","conditional"),j(p.prototype,"_setMetadata","setDataOptions"),j(p.prototype,"_checkAvailable","checkAvailable"),c.exports=p},{1:1,20:20,25:25,33:33,34:34,73:73,77:77}],13:[function(a,b,c){"use strict";var d=a(11),e=a(12),f=a(20).trailingSlashIt,g=a(34),h=a(67),i=a(25).StatusCode,j=a(73),k=d.extend({create:function(a){var b=d.create.call(this,e);return b.db=a,b},newInstance:function(a){var b=d.newInstance.call(this,a);return b.db=this.db,b},fromJSON:function(a){var b=this.newInstance([a.id]);return b.fromJSON(a),b},saveMetadata:function(a,b,c,d){var e=new g.SetFileBucketMetadata(a,b);return this.db.send(e).then(c,d)},loadMetadata:function(a,b,c,d){var e=new g.GetFileBucketMetadata(a);return this.db.send(e).then(function(a){var b={};return h.BASE_PERMISSIONS.forEach(function(c){b[c]=h.fromJSON(a.entity[c]||{})}),b},function(a){if(a.status===i.OBJECT_NOT_FOUND)return null;throw a}).then(c,d)},listBuckets:function(a,b){var c=this;return this.db.send(new g.ListBuckets).then(function(a){return a.entity.map(function(a){return c.new(a+"/")})}).then(a,b)},listFiles:function(a,b,c,d,e){var h=this,i=void 0;if(Object(a)instanceof String){var j=f(a);i=this.new({path:j})}else i=a;var k=i.key,l=i.bucket;return this.db.send(new g.ListFiles(l,k,b?b.key:null,c)).then(function(a){return a.entity.map(function(a){return h.new(a)})}).then(d,e)}});j(k,"_db","db"),b.exports=k},{11:11,12:12,20:20,25:25,34:34,67:67,73:73}],14:[function(a,c,d){"use strict";var e=a(8),f=a(65),g=function(){function a(c){b.classCallCheck(this,a),a.init(this,c)}return a.init=function(a,b){var c=e.getBaqendType(a.constructor);c&&Object.defineProperty(a,"_metadata",{value:f.create(c,a),configurable:!0}),b&&Object.assign(a,b)},a.extend=function(b){return b.prototype=Object.create(this.prototype,{constructor:{value:b,configurable:!0,writable:!0}}),b.extend=a.extend,b},a}();Object.defineProperties(g.prototype,{toJSON:{value:function(){return this._metadata.type.toJsonValue(this._metadata,this,{})}}}),c.exports=g},{65:65,8:8}],15:[function(a,b,c){"use strict";var d=a(11),e=a(73),f=d.extend({create:function(a,b){var c=d.create.call(this,a.typeConstructor);return c.methods=c.prototype,c.managedType=a,c.db=b,c},newInstance:function(a){var b=d.newInstance.call(this,a);return b._metadata.db=this.db,b},fromJSON:function(a){var b=this.newInstance(),c=b._metadata;return this.managedType.fromJsonValue(c,a,b,{})},addMethods:function(a){Object.assign(this.methods,a)},addMethod:function(a,b){this.methods[a]=b}});e(f,"_db","db"),e(f,"_managedType","managedType"),b.exports=f},{11:11,73:73}],16:[function(a,c,d){"use strict";var e=a(9),f=a(17),g=function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c}(e);Object.defineProperties(g.prototype,{hasUser:{value:function(a){return this.users&&this.users.has(a)}},addUser:{value:function(a){if(!(a instanceof f))throw new Error("Only user instances can be added to a role.");this.users||(this.users=new Set),this.users.add(a)}},removeUser:{value:function(a){if(!(a instanceof f))throw new Error("Only user instances can be removed from a role.");this.users&&this.users.delete(a)}}}),c.exports=g},{17:17,9:9}],17:[function(a,c,d){"use strict";var e=a(9),f=function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c}(e);Object.defineProperties(f.prototype,{newPassword:{value:function(a,b,c,d){return this._metadata.db.newPassword(this.username,a,b).then(c,d)}},changeUsername:{value:function(a,b,c,d){return this._metadata.db.changeUsername(this.username,a,b).then(c,d)}},requestAPIToken:{value:function(a,b){return this._metadata.db.requestAPIToken(this.constructor,this).then(a,b)}}}),c.exports=f},{9:9}],18:[function(a,b,c){"use strict";var d=a(10),e=d.extend({get me(){return this.db.me},register:function(a,b,c,d,e){if(c instanceof Function)return this.register(a,b,!0,c,d);var f="string"==typeof a?this.fromJSON({username:a}):a;return this.db.register(f,b,void 0===c||c).then(d,e)},login:function(a,b,c,d,e){return c instanceof Function?this.login(a,b,!0,c,d):this.db.login(a,b,void 0===c||c).then(d,e)},loginWithToken:function(a,b,c,d){return b instanceof Function?this.loginWithToken(a,!0,b,c):(this.db.token=a,this.db.renew(b).then(c,d))},logout:function(a,b){return this.db.logout().then(a,b)},newPassword:function(a,b,c,d,e){if("string"==typeof c)return this.db.newPassword(a,b,c).then(d,e);var f=arguments,g=f[0],h=f[1],i=f[2],j=f[3],k=f[4];return i instanceof Function&&(k=j,j=i,i=!0),this.db.newPasswordWithToken(g,h,i).then(j,k)},resetPassword:function(a,b,c){return this.db.resetPassword(a).then(b,c)},changeUsername:function(a,b,c,d,e){return this.db.changeUsername(a,b,c,d,e)},requestAPIToken:function(a,b,c){return this.db.requestAPIToken(this.managedType.typeConstructor,a).then(b,c)},revokeAllTokens:function(a,b,c){return this.db.revokeAllTokens(this.managedType.typeConstructor,a).then(b,c)}});e.LoginOption={NO_LOGIN:-1,SESSION_LOGIN:0,PERSIST_LOGIN:1},e.DefaultOptions={google:{width:585,height:545,scope:"email"},facebook:{width:1140,height:640,scope:"email"},github:{width:1040,height:580,scope:"user:email"},twitter:{width:740,height:730},linkedin:{width:630,height:530,scope:""}},["Google","Facebook","GitHub","Twitter","LinkedIn"].forEach(function(a){var b="loginWith"+a;e[b]=function(c,d,f,g){if(d instanceof Function)return this[b](c,{},d,f);var h=Object.assign({},e.DefaultOptions[a.toLowerCase()],d||{});return this.db.loginWithOAuth(a,c,h).then(f,g)}}),b.exports=e},{10:10}],19:[function(a,b,c){"use strict";c.trailingSlashIt=a(20),c.Accessor=a(6),c.Enhancer=a(8),c.Factory=a(11),c.ManagedFactory=a(15),c.EntityFactory=a(10),c.UserFactory=a(18),c.DeviceFactory=a(7),c.FileFactory=a(13),c.Managed=a(14),c.Entity=a(9),c.Role=a(16),c.User=a(17),c.File=a(12)},{10:10,11:11,12:12,13:13,14:14,15:15,16:16,17:17,18:18,20:20,6:6,7:7,8:8,9:9}],20:[function(a,b,c){"use strict";function d(a){return"/"!==a.charAt(a.length-1)?a+"/":a}c.trailingSlashIt=d},{}],21:[function(a,c,d){"use strict";var e=a(72).atob,f=function(){function a(c){b.classCallCheck(this,a),this.bytes=e(c.b),this.bits=c.m,this.hashes=c.h,this.creation=Date.now()}return a.prototype.contains=function(b){for(var c=a.getHashes(b,this.bits,this.hashes),d=0,e=c.length;d<e;d+=1)if(!this.isSet(c[d]))return!1;return!0},a.prototype.isSet=function(a){var b=Math.floor(a/8),c=1<<a%8;return 0!=(this.bytes.charCodeAt(b)&c)},a.getHashes=function(b,c,d){for(var e=new Array(this.hashes),f=a.murmur3(0,b),g=a.murmur3(f,b),h=0;h<d;h+=1)e[h]=(f+h*g)%c;return e},a.murmur3=function(a,b){var c=3&b.length,d=b.length-c,e=3432918353,f=461845907,g=void 0,h=void 0,i=void 0,j=void 0;for(g=a,j=0;j<d;)i=255&b.charCodeAt(j)|(255&b.charCodeAt(j+=1))<<8|(255&b.charCodeAt(j+=1))<<16|(255&b.charCodeAt(j+=1))<<24,j+=1,i=(65535&i)*e+(((i>>>16)*e&65535)<<16)&4294967295,i=i<<15|i>>>17,i=(65535&i)*f+(((i>>>16)*f&65535)<<16)&4294967295,g^=i,g=g<<13|g>>>19,h=5*(65535&g)+((5*(g>>>16)&65535)<<16)&4294967295,g=27492+(65535&h)+((58964+(h>>>16)&65535)<<16);switch(i=0,c){case 3:i^=(255&b.charCodeAt(j+2))<<16;case 2:i^=(255&b.charCodeAt(j+1))<<8;case 1:i^=255&b.charCodeAt(j),i=(65535&i)*e+(((i>>>16)*e&65535)<<16)&4294967295,i=i<<15|i>>>17,i=(65535&i)*f+(((i>>>16)*f&65535)<<16)&4294967295,g^=i}return g^=b.length,g^=g>>>16,g=2246822507*(65535&g)+((2246822507*(g>>>16)&65535)<<16)&4294967295,g^=g>>>13,g=3266489909*(65535&g)+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0},a}();c.exports=f},{72:72}],22:[function(a,b,c){"use strict";c.BloomFilter=a(21)},{21:21}],23:[function(a,c,d){"use strict";var e=a(31),f=function(){function a(c,d,e,f){b.classCallCheck(this,a),this.host=c,this.port=d,this.secure=e,this.basePath=f,this.origin=a.toUri(c,d,e,"")}return a.create=function(b,c,d,e){var f=b,g=c,h=d,i=e;if("undefined"!=typeof location&&(f||(f=location.hostname,g=Number(location.port)),void 0===h&&(h="https:"===location.protocol)),h=!!h,void 0===i&&(i=a.DEFAULT_BASE_PATH),-1!==f.indexOf("/")){var j=/^(https?):\/\/([^\/:]+|\[[^\]]+\])(:(\d*))?(\/\w+)?\/?$/.exec(f);if(!j)throw new Error("The connection uri host "+f+" seems not to be valid");h="https"===j[1],f=j[2].replace(/(\[|])/g,""),g=j[4],i=j[5]||""}else"localhost"!==f&&/^[a-z0-9-]*$/.test(f)&&(f+=a.HTTP_DOMAIN);g||(g=h?443:80);var k=a.toUri(f,g,h,i),l=this.connections[k];if(!l){for(var m=this.connectors.length-1;m>=0;m-=1){var n=this.connectors[m];if(n.isUsable&&n.isUsable(f,g,h,i)){l=new n(f,g,h,i);break}}if(!l)throw new Error("No connector is usable for the requested connection.");this.connections[k]=l}return l},a.toUri=function(a,b,c,d){var e=(c?"https://":"http://")+(-1!==a.indexOf(":")?"["+a+"]":a);return e+=c&&443!==b||!c&&80!==b?":"+b:"",e+=d},a.prototype.send=function(a){var b=this,c={status:0};return new Promise(function(c){b.prepareRequest(a),b.doSend(a,a.request,c)}).then(function(a){c=a}).then(function(){return b.prepareResponse(a,c)}).then(function(){return a.doReceive(c),c}).catch(function(a){throw c.entity=null,e.of(a)})},a.prototype.prepareRequest=function(a){if(!a.mimeType()){var b=a.request.type;"json"===b?a.mimeType("application/json;charset=utf-8"):"text"===b&&a.mimeType("text/plain;charset=utf-8")}this.toFormat(a);var c=void 0;switch(a.responseType()){case"json":c="application/json";break;case"text":c="text/*";break;default:c="application/json,text/*;q=0.5,*/*;q=0.1"}if(a.accept()||a.accept(c),this.gzip){var d=a.ifNoneMatch();d&&'""'!==d&&"*"!==d&&a.ifNoneMatch(d.slice(0,-1)+'--gzip"')}if("/connect"===a.request.path)a.request.path=a.tokenStorage.signPath(this.basePath+a.request.path).substring(this.basePath.length),a.cacheControl()&&(a.request.path+=(a.tokenStorage.token?"&":"?")+"BCB");else if(a.tokenStorage){var e=a.tokenStorage.token;e&&a.header("authorization","BAT "+e)}},a.prototype.toFormat=function(a){},a.prototype.prepareResponse=function(a,b){var c=this;b.status=1223===b.status?204:b.status;var d=void 0,e=b.headers||{},f=204===b.status?null:b.entity;if(f&&(!(d=a.responseType())||b.status>=400)){var g=e["content-type"]||e["Content-Type"];g&&g.indexOf("application/json")>-1&&(d="json")}if(e.etag&&(e.etag=e.etag.replace("--gzip","")),a.tokenStorage){var h=e["baqend-authorization-token"]||e["Baqend-Authorization-Token"];h&&a.tokenStorage.update(h)}return new Promise(function(a){a(f&&c.fromFormat(b,f,d))}).then(function(d){b.entity=d,-1!==a.request.path.indexOf("/connect")&&d&&(c.gzip=!!d.gzip)},function(a){throw new Error("Response was not valid "+d+": "+a.message)})},a.prototype.fromFormat=function(a,b,c){},a}();Object.assign(f,{DEFAULT_BASE_PATH:"/v1",HTTP_DOMAIN:".app.baqend.com",RESPONSE_HEADERS:["baqend-authorization-token","content-type","baqend-size","baqend-acl","etag","last-modified","baqend-created-at","baqend-custom-headers"],connectors:[],connections:{},gzip:!1}),c.exports=f},{31:31}],24:[function(a,c,d){"use strict";var e=a(23),f=a(26),g=function(a){function c(d,e,f,g){b.classCallCheck(this,c);var h=b.possibleConstructorReturn(this,a.call(this,d,e,f,g));return h.mid=0,h.messages={},h.doReceive=h.doReceive.bind(h),addEventListener("message",h.doReceive,!1),h}return b.inherits(c,a),c.isUsable=function(a,b,c){if("undefined"==typeof location||"undefined"==typeof document)return!1;var d="https:"===location.protocol,e=location.port||(d?443:80);return location.hostname!==a||e!==b||d!==c},c.prototype.load=function(a){this.iframe=document.createElement("iframe"),this.iframe.src=this.origin+this.basePath+a,this.iframe.setAttribute("style",c.style),document.body.appendChild(this.iframe),this.queue=[],this.iframe.addEventListener("load",this.onLoad.bind(this),!1)},c.prototype.onLoad=function(){for(var a=this.queue,b=0;b<a.length;b+=1)this.postMessage(a[b]);this.queue=null},c.prototype.doSend=function(b,c,d){var f=this;if(b.isBinary)return void a.prototype.doSend.call(this,b,c,d);this.iframe||(this.load(b.request.path),b.request.path="/connect");var g={mid:this.mid+=1,method:c.method,path:c.path,headers:c.headers,entity:c.entity,responseHeaders:e.RESPONSE_HEADERS};this.messages[g.mid]=d;var h=JSON.stringify(g);this.queue?this.queue.push(h):this.postMessage(h),this.connected||setTimeout(function(){f.messages[g.mid]&&(delete f.messages[g.mid],d({status:0,error:new Error("Connection refused.")}))},1e4)},c.prototype.postMessage=function(a){this.iframe.contentWindow.postMessage(a,this.origin)},c.prototype.doReceive=function(a){if(a.origin===this.origin&&"{"===a.data[0]){var b=JSON.parse(a.data),c=this.messages[b.mid];c&&(delete this.messages[b.mid],this.connected=!0,c({status:b.status,headers:b.headers,entity:b.entity}))}},c}(f);g.style="width:1px;height:1px;position:absolute;top:-10px;left:-10px;",e.connectors.push(g),c.exports=g},{23:23,26:26}],25:[function(a,c,d){"use strict";var e=a(28),f="undefined"==typeof navigator||"undefined"!=typeof chrome&&/google/i.test(navigator.vendor)||/cros i686/i.test(navigator.platform),g=Symbol("ResponseType"),h=function(){function a(){b.classCallCheck(this,a),this.withCredentials=!1,this.tokenStorage=null,this.progressCallback=null;var c=arguments,d=0,e=this.spec.path;if(Object(e)instanceof Array){e=this.spec.path[0];for(var f=this.spec.path.length,g=1;g<f;g+=1)this.spec.dynamic&&f-1===g?e+=c[d].split("/").map(encodeURIComponent).join("/"):e+=encodeURIComponent(c[d])+this.spec.path[g],d+=1}for(var h="",i=0;i<this.spec.query.length;i+=1){var j=c[d];d+=1,void 0!==j&&null!==j&&(h+=h||-1!==e.indexOf("?")?"&":"?",h+=this.spec.query[i]+"="+encodeURIComponent(j))}this.request={method:this.spec.method,path:e+h,entity:null,headers:{}},c[d]&&this.entity(c[d],"json"),this.responseType("json")}return a.create=function(c){var d=c.path.split("?"),e=d[0].split(/[:*]\w*/),f=[];return d[1]&&d[1].split("&").forEach(function(a){var b=a.split("=");f.push(b[0])}),c.dynamic=-1!==c.path.indexOf("*"),c.path=e,c.query=f,function(a){function d(){return b.classCallCheck(this,d),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(d,a),b.createClass(d,[{key:"spec",get:function(){return c}}]),d}(a)},a.createExternal=function(c,d){c.path=[c.path];var e=function(a){function d(){return b.classCallCheck(this,d),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(d,a),b.createClass(d,[{key:"spec",get:function(){return c}}]),d}(a);return Object.assign(e.prototype,d),e},b.createClass(a,[{key:"isBinary",get:function(){return this.request.type in a.BINARY||this[g]in a.BINARY}}]),a.prototype.header=function(a,b){return void 0!==b?(this.request.headers[a]=b,this):this.request.headers[a]},a.prototype.entity=function(a,b){var c=b;return c||(c="string"==typeof a?/^data:(.+?)(;base64)?,.*$/.test(a)?"data-url":"text":"undefined"!=typeof Blob&&a instanceof Blob?"blob":"undefined"!=typeof Buffer&&a instanceof Buffer?"buffer":"undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer?"arraybuffer":"undefined"!=typeof FormData&&a instanceof FormData?"form":"json"),this.request.type=c,this.request.entity=a,this},a.prototype.mimeType=function(a){return this.header("content-type",a)},a.prototype.contentLength=function(a){return this.header("content-length",a)},a.prototype.ifMatch=function(a){return this.header("If-Match",this.formatETag(a))},a.prototype.ifNoneMatch=function(a){return this.header("If-None-Match",this.formatETag(a))},a.prototype.ifUnmodifiedSince=function(a){return this.header("if-unmodified-since",a&&a.toUTCString().replace("UTC","GMT"))},a.prototype.noCache=function(){return f||this.ifMatch("").ifNoneMatch("-"),this.cacheControl("max-age=0, no-cache")},a.prototype.cacheControl=function(a){return this.header("cache-control",a)},a.prototype.acl=function(a){return this.header("baqend-acl",a&&JSON.stringify(a))},a.prototype.customHeaders=function(a){return this.header("baqend-custom-headers",a&&JSON.stringify(a))},a.prototype.accept=function(a){return this.header("accept",a)},a.prototype.responseType=function(a){return void 0!==a?(this[g]=a,this):this[g]},a.prototype.progress=function(a){return void 0!==a?(this.progressCallback=a,this):this.progressCallback},a.prototype.addQueryString=function(a){var b=this;if(Object(a)instanceof String)return this.request.path+=a,this;if(a){var c=this.request.path.indexOf("?")>=0?"&":"?";Object.keys(a).forEach(function(d){b.request.path+=c+d+"="+encodeURIComponent(a[d]),c="&"})}return this},a.prototype.formatETag=function(a){var b=a;return b&&"*"!==b&&(b=""+b,-1===b.indexOf('"')&&(b='"'+b+'"')),b},a.prototype.doReceive=function(a){if(-1===this.spec.status.indexOf(a.status))throw new e(this,a)},a}();Object.assign(h,{StatusCode:{NOT_MODIFIED:304,BAD_CREDENTIALS:460,BUCKET_NOT_FOUND:461,INVALID_PERMISSION_MODIFICATION:462,INVALID_TYPE_VALUE:463,OBJECT_NOT_FOUND:404,OBJECT_OUT_OF_DATE:412,PERMISSION_DENIED:466,QUERY_DISPOSED:467,QUERY_NOT_SUPPORTED:468,SCHEMA_NOT_COMPATIBLE:469,SCHEMA_STILL_EXISTS:470,SYNTAX_ERROR:471,TRANSACTION_INACTIVE:472,TYPE_ALREADY_EXISTS:473,TYPE_STILL_REFERENCED:474,SCRIPT_ABORTION:475},BINARY:{blob:!0,buffer:!0,stream:!0,arraybuffer:!0,"data-url":!0,base64:!0},GoogleOAuth:h.createExternal({method:"OAUTH",path:"https://accounts.google.com/o/oauth2/auth?response_type=code&access_type=online",query:["client_id","scope","state"],status:[200]},{addRedirectOrigin:function(a){this.addQueryString({redirect_uri:a+"/db/User/OAuth/google"})}}),FacebookOAuth:h.createExternal({method:"OAUTH",path:"https://www.facebook.com/dialog/oauth?response_type=code",query:["client_id","scope","state"],status:[200]},{addRedirectOrigin:function(a){this.addQueryString({redirect_uri:a+"/db/User/OAuth/facebook"})}}),GitHubOAuth:h.createExternal({method:"OAUTH",path:"https://github.com/login/oauth/authorize?response_type=code&access_type=online",query:["client_id","scope","state"],status:[200]},{addRedirectOrigin:function(a){this.addQueryString({redirect_uri:a+"/db/User/OAuth/github"})}}),LinkedInOAuth:h.createExternal({method:"OAUTH",path:"https://www.linkedin.com/uas/oauth2/authorization?response_type=code&access_type=online",query:["client_id","scope","state"],status:[200]},{addRedirectOrigin:function(a){this.addQueryString({redirect_uri:a+"/db/User/OAuth/linkedin"})}}),TwitterOAuth:h.createExternal({method:"OAUTH",path:"",query:[],status:[200]},{addRedirectOrigin:function(a){this.request.path=a+"/db/User/OAuth1/twitter"}})}),c.exports=h},{28:28}],26:[function(a,c,d){"use strict";var e=a(23),f=function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.isUsable=function(){return"undefined"!=typeof XMLHttpRequest},c.prototype.doSend=function(a,b,c){var d=this;if("OAUTH"===b.method){this.oAuthHandle&&this.oAuthHandle({status:409,entity:'{"message": "A new OAuth request was sent."}'}),localStorage.removeItem("oauth-response");var f=function(a){"oauth-response"===a.key&&d.oAuthHandle(JSON.parse(a.newValue))};return this.oAuthHandle=function(a){c(a),localStorage.removeItem("oauth-response"),removeEventListener("storage",f,!1)},void addEventListener("storage",f,!1)}var g=new XMLHttpRequest,h=this.origin+this.basePath+b.path;g.onreadystatechange=function(){if(g.responseType&&2===g.readyState&&g.status>=400&&(g.responseType="text"),4===g.readyState){var a={headers:{},status:g.status,entity:g.response||g.responseText};e.RESPONSE_HEADERS.forEach(function(b){a.headers[b]=g.getResponseHeader(b)}),c(a)}},g.upload&&a.progress()&&(g.upload.onprogress=a.progress()),g.open(b.method,h,!0);for(var i=b.entity,j=b.headers,k=Object.keys(j),l=0,m=k.length;l<m;l+=1){var n=k[l];g.setRequestHeader(n,j[n])}switch(g.withCredentials=a.withCredentials,a.responseType()){case"arraybuffer":g.responseType="arraybuffer";break;case"blob":case"data-url":case"base64":g.responseType="blob"}g.send(i)},c.prototype.fromFormat=function(a,b,c){if("json"===c)return JSON.parse(b);if("data-url"===c||"base64"===c){var d=new FileReader;return d.readAsDataURL(b),new Promise(function(a,b){d.onload=a,d.onerror=b}).then(function(){var a=d.result;return"base64"===c&&(a=a.substring(a.indexOf(",")+1)),a})}return b},c.prototype.toFormat=function(a){var b=a.request.type;if(b){var c=a.request.entity,d=a.mimeType();switch(b){case"blob":d=d||c.type;break;case"arraybuffer":case"form":break;case"data-url":var e=c.match(/^data:(.+?)(;base64)?,(.*)$/),f=e[2];if(c=e[3],b="blob",d=d||e[1],!f){c=decodeURIComponent(c);break}case"base64":for(var g=atob(c),h=g.length,i=new Uint8Array(h),j=0;j<h;j+=1)i[j]=g.charCodeAt(j);b="blob",c=new Blob([i],{type:d});break;case"json":"string"!=typeof c&&(c=JSON.stringify(c));break;case"text":break;default:throw new Error("Supported request format:"+b)}a.entity(c,b).mimeType(d)}},c}(e);e.connectors.push(f),c.exports=f},{23:23}],27:[function(a,b,c){"use strict";c.Message=a(25),c.Connector=a(23),c.FetchConnector=a(78),c.XMLHttpConnector=a(26),c.IFrameConnector=a(24),c.NodeConnector=a(78)},{23:23,24:24,25:25,26:26,78:78}],28:[function(a,c,d){"use strict";var e=a(31),f=function(a){function c(d,e){b.classCallCheck(this,c);var f=e.entity||e.error||{},g=0===e.status?"Request":"Response",h=f.message||"Handling the "+g+" for "+d.request.method+" "+d.request.path,i=b.possibleConstructorReturn(this,a.call(this,h,f));i.name=f.className||"CommunicationError",i.reason=f.reason||"Communication failed",i.status=e.status,f.data&&(i.data=f.data);for(var j=f;j&&j.stackTrace;){i.stack+="\nServerside Caused by: "+j.className+" "+j.message;for(var k=j.stackTrace,l=0;l<k.length;l+=1){var m=k[l];i.stack+="\n    at "+m.className+"."+m.methodName,i.stack+=" ("+m.fileName+":"+m.lineNumber+")"}j=j.cause}return i}return b.inherits(c,a),c}(e);c.exports=f},{31:31}],29:[function(a,c,d){"use strict";var e=a(31),f=function(a){function c(d){b.classCallCheck(this,c);var e=b.possibleConstructorReturn(this,a.call(this,"The entity "+d+" is managed by a different db."));return e.entity=d,e}return b.inherits(c,a),c}(e);c.exports=f},{31:31}],30:[function(a,c,d){"use strict";var e=a(31),f=function(a){function c(d){b.classCallCheck(this,c);var e=b.possibleConstructorReturn(this,a.call(this,"Entity "+d+" is not a valid entity"));return e.entity=d,e}return b.inherits(c,a),c}(e);c.exports=f},{31:31}],31:[function(a,b,c){"use strict";function d(a,b){Object.prototype.hasOwnProperty.call(Error,"captureStackTrace")?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=a||"An unexpected persistent error occured.",this.name=this.constructor.name,b&&(this.cause=b,b.stack&&(this.stack+="\nCaused By: "+b.stack))}d.of=function(a){return a instanceof d?a:new d(null,a)},d.prototype=Object.create(Error.prototype,{constructor:{value:d,enumerable:!1,configurable:!0}}),b.exports=d},{}],32:[function(a,c,d){"use strict";var e=a(31),f=function(a){function c(d){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.call(this,"The transaction has been rollbacked",d))}return b.inherits(c,a),c}(e);c.exports=f},{31:31}],33:[function(a,b,c){"use strict";c.CommunicationError=a(28),c.IllegalEntityError=a(30),c.EntityExistsError=a(29),c.PersistentError=a(31),c.RollbackError=a(32)},{28:28,29:29,30:30,31:31,32:32}],34:[function(a,b,c){"use strict";var d=a(25);c.ListAllResources=d.create({method:"GET",path:"/",status:[200]}),c.ApiVersion=d.create({method:"GET",path:"/version",status:[200]}),c.Specification=d.create({method:"GET",path:"/spec",status:[200]}),c.GetBloomFilter=d.create({method:"GET",path:"/bloomfilter",status:[200]}),c.DeleteBloomFilter=d.create({method:"DELETE",path:"/bloomfilter",status:[204]}),c.GetOrestesConfig=d.create({method:"GET",path:"/config",status:[200]}),c.UpdateOrestesConfig=d.create({method:"PUT",path:"/config",status:[200,202]}),c.Connect=d.create({method:"GET",path:"/connect",status:[200]}),c.Status=d.create({method:"GET",path:"/status",status:[200]}),c.EventsUrl=d.create({method:"GET",path:"/events-url",status:[200]}),c.BannedIp=d.create({method:"GET",path:"/banned/:ip",status:[204]}),c.Banned=d.create({method:"GET",path:"/banned",status:[]}),c.Unban=d.create({method:"DELETE",path:"/banned",status:[204]}),c.UnbanIp=d.create({method:"DELETE",path:"/banned/:ip",status:[204]}),c.GetBucketNames=d.create({method:"GET",path:"/db",status:[200]}),c.GetBucketIds=d.create({method:"GET",path:"/db/:bucket/ids?start=0&count=-1",status:[200]}),c.ExportBucket=d.create({method:"GET",path:"/db/:bucket",status:[200]}),c.ImportBucket=d.create({method:"PUT",path:"/db/:bucket",status:[200]}),c.TruncateBucket=d.create({method:"DELETE",path:"/db/:bucket",status:[200]}),c.CreateObject=d.create({method:"POST",path:"/db/:bucket",status:[201,202]}),c.GetObject=d.create({method:"GET",path:"/db/:bucket/:oid",status:[200,304]}),c.ReplaceObject=d.create({method:"PUT",path:"/db/:bucket/:oid",status:[200,202]}),c.DeleteObject=d.create({method:"DELETE",path:"/db/:bucket/:oid",status:[202,204]}),c.GetAllSchemas=d.create({method:"GET",path:"/schema",status:[200]}),c.UpdateAllSchemas=d.create({method:"POST",path:"/schema",status:[200]}),c.ReplaceAllSchemas=d.create({method:"PUT",path:"/schema",status:[200]}),c.GetSchema=d.create({method:"GET",path:"/schema/:bucket",status:[200]}),c.UpdateSchema=d.create({method:"POST",path:"/schema/:bucket",status:[200]}),c.ReplaceSchema=d.create({method:"PUT",path:"/schema/:bucket",status:[200]}),c.DeleteSchema=d.create({method:"DELETE",path:"/schema/:bucket",status:[204]}),c.AdhocQuery=d.create({method:"GET",path:"/db/:bucket/query?q&start=0&count=-1&sort=&eager=&hinted=",status:[200]}),c.AdhocQueryPOST=d.create({method:"POST",path:"/db/:bucket/query?start=0&count=-1&sort=",status:[200]}),c.AdhocCountQuery=d.create({method:"GET",path:"/db/:bucket/count?q",status:[200]}),c.AdhocCountQueryPOST=d.create({method:"POST",path:"/db/:bucket/count",status:[200]}),c.ListQueryResources=d.create({method:"GET",path:"/query",status:[200]}),c.CreateQuery=d.create({method:"POST",path:"/query",status:[201]}),c.ListThisQueryResources=d.create({method:"GET",path:"/query/:qid",status:[200]}),c.GetQueryCode=d.create({method:"GET",path:"/query/:qid/source",status:[200]}),c.RunQuery=d.create({method:"GET",path:"/query/:qid/result?start=0&count=-1",status:[200]}),c.GetQueryParameters=d.create({method:"GET",path:"/query/:qid/parameters",status:[200]}),c.NewTransaction=d.create({method:"POST",path:"/transaction",status:[201]}),c.CommitTransaction=d.create({method:"PUT",path:"/transaction/:tid/committed",status:[200]}),c.UpdatePartially=d.create({method:"POST",path:"/db/:bucket/:oid",status:[200]}),c.UpdateField=d.create({method:"POST",path:"/db/:bucket/:oid/:field",status:[200]}),c.Login=d.create({method:"POST",path:"/db/User/login",status:[200]}),c.Register=d.create({method:"POST",path:"/db/User/register",status:[200,204]}),c.Me=d.create({method:"GET",path:"/db/User/me",status:[200]}),c.ValidateUser=d.create({method:"GET",path:"/db/User/validate",status:[200]}),c.Logout=d.create({method:"GET",path:"/db/User/logout",status:[204]}),c.NewPassword=d.create({method:"POST",path:"/db/User/password",status:[200]}),c.ResetPassword=d.create({method:"POST",path:"/db/User/reset",status:[200]}),c.Verify=d.create({method:"GET",path:"/db/User/verify?token=",status:[204]}),c.ChangeUsername=d.create({method:"POST",path:"/db/User/changeUsername",status:[204]}),c.VerifyUsername=d.create({method:"GET",path:"/db/User/verifyUsername?token=",status:[204]}),c.OAuth2=d.create({method:"GET",path:"/db/User/OAuth/:provider?state=&code=&oauth_verifier=&oauth_token=&error_description=",status:[200]}),c.OAuth1=d.create({method:"GET",path:"/db/User/OAuth1/:provider",status:[200]}),c.UserToken=d.create({method:"POST",path:"/db/User/:oid/token",status:[200]}),c.RevokeUserToken=d.create({method:"DELETE",path:"/db/User/:oid/token",status:[204]}),c.GetBaqendCode=d.create({method:"GET",path:"/code/:bucket/:type",status:[200]}),c.SetBaqendCode=d.create({method:"PUT",path:"/code/:bucket/:type",status:[200,202]}),c.DeleteBaqendCode=d.create({method:"DELETE",path:"/code/:bucket/:type",status:[202,204]}),c.PostBaqendModule=d.create({method:"POST",path:"/code/:bucket",status:[200,204]}),c.GetBaqendModule=d.create({method:"GET",path:"/code/:bucket",status:[200,204]}),c.GetAllModules=d.create({method:"GET",path:"/code",status:[200]}),c.ListFiles=d.create({method:"GET",path:"/file/:bucket/ids?path=/&start=&count=-1&deep=false",status:[200]}),c.ListBuckets=d.create({method:"GET",path:"/file/buckets",status:[200]}),c.DownloadArchive=d.create({method:"GET",path:"/file",status:[200]}),c.UploadPatchArchive=d.create({method:"POST",path:"/file",status:[200]}),c.GetFileBucketMetadata=d.create({method:"GET",path:"/file/:bucket",status:[200]}),c.SetFileBucketMetadata=d.create({method:"PUT",path:"/file/:bucket",status:[204]}),c.DeleteFileBucket=d.create({method:"DELETE",path:"/file/:bucket",status:[204]}),c.CreateFile=d.create({method:"POST",path:"/file/:bucket",status:[200]}),c.DownloadFile=d.create({method:"GET",path:"/file/:bucket/*oid",status:[200,304]}),c.UploadFile=d.create({method:"PUT",path:"/file/:bucket/*oid",status:[200]}),c.GetFileMetadata=d.create({method:"HEAD",path:"/file/:bucket/*oid",status:[200]}),c.UpdateFileMetadata=d.create({method:"POST",path:"/file/:bucket/*oid",status:[200]}),c.DeleteFile=d.create({method:"DELETE",
path:"/file/:bucket/*oid",status:[200,204]}),c.CreateManifest=d.create({method:"POST",path:"/pwa/manifest",status:[202]}),c.DownloadAsset=d.create({method:"GET",path:"/asset/*url",status:[200,304]}),c.RevalidateAssets=d.create({method:"POST",path:"/asset/revalidate",status:[202]}),c.GetRevalidationStatus=d.create({method:"GET",path:"/asset/revalidate/:id",status:[200,202]}),c.ListIndexes=d.create({method:"GET",path:"/index/:bucket",status:[200]}),c.CreateDropIndex=d.create({method:"POST",path:"/index/:bucket",status:[202]}),c.DropAllIndexes=d.create({method:"DELETE",path:"/index/:bucket",status:[202]}),c.DeviceRegister=d.create({method:"POST",path:"/db/Device/register",status:[200]}),c.DevicePush=d.create({method:"POST",path:"/db/Device/push",status:[204]}),c.DeviceRegistered=d.create({method:"GET",path:"/db/Device/registered",status:[200]}),c.VAPIDKeys=d.create({method:"POST",path:"/config/VAPIDKeys",status:[200]}),c.VAPIDPublicKey=d.create({method:"GET",path:"/config/VAPIDPublicKey",status:[200]}),c.GCMAKey=d.create({method:"POST",path:"/config/GCMKey",status:[204]}),c.UploadAPNSCertificate=d.create({method:"POST",path:"/config/APNSCert",status:[204]})},{25:25}],35:[function(a,c,d){"use strict";var e=a(6),f=function(){function a(c,d){b.classCallCheck(this,a),this.isMetadata=!!d,this.isId=!1,this.isVersion=!1,this.isAcl=!1,this.name=c,this.order=null,this.accessor=null,this.declaringType=null,this.metadata=null}return b.createClass(a,[{key:"persistentAttributeType",get:function(){return-1}},{key:"isAssociation",get:function(){return this.persistentAttributeType>a.PersistentAttributeType.EMBEDDED}},{key:"isCollection",get:function(){return this.persistentAttributeType===a.PersistentAttributeType.ELEMENT_COLLECTION}}]),a.prototype.init=function(a,b){if(this.declaringType)throw new Error("The attribute is already initialized.");this.order=b,this.accessor=new e,this.declaringType=a},a.prototype.getValue=function(a){return this.accessor.getValue(a,this)},a.prototype.setValue=function(a,b){this.accessor.setValue(a,this,b)},a.prototype.hasMetadata=function(a){return this.metadata&&!!this.metadata[a]},a.prototype.getMetadata=function(a){return this.hasMetadata(a)?this.metadata[a]:null},a.prototype.getJsonValue=function(a,b,c){},a.prototype.setJsonValue=function(a,b,c,d){},a.prototype.toJSON=function(){return{name:this.name,metadata:this.metadata||void 0,order:this.order}},a}();f.PersistentAttributeType={BASIC:0,ELEMENT_COLLECTION:1,EMBEDDED:2,MANY_TO_MANY:3,MANY_TO_ONE:4,ONE_TO_MANY:5,ONE_TO_ONE:6},c.exports=f},{6:6}],36:[function(a,c,d){"use strict";function e(a){return a instanceof Date?a.toISOString().replace(/\.?0*Z/,"Z"):null}function f(a,b){var c="string"==typeof a?new Date(a):null;return b&&c&&b.toISOString()===c.toISOString()?b:c}var g=a(49),h=a(4),i=a(12),j=function(a){function c(d,e,f){b.classCallCheck(this,c);var g=0===d.indexOf("/db/")?d:"/db/"+d,h=b.possibleConstructorReturn(this,a.call(this,g,e));return h.noResolving=f,h}return b.inherits(c,a),b.createClass(c,[{key:"persistenceType",get:function(){return g.PersistenceType.BASIC}}]),c.prototype.toJsonValue=function(a,b){return null===b||void 0===b?null:this.typeConstructor(b)},c.prototype.fromJsonValue=function(a,b){return null===b||void 0===b?null:b},c.prototype.toString=function(){return"BasicType("+this.ref+")"},c}(g);Object.assign(j,{Boolean:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.fromJsonValue=function(b,c,d){return"string"==typeof c?"false"!==c:a.prototype.fromJsonValue.call(this,b,c,d)},c}(j))("Boolean",Boolean),Double:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.fromJsonValue=function(b,c,d){return"string"==typeof c?parseFloat(c):a.prototype.fromJsonValue.call(this,b,c,d)},c}(j))("Double",Number),Integer:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.fromJsonValue=function(b,c,d){return"string"==typeof c?parseInt(c,10):a.prototype.fromJsonValue.call(this,b,c,d)},c}(j))("Integer",Number),String:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c}(j))("String",String),DateTime:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.toJsonValue=function(a,b){return e(b)},c.prototype.fromJsonValue=function(a,b,c){return f(b,c)},c}(j))("DateTime",Date),Date:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.toJsonValue=function(a,b){var c=e(b);return c?c.substring(0,c.indexOf("T")):null},c.prototype.fromJsonValue=function(a,b,c){return f(b,c)},c}(j))("Date",Date),Time:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.toJsonValue=function(a,b){var c=e(b);return c?c.substring(c.indexOf("T")+1):null},c.prototype.fromJsonValue=function(a,b,c){return"string"==typeof b?f("1970-01-01T"+b,c):b},c}(j))("Time",Date),File:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.toJsonValue=function(a,b){return b instanceof i?b.id:null},c.prototype.fromJsonValue=function(a,b,c){return b?c&&c.id===b?c:new a.db.File(b):null},c}(j))("File",i),GeoPoint:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.toJsonValue=function(a,b){return b instanceof h?b:null},c.prototype.fromJsonValue=function(a,b){return b?new h(b):null},c}(j))("GeoPoint",h),JsonArray:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.toJsonValue=function(a,b){return Array.isArray(b)?b:null},c.prototype.fromJsonValue=function(a,b){return Array.isArray(b)?b:null},c}(j))("JsonArray",Array),JsonObject:new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.toJsonValue=function(a,b){return b&&b.constructor===Object?b:null},c}(j))("JsonObject",Object)}),c.exports=j},{12:12,4:4,49:49}],37:[function(a,c,d){"use strict";var e=a(46),f=function(a){function c(d,e){b.classCallCheck(this,c);var f=b.possibleConstructorReturn(this,a.call(this,d,e));return f.typeConstructor=null,f}return b.inherits(c,a),b.createClass(c,[{key:"collectionType",get:function(){return e.CollectionType.COLLECTION}}]),c}(e);c.exports=f},{46:46}],38:[function(a,c,d){"use strict";var e=function(){function a(c,d){if(b.classCallCheck(this,a),Object(c)instanceof String){var e={};e[c]=a.ASC,this.keys=[e]}else if(Object(c)instanceof Array)this.keys=c;else{if(!c)throw new Error("The keys parameter must be an String, Object or Array.");this.keys=[c]}this.drop=!1,this.unique=!0===d}return a.prototype.hasKey=function(a){for(var b=0;b<this.keys.length;b+=1)if(this.keys[b][a])return!0;return!1},a.prototype.toJSON=function(){return{unique:this.unique,keys:this.keys,drop:this.drop}},b.createClass(a,[{key:"isCompound",get:function(){return this.keys.length>1}},{key:"isUnique",get:function(){return this.unique}}]),a}();Object.assign(e,{ASC:"asc",DESC:"desc",GEO:"geo",fromJSON:function(a){return new e(a.keys,a.unique)}}),c.exports=e},{}],39:[function(a,c,d){"use strict";var e=a(42),f=a(49),g=a(19),h=function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.createProxyClass=function(){return this.enhancer.createProxy(g.Managed)},c.prototype.createObjectFactory=function(a){return g.ManagedFactory.create(this,a)},c.prototype.toJsonValue=function(b,c,d){return b.root&&c instanceof this.typeConstructor&&!c._metadata.root&&(c._metadata.root=b.root),a.prototype.toJsonValue.call(this,b,c,d)},c.prototype.fromJsonValue=function(b,c,d,e){var f=d;return c&&(f instanceof this.typeConstructor||(f=this.create()),b.root&&!f._metadata.root&&(f._metadata.root=b.root)),a.prototype.fromJsonValue.call(this,b,c,f,e)},c.prototype.toString=function(){return"EmbeddableType("+this.ref+")"},b.createClass(c,[{key:"persistenceType",get:function(){return f.PersistenceType.EMBEDDABLE}}]),c}(e);c.exports=h},{19:19,42:42,49:49}],40:[function(a,c,d){"use strict";var e=a(19),f=a(48),g=a(36),h=a(49),i=a(42),j=a(67),k=a(65),l=function(a){function c(d,e,f){b.classCallCheck(this,c);var g=b.possibleConstructorReturn(this,a.call(this,d,f));return g.declaredId=null,g.declaredVersion=null,g.declaredAcl=null,g.superType=e,g.loadPermission=new j,g.updatePermission=new j,g.deletePermission=new j,g.queryPermission=new j,g.schemaSubclassPermission=new j,g.insertPermission=new j,g}return b.inherits(c,a),b.createClass(c,[{key:"persistenceType",get:function(){return h.PersistenceType.ENTITY}},{key:"id",get:function(){return this.declaredId||this.superType.id}},{key:"version",get:function(){return this.declaredVersion||this.superType.version}},{key:"acl",get:function(){return this.declaredAcl||this.superType.acl}}]),c.prototype.createProxyClass=function(){var a=this.superType.typeConstructor;if(a===Object)switch(this.name){case"User":a=e.User;break;case"Role":a=e.Role;break;default:a=e.Entity}return this.enhancer.createProxy(a)},c.prototype.getReferencing=function(a,b){for(var c=Object.assign({},b),d=a.metamodel.entities,e=new Map,f=Object.keys(d),g=0,h=f.length;g<h;g+=1){var i=f[g];if(!c.classes||-1!==c.classes.indexOf(i))for(var j=d[i],k=j.attributes(),l=k.next();!l.done;l=k.next()){var m=l.value;if(m.type===this||m.elementType===this){var n=e.get(m.declaringType)||new Set;n.add(m.name),e.set(m.declaringType,n)}}}return e},c.prototype.createObjectFactory=function(a){switch(this.name){case"User":return e.UserFactory.create(this,a);case"Device":return e.DeviceFactory.create(this,a);case"Object":return;default:return e.EntityFactory.create(this,a)}},c.prototype.fromJsonValue=function(c,d,e,f){if("string"==typeof d)return c.db.getReference(d);if(!d||"object"!==(void 0===d?"undefined":b.typeof(d)))return null;var g=Object.assign({persisting:!1,onlyMetadata:!1},f),h=void 0,i=void 0;if(e){var j=k.get(e);d.id&&j.id&&d.id!==j.id||(h=e,i=j)}return h||(h=c.db.getReference(this.typeConstructor,d.id),i=k.get(h)),i.enable(!1),a.prototype.fromJsonValue.call(this,i,d,h,g),i.enable(!0),g.persisting?i.setPersistent():g.onlyMetadata||i.setDirty(),h},c.prototype.toJsonValue=function(b,c,d){var e=Object.assign({excludeMetadata:!1,depth:0,persisting:!1},d),f=!0===e.depth||e.depth>-1,g=c&&k.get(c);if(f&&g&&g.isAvailable){g.enable(!1);var h=a.prototype.toJsonValue.call(this,g,c,Object.assign({},e,{depth:!0===e.depth||e.depth-1}));return g.enable(!0),h}return c instanceof this.typeConstructor?(c.attach(b.db),c.id):null},c.prototype.toString=function(){return"EntityType("+this.ref+")"},c.prototype.toJSON=function(){var b=a.prototype.toJSON.call(this);return b.acl.schemaSubclass=this.schemaSubclassPermission,b.acl.insert=this.insertPermission,b.acl.update=this.updatePermission,b.acl.delete=this.deletePermission,b.acl.query=this.queryPermission,b},c}(i),m=function(a){function c(){b.classCallCheck(this,c);var d=b.possibleConstructorReturn(this,a.call(this,l.Object.ref,null,Object));return d.declaredId=new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.call(this,"id",g.String,!0))}return b.inherits(c,a),c.prototype.getJsonValue=function(a){return a.id||void 0},c.prototype.setJsonValue=function(a,b,c){this.id||(a.id=c)},c}(f)),d.declaredId.init(d,0),d.declaredId.isId=!0,d.declaredVersion=new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.call(this,"version",g.Integer,!0))}return b.inherits(c,a),c.prototype.getJsonValue=function(a){return a.version||void 0},c.prototype.setJsonValue=function(a,b,c){c&&(a.version=c)},c}(f)),d.declaredVersion.init(d,1),d.declaredVersion.isVersion=!0,d.declaredAcl=new(function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.call(this,"acl",g.JsonObject,!0))}return b.inherits(c,a),c.prototype.getJsonValue=function(a){return a.acl.toJSON()},c.prototype.setJsonValue=function(a,b,c){a.acl.fromJSON(c||{})},c}(f)),d.declaredAcl.init(d,2),d.declaredAcl.isAcl=!0,d.declaredAttributes=[d.declaredId,d.declaredVersion,d.declaredAcl],d}return b.inherits(c,a),b.createClass(c,null,[{key:"ref",get:function(){return"/db/Object"}}]),c}(l);l.Object=m,c.exports=l},{19:19,36:36,42:42,48:48,49:49,65:65,67:67}],41:[function(a,c,d){"use strict";var e=a(46),f=function(a){function c(d,e){b.classCallCheck(this,c);var f=b.possibleConstructorReturn(this,a.call(this,d,e));return f.typeConstructor=Array,f}return b.inherits(c,a),b.createClass(c,[{key:"collectionType",get:function(){return e.CollectionType.LIST}}],[{key:"ref",get:function(){return"/db/collection.List"}}]),c.prototype.getJsonValue=function(a,b,c){var d=this.getValue(b);if(!(d instanceof this.typeConstructor))return null;for(var f=d.length,g=new Array(f),h=e.getAttachedState(d),i=h||[],j=!h||h.length!==f,k=new Array(f),l=0;l<f;l+=1){var m=d[l];k[l]=this.elementType.toJsonValue(a,m,c),g[l]=m,j=j||i[l]!==m}return c.persisting&&e.attachState(d,g),a.isPersistent&&j&&a.setDirty(),k},c.prototype.setJsonValue=function(a,b,c,d){var f=null;if(c){f=this.getValue(b);var g=c.length;f instanceof this.typeConstructor||(f=new this.typeConstructor(g));var h=new Array(g),i=e.getAttachedState(f)||[];g<f.length&&f.splice(g,f.length-g);for(var j=0;j<g;j+=1){var k=this.elementType.fromJsonValue(a,c[j],i[j],d);f[j]=k,h[j]=k}d.persisting&&e.attachState(f,h)}this.setValue(b,f)},c.prototype.toJSON=function(){return Object.assign({},a.prototype.toJSON.call(this),{type:c.ref+"["+this.elementType.ref+"]"})},c}(e);c.exports=f},{46:46}],42:[function(a,c,d){"use strict";var e=a(49),f=a(67),g=a(71),h=a(19),i=a(73),j=Symbol("ValidationCode"),k=e.TYPE_CONSTRUCTOR,l=function(a){function c(d,e){b.classCallCheck(this,c);var g=b.possibleConstructorReturn(this,a.call(this,0!==d.indexOf("/db/")?"/db/"+d:d,e));return g.enhancer=null,g.declaredAttributes=[],g.schemaAddPermission=new f,g.schemaReplacePermission=new f,g.metadata=null,g}return b.inherits(c,a),b.createClass(c,[{key:"validationCode",get:function(){return this[j]},set:function(a){this[j]=a?g.compile(this,a):null}},{key:"typeConstructor",get:function(){return this[k]||(this.typeConstructor=this.createProxyClass()),this[k]},set:function(a){if(this[k])throw new Error("Type constructor has already been set.");var b=a.prototype instanceof h.Entity;if(this.isEntity){if(!b)throw new TypeError("Entity classes must extends the Entity class.")}else if(!(a.prototype instanceof h.Managed)||b)throw new TypeError("Embeddable classes must extends the Managed class.");this.enhancer.enhance(this,a),this[k]=a}}]),c.prototype.init=function(a){this.enhancer=a,this[k]&&!h.Enhancer.getIdentifier(this[k])&&h.Enhancer.setIdentifier(this[k],this.ref)},c.prototype.createProxyClass=function(){},c.prototype.createObjectFactory=function(a){},c.prototype.create=function(){var a=Object.create(this.typeConstructor.prototype);return h.Managed.init(a),a},c.prototype.attributes=function(){var a,b=void 0,c=0,d=this;return this.superType&&(b=this.superType.attributes()),a={},a[Symbol.iterator]=function(){return this},a.next=function(){if(b){var a=b.next();if(!a.done)return a;b=null}if(c<d.declaredAttributes.length){var e=d.declaredAttributes[c];return c+=1,{value:e,done:!1}}return{done:!0}},a},c.prototype.addAttribute=function(a,b){if(this.getAttribute(a.name))throw new Error("An attribute with the name "+a.name+" is already declared.");var c=void 0;c=a.order?a.order:void 0===b?this.declaredAttributes.length:b,a.init(this,c),this.declaredAttributes.push(a),this[k]&&"Object"!==this.name&&this.enhancer.enhanceProperty(this[k],a)},c.prototype.removeAttribute=function(a){var b=this.declaredAttributes.length;if(this.declaredAttributes=this.declaredAttributes.filter(function(b){return b.name!==a}),b===this.declaredAttributes.length)throw new Error("An Attribute with the name "+a+" is not declared.")},c.prototype.getAttribute=function(a){var b=this.getDeclaredAttribute(a);return!b&&this.superType&&(b=this.superType.getAttribute(a)),b},c.prototype.getDeclaredAttribute=function(a){return this.declaredAttributes.filter(function(b){return b.name===a||b.order===a})[0]||null},c.prototype.fromJsonValue=function(a,b,c,d){if(!b)return null;for(var e=this.attributes(),f=e.next();!f.done;f=e.next()){var g=f.value;d.onlyMetadata&&!g.isMetadata||g.setJsonValue(a,c,b[g.name],d)}return c},c.prototype.toJsonValue=function(a,b,c){if(!(b instanceof this.typeConstructor))return null;for(var d={},e=this.attributes(),f=e.next();!f.done;f=e.next()){var g=f.value;c.excludeMetadata&&g.isMetadata||(d[g.name]=g.getJsonValue(a,b,c))}return d},c.prototype.toJSON=function(){var a={};this.declaredAttributes.forEach(function(b){b.isMetadata||(a[b.name]=b)});var b={class:this.ref,fields:a,acl:{load:this.loadPermission,schemaAdd:this.schemaAddPermission,schemaReplace:this.schemaReplacePermission}};return this.superType&&(b.superClass=this.superType.ref),this.isEmbeddable&&(b.embedded=!0),this.metadata&&(b.metadata=this.metadata),b},c.prototype.references=function(){var a,b=this.attributes(),c=void 0,d=void 0;return a={},a[Symbol.iterator]=function(){return this},a.next=function(){for(;;){if(d){var a=d.next();if(!a.done)return{value:{path:[c.name].concat(a.value.path)}};d=null}var e=b.next();if(e.done)return e;c=e.value;var f=c.isCollection?c.elementType:c.type;if(f.isEntity)return{value:{path:[c.name]}};f.isEmbeddable&&(d=f.references())}},a},c.prototype.hasMetadata=function(a){return this.metadata&&!!this.metadata[a]},c.prototype.getMetadata=function(a){return this.hasMetadata(a)?this.metadata[a]:null},c}(e);i(l.prototype,"_enhancer","enhancer"),c.exports=l},{19:19,49:49,67:67,71:71,73:73}],43:[function(a,c,d){"use strict";var e=a(46),f=a(31),g=function(a){function c(d,e,f,g){b.classCallCheck(this,c);var h=b.possibleConstructorReturn(this,a.call(this,d,f,g));return h.keyType=e,h.typeConstructor=Map,h}return b.inherits(c,a),b.createClass(c,[{key:"collectionType",get:function(){return e.CollectionType.MAP}}],[{key:"ref",get:function(){return"/db/collection.Map"}}]),c.prototype.getJsonValue=function(a,b,c){var d=this.getValue(b);if(!(d instanceof this.typeConstructor))return null;for(var g={},h=e.getAttachedState(d)||{},i=e.getAttachedSize(d)!==d.size,j={},k=d.entries(),l=k.next();!l.done;l=k.next()){var m=l.value;if(null===m[0]||void 0===m[0])throw new f("Map keys can't be null nor undefined.");var n=this.keyType.toJsonValue(a,m[0],c);j[n]=this.elementType.toJsonValue(a,m[1],c),g[n]=[m[0],m[1]],i=i||(h[n]||[])[1]!==m[1]}return c.persisting&&(e.attachState(d,g),e.attachSize(d,d.size)),a.isPersistent&&i&&a.setDirty(),j},c.prototype.setJsonValue=function(a,b,c,d){var f=null;if(c){f=this.getValue(b),f instanceof this.typeConstructor||(f=new this.typeConstructor);var g={},h=e.getAttachedState(f)||{};f.clear();for(var i=Object.keys(c),j=0,k=i.length;j<k;j+=1){var l=i[j],m=h[l]||[],n=this.keyType.fromJsonValue(a,l,m[0],d),o=this.elementType.fromJsonValue(a,c[l],m[1],d);g[l]=[n,o],f.set(n,o)}d.persisting&&(e.attachState(f,g),e.attachSize(f,f.size))}this.setValue(b,f)},c.prototype.toJSON=function(){return Object.assign({},a.prototype.toJSON.call(this),{type:c.ref+"["+this.keyType.ref+","+this.elementType.ref+"]"})},c}(e);c.exports=g},{31:31,46:46}],44:[function(a,c,d){"use strict";var e=a(42),f=a(40),g=a(8),h=a(45),i=a(38),j=a(63),k=a(73),l=a(25).StatusCode,m=a(34),n=function(a){function c(d){b.classCallCheck(this,c);var e=b.possibleConstructorReturn(this,a.call(this));return e.isInitialized=!1,e.entityManagerFactory=d,e.entities=null,e.embeddables=null,e.baseTypes=null,e.enhancer=new g,e}return b.inherits(c,a),c.prototype.init=function(a){if(this.isInitialized)throw new Error("Metamodel is already initialized.");this.fromJSON(a||[]),this.isInitialized=!0},c.prototype.getRef=function(a){var b=void 0;return Object(a)instanceof String?(b=a,0!==b.indexOf("/db/")&&(b="/db/"+a)):b=g.getIdentifier(a),b},c.prototype.entity=function(a){var b=this.getRef(a);return b?this.entities[b]:null},c.prototype.baseType=function(a){var b=null;if(Object(a)instanceof String)b=this.getRef(a);else for(var c=Object.keys(this.baseTypes),d=0,e=c.length;d<e;d+=1){var f=c[d],g=this.baseTypes[f];if(!g.noResolving&&g.typeConstructor===a){b=f;break}}return b?this.baseTypes[b]:null},c.prototype.embeddable=function(a){var b=this.getRef(a);return b?this.embeddables[b]:null},c.prototype.managedType=function(a){return this.baseType(a)||this.entity(a)||this.embeddable(a)},c.prototype.addType=function(a){var b=void 0;if(a.isBasic?b=this.baseTypes:a.isEmbeddable?(a.init(this.enhancer),b=this.embeddables):a.isEntity&&(a.init(this.enhancer),b=this.entities,null===a.superType&&a.ref!==f.Object.ref&&(a.superType=this.entity(f.Object.ref))),b[a.ref])throw new Error("The type "+a.ref+" is already declared.");return b[a.ref]=a,a},c.prototype.load=function(){var a=this;if(!this.isInitialized)return this.withLock(function(){var b=new m.GetAllSchemas;return a.entityManagerFactory.send(b).then(function(b){return a.init(b.entity),a})});throw new Error("Metamodel is already initialized.")},c.prototype.save=function(a){var b=this;return this.sendUpdate(a||this.toJSON()).then(function(){return b})},c.prototype.update=function(a){var b=this;return this.sendUpdate(a).then(function(a){return b.fromJSON(a.entity),b})},c.prototype.sendUpdate=function(a){var b=this;return this.withLock(function(){var c=void 0;return c=a instanceof e?new m.UpdateSchema(a.name,a.toJSON()):new m.UpdateAllSchemas(a),b.entityManagerFactory.send(c)})},c.prototype.toJSON=function(){var a=this;if(!this.isInitialized)throw new Error("Metamodel is not initialized.");return[].concat(Object.keys(this.entities).map(function(b){return a.entities[b].toJSON()}),Object.keys(this.embeddables).map(function(b){return a.embeddables[b].toJSON()}))},c.prototype.fromJSON=function(a){var b=this,c=new h,d=c.buildModels(a);this.baseTypes={},this.embeddables={},this.entities={},Object.keys(d).forEach(function(a){return b.addType(d[a])})},c.prototype.createIndex=function(a,b){b.drop=!1;var c=new m.CreateDropIndex(a,b.toJSON());return this.entityManagerFactory.send(c)},c.prototype.dropIndex=function(a,b){b.drop=!0;var c=new m.CreateDropIndex(a,b.toJSON());return this.entityManagerFactory.send(c)},c.prototype.dropAllIndexes=function(a){var b=new m.DropAllIndexes(a);return this.entityManagerFactory.send(b)},c.prototype.getIndexes=function(a){var b=new m.ListIndexes(a);return this.entityManagerFactory.send(b).then(function(a){return a.entity.map(function(a){return new i(a.keys,a.unique)})}).catch(function(a){if(a.status===l.BUCKET_NOT_FOUND||a.status===l.OBJECT_NOT_FOUND)return null;throw a})},c}(j);k(n.prototype,"_enhancer","enhancer"),k(n.prototype,"_send","sendUpdate"),k(n.prototype,"_getRef","getRef"),c.exports=n},{25:25,34:34,38:38,40:40,42:42,45:45,63:63,73:73,8:8}],45:[function(a,c,d){"use strict";var e=a(36),f=a(40),g=a(39),h=a(41),i=a(43),j=a(47),k=a(48),l=a(31),m=function(){function a(){var c=this;b.classCallCheck(this,a),this.models={},this.modelDescriptors=null,Object.keys(e).forEach(function(a){var b=e[a];b instanceof e&&(c.models[b.ref]=b)})}return a.prototype.getModel=function(a){if(a in this.models)return this.models[a];var b=this.buildModel(a);return this.models[a]=b,b},a.prototype.buildModels=function(a){var b=this;return this.modelDescriptors={},a.forEach(function(a){b.modelDescriptors[a.class]=a}),Object.keys(this.modelDescriptors).forEach(function(a){try{var c=b.getModel(a);b.buildAttributes(c)}catch(b){throw new l("Can't create model for entity class "+a,b)}}),this.getModel(f.Object.ref),this.models},a.prototype.buildModel=function(a){var b=this.modelDescriptors[a],c=void 0;if(a===f.Object.ref)c=new f.Object;else{if(!b)throw new TypeError("No model available for "+a);if(b.embedded)c=new g(a);else{var d=b.superClass||f.Object.ref;c=new f(a,this.getModel(d))}}if(c.metadata={},b){c.metadata=b.metadata||{};var e=b.acl||{};Object.keys(e).forEach(function(a){c[a+"Permission"].fromJSON(e[a])})}return c},a.prototype.buildAttributes=function(a){var b=this,c=this.modelDescriptors[a.ref],d=c.fields;Object.keys(d).forEach(function(c){var e=d[c];a.getAttribute(c)||a.addAttribute(b.buildAttribute(e),e.order)}),c.validationCode&&(a.validationCode=c.validationCode)},a.prototype.buildAttribute=function(a){var b=a.flags&&(-1!==a.flags.indexOf("METADATA")||-1!==a.flags.indexOf("READONLY")),c=a.name,d=a.type;if(0!==d.indexOf("/db/collection.")){var e=new k(c,this.getModel(d),b);return e.metadata=a.metadata,e}var f=d.substring(0,d.indexOf("[")),g=d.substring(d.indexOf("[")+1,d.indexOf("]")).trim();switch(f){case h.ref:return new h(c,this.getModel(g));case j.ref:return new j(c,this.getModel(g));case i.ref:var l=g.substring(0,g.indexOf(",")).trim(),m=g.substring(g.indexOf(",")+1).trim();return new i(c,this.getModel(l),this.getModel(m));default:throw new TypeError("No collection available for "+d)}},a}();c.exports=m},{31:31,36:36,39:39,40:40,41:41,43:43,47:47,48:48}],46:[function(a,c,d){"use strict";var e=a(35),f=Symbol("AttachedState"),g=Symbol("AttachedSize"),h=function(a){function c(d,e){b.classCallCheck(this,c);var f=b.possibleConstructorReturn(this,a.call(this,d));return f.elementType=e,f.typeConstructor=null,f}return b.inherits(c,a),c.getAttachedState=function(a){return a[f]||null},c.attachState=function(a,b){Object.defineProperty(a,f,{value:b,configurable:!0})},c.getAttachedSize=function(a){return a[g]},c.attachSize=function(a,b){Object.defineProperty(a,g,{value:b,configurable:!0})},b.createClass(c,[{key:"persistentAttributeType",get:function(){return e.PersistentAttributeType.ELEMENT_COLLECTION}}]),c}(e);h.CollectionType={COLLECTION:0,LIST:1,MAP:2,SET:3},c.exports=h},{35:35}],47:[function(a,c,d){"use strict";var e=a(46),f=function(a){function c(d,e,f){b.classCallCheck(this,c);var g=b.possibleConstructorReturn(this,a.call(this,d,e,f));return g.typeConstructor=Set,g}return b.inherits(c,a),b.createClass(c,[{key:"collectionType",get:function(){return e.CollectionType.SET}}],[{key:"ref",get:function(){return"/db/collection.Set"}}]),c.prototype.getJsonValue=function(a,b,c){var d=this.getValue(b);if(!(d instanceof this.typeConstructor))return null;for(var f={},g=e.getAttachedState(d)||{},h=e.getAttachedSize(d)!==d.size,i=[],j=d.values(),k=j.next();!k.done;k=j.next()){var l=k.value,m=this.elementType.toJsonValue(a,l,c);i.push(m),f[m]=l,h=h||g[m]!==l}return c.persisting&&(e.attachState(d,f),e.attachSize(d,d.size)),a.isPersistent&&h&&a.setDirty(),i},c.prototype.setJsonValue=function(a,b,c,d){var f=null;if(c){f=this.getValue(b),f instanceof this.typeConstructor||(f=new this.typeConstructor);var g={},h=e.getAttachedState(f)||{};f.clear();for(var i=0,j=c.length;i<j;i+=1){var k=c[i],l=k&&k.id?k.id:k,m=this.elementType.fromJsonValue(a,k,h[l],d);f.add(m),g[l]=m}d.persisting&&(e.attachState(f,g),e.attachSize(f,f.size))}this.setValue(b,f)},c.prototype.toJSON=function(){return Object.assign({},a.prototype.toJSON.call(this),{type:c.ref+"["+this.elementType.ref+"]"})},c}(e);c.exports=f},{46:46}],48:[function(a,c,d){"use strict";var e=a(35),f=a(49),g=function(a){function c(d,e,f){b.classCallCheck(this,c);var g=b.possibleConstructorReturn(this,a.call(this,d,f));return g.type=e,g}return b.inherits(c,a),b.createClass(c,[{key:"typeConstructor",get:function(){return this.type.typeConstructor}},{key:"persistentAttributeType",get:function(){switch(this.type.persistenceType){case f.PersistenceType.BASIC:return e.PersistentAttributeType.BASIC;case f.PersistenceType.EMBEDDABLE:return e.PersistentAttributeType.EMBEDDED;case f.PersistenceType.ENTITY:return e.PersistentAttributeType.ONE_TO_MANY;default:throw new Error("Unknown persistent attribute type.")}}}]),c.prototype.getJsonValue=function(a,b,c){return this.type.toJsonValue(a,this.getValue(b),c)},c.prototype.setJsonValue=function(a,b,c,d){this.setValue(b,this.type.fromJsonValue(a,c,this.getValue(b),d))},c.prototype.toJSON=function(){return Object.assign({},a.prototype.toJSON.call(this),{type:this.type.ref})},c}(e);c.exports=g},{35:35,49:49}],49:[function(a,c,d){"use strict";var e=Symbol("TypeConstructor"),f=function(){function a(c,d){if(b.classCallCheck(this,a),0!==c.indexOf("/db/"))throw new SyntaxError("Type ref "+c+" is invalid.");this.ref=c,this.name=c.substring(4),this[e]=d}return b.createClass(a,[{key:"persistenceType",get:function(){return-1}},{key:"isBasic",get:function(){return this.persistenceType===a.PersistenceType.BASIC}},{key:"isEmbeddable",get:function(){return this.persistenceType===a.PersistenceType.EMBEDDABLE}},{key:"isEntity",get:function(){return this.persistenceType===a.PersistenceType.ENTITY}},{key:"isMappedSuperclass",get:function(){return this.persistenceType===a.PersistenceType.MAPPED_SUPERCLASS}},{key:"typeConstructor",get:function(){return this[e]},set:function(a){if(this[e])throw new Error("typeConstructor has already been set.");this[e]=a}}]),a.prototype.fromJsonValue=function(a,b,c,d){},a.prototype.toJsonValue=function(a,b,c){},a}();f.PersistenceType={BASIC:0,EMBEDDABLE:1,ENTITY:2,MAPPED_SUPERCLASS:3},f.TYPE_CONSTRUCTOR=e,c.exports=f},{}],50:[function(a,b,c){"use strict";var d=a(44);d.prototype.Attribute=a(35),d.prototype.BasicType=a(36),d.prototype.CollectionAttribute=a(37),d.prototype.EmbeddableType=a(39),d.prototype.EntityType=a(40),d.prototype.ListAttribute=a(41),d.prototype.ManagedType=a(42),d.prototype.MapAttribute=a(43),d.prototype.Metamodel=a(44),d.prototype.ModelBuilder=a(45),d.prototype.PluralAttribute=a(46),d.prototype.SetAttribute=a(47),d.prototype.SingularAttribute=a(48),d.prototype.Type=a(49),d.prototype.DbIndex=a(38),b.exports=new d},{35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49}],51:[function(a,c,d){"use strict";var e=a(52),f=a(65),g=a(73),h=a(34),i=function(a){function c(d,e){b.classCallCheck(this,c);var f=b.possibleConstructorReturn(this,a.call(this,e));return f.entity=d,f}return b.inherits(c,a),c.prototype.execute=function(){var a=this,b=f.get(this.entity),c=JSON.stringify(this),d=new h.UpdatePartially(b.bucket,b.key,c);return b.withLock(function(){return b.db.send(d).then(function(c){return b.setJson(c.entity,!0),a.entity})})},c}(e);g(e.prototype,"_entity","entity"),c.exports=i},{34:34,52:52,65:65,73:73}],52:[function(a,c,d){"use strict";var e=["$add","$and","$currentDate","$dec","$inc","$max","$min","$mul","$or","$pop","$push","$put","$remove","$rename","$replace","$set","$shift","$unshift","$xor"],f=a(53),g=a(73),h=function(){function a(c){b.classCallCheck(this,a),this.operations=[],c&&this.addOperations(c)}return a.prototype.set=function(a,b){var c=b;if(c instanceof Set)c=Array.from(c);else if(c instanceof Map){var d={};c.forEach(function(a,b){d[b]=a}),c=d}return this.addOperation(a,"$set",c)},a.prototype.inc=function(a,b){return this.addOperation(a,"$inc","number"==typeof b?b:1)},a.prototype.dec=function(a,b){return this.increment(a,"number"==typeof b?-b:-1)},a.prototype.mul=function(a,b){if("number"!=typeof b)throw new Error("Multiplicator must be a number.");return this.addOperation(a,"$mul",b)},a.prototype.div=function(a,b){if("number"!=typeof b)throw new Error("Divisor must be a number.");return this.addOperation(a,"$mul",1/b)},a.prototype.min=function(a,b){if("number"!=typeof b)throw new Error("Value must be a number");return this.addOperation(a,"$min",b)},
a.prototype.max=function(a,b){if("number"!=typeof b)throw new Error("Value must be a number");return this.addOperation(a,"$max",b)},a.prototype.remove=function(a,b){return this.addOperation(a,"$remove",b)},a.prototype.put=function(a,c,d){var e={};return"string"==typeof c||"number"==typeof c?e[c]=d:"object"===(void 0===c?"undefined":b.typeof(c))&&Object.assign(e,c),this.addOperation(a,"$put",e)},a.prototype.push=function(a,b){return this.addOperation(a,"$push",b)},a.prototype.unshift=function(a,b){return this.addOperation(a,"$unshift",b)},a.prototype.pop=function(a){return this.addOperation(a,"$pop")},a.prototype.shift=function(a){return this.addOperation(a,"$shift")},a.prototype.add=function(a,b){return this.addOperation(a,"$add",b)},a.prototype.replace=function(a,b,c){if(this.hasOperationOnPath(a))throw new Error("You cannot update "+a+" multiple times");return this.addOperation(a+"."+b,"$replace",c)},a.prototype.currentDate=function(a){return this.addOperation(a,"$currentDate")},a.prototype.and=function(a,b){return this.addOperation(a,"$and",b)},a.prototype.or=function(a,b){return this.addOperation(a,"$or",b)},a.prototype.xor=function(a,b){return this.addOperation(a,"$xor",b)},a.prototype.rename=function(a,b){return this.addOperation(a,"$rename",b)},a.prototype.toJSON=function(){return this.operations.reduce(function(a,b){var c={};return c[b.path]=b.value,a[b.name]=Object.assign({},a[b.name],c),a},{})},a.prototype.execute=function(){throw new Error('Cannot call "execute" on abstract PartialUpdateBuilder')},a.prototype.addOperation=function(a,b,c){if("string"!=typeof a)throw new Error("Path must be a string");if(-1===e.indexOf(b))throw new Error("Operation invalid: "+b);if(this.hasOperationOnPath(a))throw new Error("You cannot update "+a+" multiple times");if("number"==typeof c){if(Number.isNaN(c))throw new Error("NaN is not a supported value");if(!Number.isFinite(c))throw new Error("Infinity is not a supported value")}var d=void 0===c?null:c,g=new f(b,a,d);return this.operations.push(g),this},a.prototype.addOperations=function(a){var b=this;Object.keys(a).forEach(function(c){var d=a[c];Object.keys(d).forEach(function(a){var e=d[a];b.operations.push(new f(c,a,e))})})},a.prototype.hasOperationOnPath=function(a){return this.operations.some(function(b){return b.path===a})},a}();Object.assign(h.prototype,{increment:h.prototype.inc,decrement:h.prototype.dec,multiply:h.prototype.mul,divide:h.prototype.div,atMost:h.prototype.min,atLeast:h.prototype.max,toNow:h.prototype.currentDate}),g(h.prototype,"_operations","operations"),g(h.prototype,"_addOperation","addOperation"),g(h.prototype,"_hasOperationOnPath","hasOperationOnPath"),c.exports=h},{53:53,73:73}],53:[function(a,c,d){"use strict";var e=function a(c,d,e){b.classCallCheck(this,a),this.name=c,this.path=d,this.value=e};c.exports=e},{}],54:[function(a,b,c){"use strict";c.EntityPartialUpdateBuilder=a(51),c.PartialUpdateBuilder=a(52)},{51:51,52:52}],55:[function(a,c,d){"use strict";var e=a(57),f=a(56),g=a(59),h=a(60),i=a(73),j=h.varargs,k=function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.prototype.and=function(){return this.addOperator("$and",j(0,arguments))},c.prototype.or=function(){return this.addOperator("$or",j(0,arguments))},c.prototype.nor=function(){return this.addOperator("$nor",j(0,arguments))},c.prototype.eventStream=function(a,b,c,d){return this.where({}).eventStream(a,b,c,d)},c.prototype.resultStream=function(a,b,c,d){return this.where({}).resultStream(a,b,c,d)},c.prototype.resultList=function(a,b,c){return this.where({}).resultList(a,b,c)},c.prototype.singleResult=function(a,b,c){return this.where({}).singleResult(a,b,c)},c.prototype.count=function(a,b){return this.where({}).count(a,b)},c.prototype.addOperator=function(a,b){if(b.length<2)throw new Error("Only two or more queries can be joined with an "+a+" operator.");return b.forEach(function(a,b){if(!(a instanceof h))throw new Error("Argument at index "+b+" is not a query.")}),new g(this.entityManager,this.resultClass,a,b)},c.prototype.addOrder=function(a,b){return new e(this.entityManager,this.resultClass).addOrder(a,b)},c.prototype.addFilter=function(a,b,c){return new e(this.entityManager,this.resultClass).addFilter(a,b,c)},c.prototype.addOffset=function(a){return new e(this.entityManager,this.resultClass).addOffset(a)},c.prototype.addLimit=function(a){return new e(this.entityManager,this.resultClass).addLimit(a)},c}(h);Object.assign(k.prototype,f),i(k.prototype,"_addOperator","addOperator"),i(k.prototype,"_addOrder","addOrder"),i(k.prototype,"_addFilter","addFilter"),i(k.prototype,"_addOffset","addOffset"),i(k.prototype,"_addLimit","addLimit"),c.exports=k},{56:56,57:57,59:59,60:60,73:73}],56:[function(a,b,c){"use strict";var d=a(60).varargs,e={};Object.assign(e,{where:function(a){return this.addFilter(null,null,a)},equal:function(a,b){return this.addFilter(a,null,b)},notEqual:function(a,b){return this.addFilter(a,"$ne",b)},greaterThan:function(a,b){return this.addFilter(a,"$gt",b)},greaterThanOrEqualTo:function(a,b){return this.addFilter(a,"$gte",b)},lessThan:function(a,b){return this.addFilter(a,"$lt",b)},lessThanOrEqualTo:function(a,b){return this.addFilter(a,"$lte",b)},between:function(a,b,c){return this.addFilter(a,"$gt",b).addFilter(a,"$lt",c)},in:function(a){return this.addFilter(a,"$in",d(1,arguments))},notIn:function(a){return this.addFilter(a,"$nin",d(1,arguments))},isNull:function(a){return this.equal(a,null)},isNotNull:function(a){return this.addFilter(a,"$exists",!0).addFilter(a,"$ne",null)},containsAll:function(a){return this.addFilter(a,"$all",d(1,arguments))},mod:function(a,b,c){return this.addFilter(a,"$mod",[b,c])},matches:function(a,b){var c=b instanceof RegExp?b:new RegExp(b);if(c.ignoreCase)throw new Error("RegExp.ignoreCase flag is not supported.");if(c.global)throw new Error("RegExp.global flag is not supported.");if(0!==c.source.indexOf("^"))throw new Error("regExp must be an anchored expression, i.e. it must be started with a ^.");var d=this.addFilter(a,"$regex",c.source);return c.multiline&&d.addFilter(a,"$options","m"),d},size:function(a,b){return this.addFilter(a,"$size",b)},near:function(a,b,c){return this.addFilter(a,"$nearSphere",{$geometry:{type:"Point",coordinates:[b.longitude,b.latitude]},$maxDistance:c})},withinPolygon:function(a){var b=d(1,arguments);return this.addFilter(a,"$geoWithin",{$geometry:{type:"Polygon",coordinates:[b.map(function(a){return[a.longitude,a.latitude]})]}})}}),Object.assign(e,{eq:e.equal,ne:e.notEqual,lt:e.lessThan,le:e.lessThanOrEqualTo,gt:e.greaterThan,ge:e.greaterThanOrEqualTo,containsAny:e.in}),b.exports=e},{60:60}],57:[function(a,c,d){"use strict";var e=a(58),f=a(56),g=a(73),h=function(a){function c(d,e){b.classCallCheck(this,c);var f=b.possibleConstructorReturn(this,a.call(this,d,e));return f.filter={},f}return b.inherits(c,a),c.prototype.addFilter=function(a,b,c){if(null!==a){if(!(Object(a)instanceof String))throw new Error("Field must be a string.");if(b){var d=this.filter[a];d instanceof Object&&Object.getPrototypeOf(d)===Object.prototype||(d={},this.filter[a]=d),d[b]=c}else this.filter[a]=c}else Object.assign(this.filter,c);return this},c.prototype.toJSON=function(){return this.filter},c}(e);Object.assign(h.prototype,f),g(h.prototype,"_filter","filter"),g(h.prototype,"_addFilter","addFilter"),c.exports=h},{56:56,58:58,73:73}],58:[function(a,c,d){"use strict";var e=a(60),f=a(34),g=a(65),h=a(9),i=a(73),j=function(a){function c(d,e){b.classCallCheck(this,c);var f=b.possibleConstructorReturn(this,a.call(this,d,e));return f.firstResult=0,f.maxResults=-1,f.order={},f}return b.inherits(c,a),c.prototype.eventStream=function(){throw new Error("Streaming features not available! Please use Streaming SDK!")},c.prototype.resultStream=function(){throw new Error("Streaming features not available! Please use Streaming SDK!")},c.prototype.resultList=function(a,b,c){var d=this;if(a instanceof Function)return this.resultList({},a,b);var g=this.resultClass?this.entityManager.metamodel.entity(this.resultClass):null;if(!g)throw new Error("Only typed queries can be executed.");var h=this.serializeQuery(),i=this.serializeSort(),j=this.entityManager.connection.host.length+h.length+i.length,k=void 0;return k=j>e.MAX_URI_SIZE?new f.AdhocQueryPOST(g.name,this.firstResult,this.maxResults,i).entity(h,"text"):new f.AdhocQuery(g.name,h,this.firstResult,this.maxResults,i),this.entityManager.send(k).then(function(b){return d.createResultList(b.entity,a)}).then(b,c)},c.prototype.singleResult=function(a,b,c){var d=this;if(a instanceof Function)return this.singleResult({},a,b);var g=this.resultClass?this.entityManager.metamodel.entity(this.resultClass):null;if(!g)throw new Error("Only typed queries can be executed.");var h=this.serializeQuery(),i=this.serializeSort(),j=this.entityManager.connection.host.length+h.length,k=void 0;return k=j>e.MAX_URI_SIZE?new f.AdhocQueryPOST(g.name,h,this.firstResult,1,i).entity(h,"text"):new f.AdhocQuery(g.name,h,this.firstResult,1,i),this.entityManager.send(k).then(function(b){return d.createResultList(b.entity,a)}).then(function(a){return a.length?a[0]:null}).then(b,c)},c.prototype.count=function(a,b){var c=this.resultClass?this.entityManager.metamodel.entity(this.resultClass):null;if(!c)throw new Error("Only typed queries can be executed.");var d=this.serializeQuery(),g=this.entityManager.connection.host.length+d.length,h=void 0;return h=g>e.MAX_URI_SIZE?new f.AdhocCountQueryPOST(c.name).entity(d,"text"):new f.AdhocCountQuery(c.name,d),this.entityManager.send(h).then(function(a){return a.entity.count}).then(a,b)},c.prototype.serializeQuery=function(){return JSON.stringify(this,function(a,b){var c=this[a];return c instanceof Date?{$date:b}:c instanceof h?c.id:b})},c.prototype.serializeSort=function(){return JSON.stringify(this.order)},c.prototype.createResultList=function(a,b){var c=this;return a.length?Promise.all(a.map(function(a){if(a.id){var d=c.entityManager.getReference(c.resultClass,a.id);return g.get(d).setJson(a,{persisting:!0}),c.entityManager.resolveDepth(d,b)}return c.entityManager.load(Object.keys(a)[0])},this)).then(function(a){return a.filter(function(a){return!!a})}):Promise.resolve([])},c.prototype.addOrder=function(a,b){return b?this.order[a]=b:this.order=a,this},c.prototype.addOffset=function(a){return this.firstResult=a,this},c.prototype.addLimit=function(a){return this.maxResults=a,this},c}(e);i(j.prototype,"_sort","order"),i(j.prototype,"_serializeQuery","serializeQuery"),i(j.prototype,"_serializeSort","serializeSort"),i(j.prototype,"_createResultList","createResultList"),i(j.prototype,"_addOrder","addOrder"),i(j.prototype,"_addOffset","addOffset"),i(j.prototype,"_addLimit","addLimit"),c.exports=j},{34:34,60:60,65:65,73:73,9:9}],59:[function(a,c,d){"use strict";var e=a(58),f=a(73),g=function(a){function c(d,e,f,g){b.classCallCheck(this,c);var h=b.possibleConstructorReturn(this,a.call(this,d,e));return h.operator=f,h.childs=g,h}return b.inherits(c,a),c.prototype.toJSON=function(){var a={};return a[this.operator]=this.childs,a},c}(e);f(g.prototype,"_operator","operator"),f(g.prototype,"_childs","childs"),c.exports=g},{58:58,73:73}],60:[function(a,c,d){"use strict";var e=function(){function a(c,d){b.classCallCheck(this,a),this.entityManager=c,this.resultClass=d}return a.prototype.ascending=function(a){return this.addOrder(a,1)},a.prototype.descending=function(a){return this.addOrder(a,-1)},a.prototype.sort=function(a){if(!(a instanceof Object)||Object.getPrototypeOf(a)!==Object.prototype)throw new Error("sort must be an object.");return this.addOrder(a)},a.prototype.offset=function(a){if(a<0)throw new Error("The offset can't be nagative.");return this.addOffset(a)},a.prototype.limit=function(a){if(a<0)throw new Error("The limit can't be nagative.");return this.addLimit(a)},a.prototype.resultList=function(a,b,c){},a.prototype.singleResult=function(a,b,c){},a.prototype.eventStream=function(a){},a.prototype.resultStream=function(a){},a.prototype.count=function(a,b){},a}();e.MAX_URI_SIZE=2e3,e.varargs=function(a,b){return Array.prototype.concat.apply([],Array.prototype.slice.call(b,a))},c.exports=e},{}],61:[function(a,b,c){"use strict";c.Builder=a(55),c.Condition=a(56),c.Filter=a(57),c.Node=a(58),c.Operator=a(59),c.Query=a(60)},{55:55,56:56,57:57,58:58,59:59,60:60}],62:[function(a,c,d){"use strict";var e=a(34),f=a(25).StatusCode,g=a(73),h=function(){function a(c,d){b.classCallCheck(this,a),this.metamodel=c,this.entityManagerFactory=d}return a.prototype.functionToString=function(a){if(!a)return"";var b=a.toString();return b=b.substring(b.indexOf("{")+1,b.lastIndexOf("}")),"\n"===b.charAt(0)&&(b=b.substring(1)),"\n"===b.charAt(b.length-1)&&(b=b.substring(0,b.length-1)),b},a.prototype.stringToFunction=function(a,b){return new Function(a,b)},a.prototype.loadModules=function(){var a=new e.GetAllModules;return this.entityManagerFactory.send(a).then(function(a){return a.entity})},a.prototype.loadCode=function(a,b,c){var d=this,g=Object(a)instanceof String?a:a.name,h=new e.GetBaqendCode(g,b).responseType("text");return this.entityManagerFactory.send(h).then(function(a){return d.parseCode(g,b,c,a.entity)},function(a){if(a.status===f.OBJECT_NOT_FOUND)return null;throw a})},a.prototype.saveCode=function(a,b,c){var d=this,f=Object(a)instanceof String?a:a.name,g=c instanceof Function,h=new e.SetBaqendCode(f,b).entity(g?this.functionToString(c):c,"text").responseType("text");return this.entityManagerFactory.send(h).then(function(a){return d.parseCode(f,b,g,a.entity)})},a.prototype.deleteCode=function(a,b){var c=this,d=Object(a)instanceof String?a:a.name,f=new e.DeleteBaqendCode(d,b);return this.entityManagerFactory.send(f).then(function(){return c.parseCode(d,b,!1,null)})},a.prototype.parseCode=function(a,b,c,d){if("validate"===b){var e=this.metamodel.entity(a);return e.validationCode=d,c?e.validationCode:d}return c?this.stringToFunction(["module","exports"],d):d},a}();g(h.prototype,"_metamodel","metamodel"),g(h.prototype,"_parseCode","parseCode"),c.exports=h},{25:25,34:34,73:73}],63:[function(a,c,d){"use strict";var e=a(73),f=Symbol("IsLocked"),g=Symbol("ReadyPromise"),h=function(){function a(){b.classCallCheck(this,a),this[f]=!1,this[g]=Promise.resolve(this)}return a.prototype.ready=function(a,b){return this[g].then(a,b)},a.prototype.withLock=function(a,b){var c=this;if(this[f])throw new Error("Current operation has not been finished.");try{this[f]=!0;var d=a().then(function(a){return c[f]=!1,a},function(a){throw b||(c[f]=!1),a});return this[g]=d.then(function(){return c},function(a){if(!b)return c;throw a}),d}catch(a){throw b?this[g]=Promise.reject(a):this[f]=!1,a}},b.createClass(a,[{key:"isReady",get:function(){return!this[f]}}]),a}();e(h.prototype,"_isLocked",f),e(h.prototype,"_readyPromise",g),c.exports=h},{73:73}],64:[function(a,c,d){"use strict";var e=a(34),f=a(73),g=function(){function a(){b.classCallCheck(this,a)}return a.create=function(a){function b(){c.log.apply(b,arguments)}var c=this.prototype;return Object.getOwnPropertyNames(c).forEach(function(a){Object.defineProperty(b,a,Object.getOwnPropertyDescriptor(c,a))}),b.init(a),b},a.prototype.log=function(){var c=Array.prototype.slice.call(arguments),d=-1===a.LEVELS.indexOf(c[0])?"info":c.shift();if(this.levelIndex>a.LEVELS.indexOf(d))return null;var e="string"==typeof c[0]?this.format(c.shift(),c):"[no message]",f=null;return c.length&&(f=c.pop(),("object"!==(void 0===f?"undefined":b.typeof(f))||Array.isArray(f))&&(f={data:f}),f instanceof Error&&(f={name:f.name,message:f.message,stack:f.stack,status:f.status,data:f.data})),c.length&&(e+=", "+c.join(", ")),this.logJSON({date:new Date,message:e,level:d,user:this.entityManager.me&&this.entityManager.me.id,data:f})},a.prototype.format=function(b,c){return 0===c.length?b:String(b).replace(a.FORMAT_REGEXP,function(a){if("%%"===a)return"%";if(!c.length)return a;switch(a){case"%s":return String(c.shift());case"%d":return Number(c.shift());case"%j":try{return JSON.stringify(c.shift())}catch(a){return"[Circular]"}default:return a}})},a.prototype.init=function(b){var c=this;this.entityManager=b,this.levelIndex=2,a.LEVELS.forEach(function(a){c[a]=c.log.bind(c,a)})},a.prototype.logJSON=function(a){return this.entityManager.isReady?this.entityManager.send(new e.CreateObject("logs.AppLog",a)):this.entityManager.ready(this.logJSON.bind(this,a))},b.createClass(a,[{key:"level",get:function(){return a.LEVELS[this.levelIndex]},set:function(b){var c=a.LEVELS.indexOf(b);if(-1===c)throw new Error("Unknown logging level "+b);this.levelIndex=c}}]),a}();Object.assign(g,{LEVELS:["trace","debug","info","warn","error"],FORMAT_REGEXP:/%[sdj%]/g}),f(g.prototype,"_init","init"),f(g.prototype,"_format","format"),f(g.prototype,"_log","logJSON"),c.exports=g},{34:34,73:73}],65:[function(a,c,d){"use strict";var e=a(33),f=a(1),g=a(63),h=a(73),i=function(c){function d(a,e){b.classCallCheck(this,d);var g=b.possibleConstructorReturn(this,c.call(this));return g.root=a,g.state=d.Type.DIRTY,g.enabled=!0,g.id=null,g.version=null,g.type=e,g.acl=new f(g),g}return b.inherits(d,c),d.create=function(a,b){var c=void 0;if(a.isEntity)c=new d(b,a);else{if(!a.isEmbeddable)throw new Error("Illegal type "+a);c={type:a,readAccess:function(){var a=this.root&&this.root._metadata;a&&a.readAccess()},writeAccess:function(){var a=this.root&&this.root._metadata;a&&a.writeAccess()}}}return c},d.get=function(a){return a._metadata},b.createClass(d,[{key:"db",get:function(){return this.entityManager?this.entityManager:(this.entityManager=a(5),this.entityManager)},set:function(a){if(this.entityManager)throw new Error("DB has already been set.");this.entityManager=a}},{key:"bucket",get:function(){return this.type.name}},{key:"key",get:function(){if(!this.decodedKey&&this.id){var a=this.id.lastIndexOf("/");this.decodedKey=decodeURIComponent(this.id.substring(a+1))}return this.decodedKey},set:function(a){var b=a+"";if(this.id)throw new Error("The id can't be set twice.");this.id="/db/"+this.bucket+"/"+encodeURIComponent(b),this.decodedKey=b}},{key:"isAttached",get:function(){return!!this.entityManager}},{key:"isAvailable",get:function(){return this.state>d.Type.UNAVAILABLE}},{key:"isPersistent",get:function(){return this.state===d.Type.PERSISTENT}},{key:"isDirty",get:function(){return this.state===d.Type.DIRTY}}]),d.prototype.enable=function(a){this.enabled=a},d.prototype.readAccess=function(){if(this.enabled&&!this.isAvailable)throw new e.PersistentError("This object "+this.id+" is not available.")},d.prototype.writeAccess=function(){if(this.enabled){if(!this.isAvailable)throw new e.PersistentError("This object "+this.id+" is not available.");this.setDirty()}},d.prototype.setUnavailable=function(){this.state=d.Type.UNAVAILABLE},d.prototype.setPersistent=function(){this.state=d.Type.PERSISTENT},d.prototype.setDirty=function(){this.state=d.Type.DIRTY},d.prototype.setRemoved=function(){this.isAvailable&&(this.setDirty(),this.version=null)},d.prototype.getJson=function(a){return this.type.toJsonValue(this,this.root,a)},d.prototype.setJson=function(a,b){this.type.fromJsonValue(this,a,this.root,b)},d}(g);i.Type={UNAVAILABLE:-1,PERSISTENT:0,DIRTY:1},h(i.prototype,"_root","root"),h(i.prototype,"_state","state"),h(i.prototype,"_enabled","enabled"),c.exports=i},{1:1,33:33,5:5,63:63,73:73}],66:[function(a,c,d){"use strict";var e=a(34),f=a(73),g=function(){function a(c){b.classCallCheck(this,a),this.entityManager=c}return a.prototype.get=function(a,b,c,d,f){if(b instanceof Function)return this.get(a,{},b,c,d);if(c instanceof Function)return this.get(a,b,{},c,d);var g=c||{},h=new e.GetBaqendModule(a).addQueryString(b).responseType(g.responseType||null);return this.send(h,d,f)},a.prototype.post=function(a,b,c,d,f){if(c instanceof Function)return this.post(a,b,{},c,d);var g=c||{},h=new e.PostBaqendModule(a).entity(b,g.requestType).mimeType(g.mimeType||null).responseType(g.responseType||null);return this.send(h,d,f)},a.prototype.send=function(a,b,c){return this.entityManager.send(a).then(function(a){return a.entity}).then(b,c)},a}();f(g.prototype,"_entityManager","entityManager"),f(g.prototype,"_send","send"),c.exports=g},{34:34,73:73}],67:[function(a,c,d){"use strict";var e=a(73),f=function(){function a(c){b.classCallCheck(this,a),this.rules={},this._metadata=c}return a.prototype.allRules=function(){return Object.keys(this.rules)},a.prototype.clear=function(){this._metadata&&this._metadata.writeAccess(),this.rules={}},a.prototype.copy=function(a){return this._metadata&&this._metadata.writeAccess(),this.rules=Object.assign({},a.rules),this},a.prototype.isPublicAllowed=function(){var a=this;return!("*"in this.rules)&&!this.allRules().some(function(b){return"allow"===a.rules[b]})},a.prototype.setPublicAllowed=function(){var a=this;this._metadata&&this._metadata.writeAccess(),this.allRules().forEach(function(b){"allow"===a.rules[b]&&delete a.rules[b]})},a.prototype.getRule=function(a){return this.rules[this.ref(a)]},a.prototype.isAllowed=function(a){return"allow"===this.rules[this.ref(a)]},a.prototype.isDenied=function(a){return"deny"===this.rules[this.ref(a)]},a.prototype.allowAccess=function(){var a=arguments;this._metadata&&this._metadata.writeAccess();for(var b=0;b<a.length;b+=1)this.rules[this.ref(a[b])]="allow";return this},a.prototype.denyAccess=function(){var a=arguments;this._metadata&&this._metadata.writeAccess();for(var b=0;b<a.length;b+=1)this.rules[this.ref(a[b])]="deny";return this},a.prototype.deleteAccess=function(){var a=arguments;this._metadata&&this._metadata.writeAccess();for(var b=0;b<a.length;b+=1)delete this.rules[this.ref(a[b])];return this},a.prototype.toJSON=function(){return Object.assign({},this.rules)},a.prototype.fromJSON=function(a){this.rules=a},a.fromJSON=function(a){var b=new this;return b.fromJSON(a),b},a.prototype.ref=function(a){var b="string"==typeof a?a:a.id;if(0===b.indexOf("/db/User/")||0===b.indexOf("/db/Role/"))return b;throw new TypeError("The given object isn't a user, role or a valid reference.")},a}();f.BASE_PERMISSIONS=["load","update","delete","query","insert"],e(f.prototype,"_rules","rules"),c.exports=f},{73:73}],68:[function(a,c,d){"use strict";var e=a(9),f=function(){function a(c,d,e,f,g,h){b.classCallCheck(this,a);var i="string"==typeof f?{sound:f,badge:g,data:h}:f||{};this.devices=a.initDevices(c),this.message=d,this.subject=e,Object.assign(this,i)}return a.initDevices=function(a){if(a instanceof Set)return a;if(!a||a[Symbol.iterator])return new Set(a);if(a instanceof e)return new Set([a]);throw new Error("Only Sets, Lists and Arrays can be used as devices.")},a.prototype.addDevice=function(a){this.devices||(this.devices=new Set),this.devices.add(a)},a.prototype.toJSON=function(){if(!this.devices||!this.devices.size)throw new Error("Set of devices is empty.");return Object.assign({},this,{devices:Array.from(this.devices,function(a){return a.id})})},a}();c.exports=f},{9:9}],69:[function(a,c,d){"use strict";var e=a(74).hmac,f=a(73),g=function(){function a(c,d,e){b.classCallCheck(this,a),this.tokenData=d?a.parse(d):null,this.origin=c,this.temporary=e}return a.parse=function(a){return{val:a,createdAt:1e3*parseInt(a.substring(0,8),16),expireAt:1e3*parseInt(a.substring(8,16),16),sig:a.substring(a.length-40),data:a.substring(0,a.length-40)}},a.create=function(b){return Promise.resolve(new a(b))},b.createClass(a,[{key:"token",get:function(){return this.tokenData?this.tokenData.val:null}}]),a.prototype.saveToken=function(b,c,d){this._saveToken!==a.prototype._saveToken&&(console.log("Using deprecated TokenStorage._saveToken implementation."),this._saveToken(b,c,d))},a.prototype._saveToken=function(a,b,c){},a.prototype.update=function(b){var c=b?a.parse(b):null;this.tokenData&&c&&this.tokenData.expireAt>c.expireAt||(this.tokenData=c,this.saveToken(this.origin,b,this.temporary))},a.prototype.signPath=function(a){if(this.tokenData){var b=a.split("/").map(encodeURIComponent).join("/");return b+"?BAT="+(this.tokenData.data+e(b+this.tokenData.data,this.tokenData.sig))}return a},a}();f(g.prototype,"_token","tokenData"),f(g.prototype,"_origin","origin");var h={},i=function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.create=function(a){return Promise.resolve(new c(a,h[a]))},c.prototype.saveToken=function(a,b,c){c||(b?h[a]=b:delete h[a])},c}(g);g.GLOBAL=i;var j=function(a){function c(){return b.classCallCheck(this,c),b.possibleConstructorReturn(this,a.apply(this,arguments))}return b.inherits(c,a),c.isAvailable=function(){try{return"undefined"!=typeof localStorage&&(localStorage.setItem("bq_webstorage_test","bq"),localStorage.removeItem("bq_webstorage_test"),!0)}catch(a){return!1}},c.create=function(a){var b=!1,d=localStorage.getItem("BAT:"+a);return d||"undefined"==typeof sessionStorage||(d=sessionStorage.getItem("BAT:"+a),b=!!d),Promise.resolve(new c(a,d,b))},c.prototype.saveToken=function(a,b,c){var d=c?sessionStorage:localStorage;b?d.setItem("BAT:"+a,b):d.removeItem("BAT:"+a)},c}(g);j.isAvailable()&&(g.WEB_STORAGE=j),c.exports=g},{73:73,74:74}],70:[function(a,c,d){"use strict";var e=function(){function a(){b.classCallCheck(this,a),this.fields={}}return b.createClass(a,[{key:"isValid",get:function(){var a=this;return Object.keys(this.fields).every(function(b){return a.fields[b].isValid})}}]),a.prototype.toJSON=function(){var a=this,b={};return Object.keys(this.fields).forEach(function(c){b[c]=a.fields[c].toJSON()}),b},a}();c.exports=e},{}],71:[function(a,c,d){"use strict";var e=a(87),f=a(73),g=function(){function a(c,d){b.classCallCheck(this,a),this.key=c,this.entity=d,this.errors=[]}return a.compile=function(a,b){for(var c=[],d=a.attributes(),e=d.next();!e.done;e=d.next()){var f=e.value;c.push(f.name)}var g=new Function(c,b);return function(a){var b=c.map(function(b){return a[b]});return g.apply({},b)}},a.prototype.is=function(a,b){return a instanceof Function?this.is("is",a):(!1===b(this.value,e)&&this.errors.push(a),this)},b.createClass(a,[{key:"value",get:function(){return this.entity[this.key]}},{key:"isValid",get:function(){return 0===this.errors.length}}]),a.prototype.callMethod=function(a,b,c){var d=c||[];return d.unshift(this.value),!1===e[a].apply(this,d)&&this.errors.push(b),this},a.prototype.toString=function(){return this.value},a.prototype.toJSON=function(){return{isValid:this.isValid,errors:this.errors}},a}();Object.keys(e).forEach(function(a){"function"==typeof e[a]&&"toString"!==a&&"toDate"!==a&&"extend"!==a&&"init"!==a&&(g.prototype[a]=function(b){return this.callMethod(a,b||a,Array.prototype.slice.call(arguments,b?1:0))})}),f(g.prototype,"_callMethod","callMethod"),f(g.prototype,"_entity","entity"),c.exports=g},{73:73,87:87}],72:[function(a,b,c){"use strict";c.atob=atob},{}],73:[function(a,b,c){"use strict";b.exports=function(a,b,c){var d=a.constructor.name;Object.defineProperty(a,b,{get:function(){return console.log("Usage of "+d+"."+b+" is deprecated, use "+d+"."+c+" instead."),this[c]},set:function(a){console.log("Usage of "+d+"."+b+" is deprecated, use "+d+"."+c+" instead."),this[c]=a},enumerable:!1})}},{}],74:[function(a,b,c){"use strict";c.hmac=a(80)},{80:80}],75:[function(a,b,c){"use strict";c.isNode=a(76).isNode,c.atob=a(72).atob,c.hmac=a(74).hmac,c.Metadata=a(65),c.Permission=a(67),c.Validator=a(71),c.ValidationResult=a(70),c.Code=a(62),c.Modules=a(66),c.Lockable=a(63),c.Logger=a(64),c.PushMessage=a(68),c.TokenStorage=a(69),c.uuid=a(77).uuid},{62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,74:74,76:76,77:77}],76:[function(a,b,c){"use strict";c.isNode=!1},{}],77:[function(a,b,c){"use strict";c.uuid=a(86)},{86:86}],78:[function(a,b,c){"use strict"},{}],79:[function(b,c,d){!function(b,e){"object"==typeof d?c.exports=d=e():"function"==typeof a&&a.amd?a([],e):b.CryptoJS=e()}(this,function(){var a=a||function(a,b){var c=Object.create||function(){function a(){}return function(b){var c;return a.prototype=b,c=new a,a.prototype=null,c}}(),d={},e=d.lib={},f=e.Base=function(){return{extend:function(a){var b=c(this);return a&&b.mixIn(a),b.hasOwnProperty("init")&&this.init!==b.init||(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),g=e.WordArray=f.extend({init:function(a,b){a=this.words=a||[],this.sigBytes=void 0!=b?b:4*a.length},toString:function(a){return(a||i).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes,e=a.sigBytes;if(this.clamp(),d%4)for(var f=0;f<e;f++){var g=c[f>>>2]>>>24-f%4*8&255;b[d+f>>>2]|=g<<24-(d+f)%4*8}else for(var f=0;f<e;f+=4)b[d+f>>>2]=c[f>>>2];return this.sigBytes+=e,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-c%4*8,b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c,d=[],e=0;e<b;e+=4){var f=function(b){var b=b,c=987654321,d=4294967295;return function(){c=36969*(65535&c)+(c>>16)&d,b=18e3*(65535&b)+(b>>16)&d;var e=(c<<16)+b&d;return e/=4294967296,(e+=.5)*(a.random()>.5?1:-1)}}(4294967296*(c||a.random()));c=987654071*f(),d.push(4294967296*f()|0)}return new g.init(d,b)}}),h=d.enc={},i=h.Hex={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;e<c;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push((f>>>4).toString(16)),d.push((15&f).toString(16))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new g.init(c,b/2)}},j=h.Latin1={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;e<c;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push(String.fromCharCode(f))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-d%4*8;return new g.init(c,b)}},k=h.Utf8={stringify:function(a){try{return decodeURIComponent(escape(j.stringify(a)))}catch(a){throw new Error("Malformed UTF-8 data")}},parse:function(a){return j.parse(unescape(encodeURIComponent(a)))}},l=e.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=k.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,h=4*f,i=e/h;i=b?a.ceil(i):a.max((0|i)-this._minBufferSize,0);var j=i*f,k=a.min(4*j,e);if(j){for(var l=0;l<j;l+=f)this._doProcessBlock(d,l);var m=d.splice(0,j);c.sigBytes-=k}return new g.init(m,k)},clone:function(){var a=f.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0}),m=(e.Hasher=l.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new m.HMAC.init(a,c).finalize(b)}}}),d.algo={});return d}(Math);return a})},{}],80:[function(b,c,d){!function(e,f,g){"object"==typeof d?c.exports=d=f(b(79),b(82),b(81)):"function"==typeof a&&a.amd?a(["./core","./sha1","./hmac"],f):f(e.CryptoJS)}(this,function(a){return a.HmacSHA1})},{79:79,81:81,82:82}],81:[function(b,c,d){!function(e,f){"object"==typeof d?c.exports=d=f(b(79)):"function"==typeof a&&a.amd?a(["./core"],f):f(e.CryptoJS)}(this,function(a){!function(){var b=a,c=b.lib,d=c.Base,e=b.enc,f=e.Utf8,g=b.algo;g.HMAC=d.extend({init:function(a,b){a=this._hasher=new a.init,"string"==typeof b&&(b=f.parse(b));var c=a.blockSize,d=4*c;b.sigBytes>d&&(b=a.finalize(b)),b.clamp()
;for(var e=this._oKey=b.clone(),g=this._iKey=b.clone(),h=e.words,i=g.words,j=0;j<c;j++)h[j]^=1549556828,i[j]^=909522486;e.sigBytes=g.sigBytes=d,this.reset()},reset:function(){var a=this._hasher;a.reset(),a.update(this._iKey)},update:function(a){return this._hasher.update(a),this},finalize:function(a){var b=this._hasher,c=b.finalize(a);return b.reset(),b.finalize(this._oKey.clone().concat(c))}})}()})},{79:79}],82:[function(b,c,d){!function(e,f){"object"==typeof d?c.exports=d=f(b(79)):"function"==typeof a&&a.amd?a(["./core"],f):f(e.CryptoJS)}(this,function(a){return function(){var b=a,c=b.lib,d=c.WordArray,e=c.Hasher,f=b.algo,g=[],h=f.SHA1=e.extend({_doReset:function(){this._hash=new d.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],f=c[2],h=c[3],i=c[4],j=0;j<80;j++){if(j<16)g[j]=0|a[b+j];else{var k=g[j-3]^g[j-8]^g[j-14]^g[j-16];g[j]=k<<1|k>>>31}var l=(d<<5|d>>>27)+i+g[j];l+=j<20?1518500249+(e&f|~e&h):j<40?1859775393+(e^f^h):j<60?(e&f|e&h|f&h)-1894007588:(e^f^h)-899497514,i=h,h=f,f=e<<30|e>>>2,e=d,d=l}c[0]=c[0]+d|0,c[1]=c[1]+e|0,c[2]=c[2]+f|0,c[3]=c[3]+h|0,c[4]=c[4]+i|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;return b[d>>>5]|=128<<24-d%32,b[14+(d+64>>>9<<4)]=Math.floor(c/4294967296),b[15+(d+64>>>9<<4)]=c,a.sigBytes=4*b.length,this._process(),this._hash},clone:function(){var a=e.clone.call(this);return a._hash=this._hash.clone(),a}});b.SHA1=e._createHelper(h),b.HmacSHA1=e._createHmacHelper(h)}(),a.SHA1})},{79:79}],83:[function(a,b,c){"use strict";function d(a){function b(a){}if(!a)throw new TypeError("argument namespace is required");return b._file=void 0,b._ignored=!0,b._namespace=a,b._traced=!1,b._warned=Object.create(null),b.function=e,b.property=f,b}function e(a,b){if("function"!=typeof a)throw new TypeError("argument fn must be a function");return a}function f(a,b,c){if(!a||"object"!=typeof a&&"function"!=typeof a)throw new TypeError("argument obj must be object");var d=Object.getOwnPropertyDescriptor(a,b);if(!d)throw new TypeError("must call property on owner object");if(!d.configurable)throw new TypeError("property must be configurable")}b.exports=d},{}],84:[function(a,b,c){function d(a,b){var c=b||0,d=e;return[d[a[c++]],d[a[c++]],d[a[c++]],d[a[c++]],"-",d[a[c++]],d[a[c++]],"-",d[a[c++]],d[a[c++]],"-",d[a[c++]],d[a[c++]],"-",d[a[c++]],d[a[c++]],d[a[c++]],d[a[c++]],d[a[c++]],d[a[c++]]].join("")}for(var e=[],f=0;f<256;++f)e[f]=(f+256).toString(16).substr(1);b.exports=d},{}],85:[function(a,b,c){var d="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(d){var e=new Uint8Array(16);b.exports=function(){return d(e),e}}else{var f=new Array(16);b.exports=function(){for(var a,b=0;b<16;b++)0==(3&b)&&(a=4294967296*Math.random()),f[b]=a>>>((3&b)<<3)&255;return f}}},{}],86:[function(a,b,c){function d(a,b,c){var d=b&&c||0;"string"==typeof a&&(b="binary"===a?new Array(16):null,a=null),a=a||{};var g=a.random||(a.rng||e)();if(g[6]=15&g[6]|64,g[8]=63&g[8]|128,b)for(var h=0;h<16;++h)b[d+h]=g[h];return b||f(g)}var e=a(85),f=a(84);b.exports=d},{84:84,85:85}],87:[function(b,c,d){!function(b,e){void 0!==d&&void 0!==c?c.exports=e():"function"==typeof a&&"object"==typeof a.amd?a(e):"function"==typeof a&&"object"==typeof a.petal?a("validator",[],e):this.validator=e()}(0,function(a){"use strict";function d(a){var b,c,d,e,f=a.match(L);if(f){if(!(b=f[21]))return f[12]?null:0;if("z"===b||"Z"===b)return 0;c=f[22],-1!==b.indexOf(":")?(d=parseInt(f[23]),e=parseInt(f[24])):(d=0,e=parseInt(f[23]))}else{if(a=a.toLowerCase(),!(b=a.match(/(?:\s|gmt\s*)(-|\+)(\d{1,4})(\s|$)/)))return-1!==a.indexOf("gmt")?0:null;c=b[1];var g=b[2];3===g.length&&(g="0"+g),g.length<=2?(d=0,e=parseInt(g)):(d=parseInt(g.slice(0,2)),e=parseInt(g.slice(2,4)))}return(60*d+e)*("-"===c?1:-1)}function e(a,b){a=a||{};for(var c in b)void 0===a[c]&&(a[c]=b[c]);return a}function f(a){var b="(\\"+a.symbol.replace(/\./g,"\\.")+")"+(a.require_symbol?"":"?"),c="[1-9]\\d{0,2}(\\"+a.thousands_separator+"\\d{3})*",d=["0","[1-9]\\d*",c],e="("+d.join("|")+")?",f="(\\"+a.decimal_separator+"\\d{2})?",g=e+f;return a.allow_negatives&&!a.parens_for_negatives&&(a.negative_sign_after_digits?g+="-?":a.negative_sign_before_digits&&(g="-?"+g)),a.allow_negative_sign_placeholder?g="( (?!\\-))?"+g:a.allow_space_after_symbol?g=" ?"+g:a.allow_space_after_digits&&(g+="( (?!$))?"),a.symbol_after_digits?g+=b:g=b+g,a.allow_negatives&&(a.parens_for_negatives?g="(\\("+g+"\\)|"+g+")":a.negative_sign_before_digits||a.negative_sign_after_digits||(g="-?"+g)),new RegExp("^(?!-? )(?=.*\\d)"+g+"$")}a={version:"4.9.0",coerce:!0};for(var g,h=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~]+$/i,i=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f]))*$/i,j=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+$/i,k=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*$/i,l=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\.\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\.\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF\s]*<(.+)>$/i,m=/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/,n=/^[A-Z]{2}[0-9A-Z]{9}[0-9]$/,o=/^(?:[0-9]{9}X|[0-9]{10})$/,p=/^(?:[0-9]{13})$/,q=/^([0-9a-fA-F][0-9a-fA-F]:){5}([0-9a-fA-F][0-9a-fA-F])$/,r=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,s=/^[0-9A-F]{1,4}$/i,t={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i},u={"en-US":/^[A-Z]+$/i,"de-DE":/^[A-Z]+$/i,"es-ES":/^[A-Z]+$/i,"fr-FR":/^[A-Z]+$/i,"nl-NL":/^[A-Z]+$/i,"pt-PT":/^[A-Z]+$/i,"ru-RU":/^[--]+$/i},v={"en-US":/^[0-9A-Z]+$/i,"de-DE":/^[0-9A-Z]+$/i,"es-ES":/^[0-9A-Z]+$/i,"fr-FR":/^[0-9A-Z]+$/i,"nl-NL":/^[0-9A-Z]+$/i,"pt-PT":/^[0-9A-Z]+$/i,"ru-RU":/^[0-9--]+$/i},w=["AU","GB","HK","IN","NZ","ZA","ZM"],x=0;x<w.length;x++)g="en-"+w[x],u[g]=u["en-US"],v[g]=v["en-US"];var y=/^[-+]?[0-9]+$/,z=/^(?:[-+]?(?:0|[1-9][0-9]*))$/,A=/^(?:[-+]?(?:[0-9]+))?(?:\.[0-9]*)?(?:[eE][\+\-]?(?:[0-9]+))?$/,B=/^[0-9A-F]+$/i,C=/^[-+]?([0-9]+|\.[0-9]+|[0-9]+\.[0-9]+)$/,D=/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i,E=/^[\x00-\x7F]+$/,F=/[^\x00-\x7F]/,G=/[^\u0020-\u007E\uFF61-\uFF9F\uFFA0-\uFFDC\uFFE8-\uFFEE0-9a-zA-Z]/,H=/[\u0020-\u007E\uFF61-\uFF9F\uFFA0-\uFFDC\uFFE8-\uFFEE0-9a-zA-Z]/,I=/[\uD800-\uDBFF][\uDC00-\uDFFF]/,J=/^(?:[A-Z0-9+\/]{4})*(?:[A-Z0-9+\/]{2}==|[A-Z0-9+\/]{3}=|[A-Z0-9+\/]{4})$/i,K={"en-US":/^(\+?1)?[2-9]\d{2}[2-9](?!11)\d{6}$/,"de-DE":/^(\+?49[ \.\-])?([\(]{1}[0-9]{1,6}[\)])?([0-9 \.\-\/]{3,20})((x|ext|extension)[ ]?[0-9]{1,4})?$/,"el-GR":/^(\+?30)?(69\d{8})$/,"en-AU":/^(\+?61|0)4\d{8}$/,"en-GB":/^(\+?44|0)7\d{9}$/,"en-HK":/^(\+?852\-?)?[569]\d{3}\-?\d{4}$/,"en-IN":/^(\+?91|0)?[789]\d{9}$/,"en-NZ":/^(\+?64|0)2\d{7,9}$/,"en-ZA":/^(\+?27|0)\d{9}$/,"en-ZM":/^(\+?26)?09[567]\d{7}$/,"es-ES":/^(\+?34)?(6\d{1}|7[1234])\d{7}$/,"fi-FI":/^(\+?358|0)\s?(4(0|1|2|4|5)?|50)\s?(\d\s?){4,8}\d$/,"fr-FR":/^(\+?33|0)[67]\d{8}$/,"nb-NO":/^(\+?47)?[49]\d{7}$/,"nn-NO":/^(\+?47)?[49]\d{7}$/,"pt-BR":/^(\+?55|0)\-?[1-9]{2}\-?[2-9]{1}\d{3,4}\-?\d{4}$/,"pt-PT":/^(\+?351)?9[1236]\d{7}$/,"ru-RU":/^(\+?7|8)?9\d{9}$/,"vi-VN":/^(\+?84|0)?((1(2([0-9])|6([2-9])|88|99))|(9((?!5)[0-9])))([0-9]{7})$/,"zh-CN":/^(\+?0?86\-?)?((13\d|14[57]|15[^4,\D]|17[678]|18\d)\d{8}|170[059]\d{7})$/,"zh-TW":/^(\+?886\-?|0)?9\d{8}$/},L=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/;a.extend=function(b,c){a[b]=function(){var b=Array.prototype.slice.call(arguments);return b[0]=a.toString(b[0]),c.apply(a,b)}},a.init=function(){for(var b in a)"function"==typeof a[b]&&"toString"!==b&&"toDate"!==b&&"extend"!==b&&"init"!==b&&"isServerSide"!==b&&a.extend(b,a[b])},a.isServerSide=function(){return"object"==typeof c&&c&&"object"==typeof c.exports&&"object"==typeof process&&"function"==typeof b};var M=null;a.deprecation=function(c){if(null===M){if(!a.isServerSide())return;M=b(83)("validator")}M(c)},a.toString=function(b){if("string"!=typeof b){if(!a.coerce)throw new Error("this library validates strings only");a.deprecation("you tried to validate a "+typeof b+" but this library (validator.js) validates strings only. Please update your code as this will be an error soon.")}return"object"==typeof b&&null!==b?b="function"==typeof b.toString?b.toString():"[object Object]":(null===b||void 0===b||isNaN(b)&&!b.length)&&(b=""),""+b},a.toDate=function(a){return"[object Date]"===Object.prototype.toString.call(a)?a:(a=Date.parse(a),isNaN(a)?null:new Date(a))},a.toFloat=function(a){return parseFloat(a)},a.toInt=function(a,b){return parseInt(a,b||10)},a.toBoolean=function(a,b){return b?"1"===a||"true"===a:"0"!==a&&"false"!==a&&""!==a},a.equals=function(b,c){return b===a.toString(c)},a.contains=function(b,c){return b.indexOf(a.toString(c))>=0},a.matches=function(a,b,c){return"[object RegExp]"!==Object.prototype.toString.call(b)&&(b=new RegExp(b,c)),b.test(a)};var N={allow_display_name:!1,allow_utf8_local_part:!0,require_tld:!0};a.isEmail=function(b,c){if(c=e(c,N),c.allow_display_name){var d=b.match(l);d&&(b=d[1])}var f=b.split("@"),g=f.pop(),m=f.join("@"),n=g.toLowerCase();if("gmail.com"!==n&&"googlemail.com"!==n||(m=m.replace(/\./g,"").toLowerCase()),!a.isByteLength(m,{max:64})||!a.isByteLength(g,{max:256}))return!1;if(!a.isFQDN(g,{require_tld:c.require_tld}))return!1;if('"'===m[0])return m=m.slice(1,m.length-1),c.allow_utf8_local_part?k.test(m):i.test(m);for(var o=c.allow_utf8_local_part?j:h,p=m.split("."),q=0;q<p.length;q++)if(!o.test(p[q]))return!1;return!0};var O={protocols:["http","https","ftp"],require_tld:!0,require_protocol:!1,require_valid_protocol:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_protocol_relative_urls:!1};a.isURL=function(b,c){if(!b||b.length>=2083||/\s/.test(b))return!1;if(0===b.indexOf("mailto:"))return!1;c=e(c,O);var d,f,g,h,i,j,k;if(k=b.split("://"),k.length>1){if(d=k.shift(),c.require_valid_protocol&&-1===c.protocols.indexOf(d))return!1}else{if(c.require_protocol)return!1;c.allow_protocol_relative_urls&&"//"===b.substr(0,2)&&(k[0]=b.substr(2))}return b=k.join("://"),k=b.split("#"),b=k.shift(),k=b.split("?"),b=k.shift(),k=b.split("/"),b=k.shift(),k=b.split("@"),!(k.length>1&&(f=k.shift(),f.indexOf(":")>=0&&f.split(":").length>2))&&(h=k.join("@"),k=h.split(":"),g=k.shift(),!(k.length&&(j=k.join(":"),i=parseInt(j,10),!/^[0-9]+$/.test(j)||i<=0||i>65535))&&(!(!a.isIP(g)&&!a.isFQDN(g,c)&&"localhost"!==g)&&((!c.host_whitelist||-1!==c.host_whitelist.indexOf(g))&&(!c.host_blacklist||-1===c.host_blacklist.indexOf(g)))))},a.isMACAddress=function(a){return q.test(a)},a.isIP=function(b,c){if(!(c=c?c+"":""))return a.isIP(b,4)||a.isIP(b,6);if("4"===c){if(!r.test(b))return!1;return b.split(".").sort(function(a,b){return a-b})[3]<=255}if("6"===c){var d=b.split(":"),e=!1,f=a.isIP(d[d.length-1],4),g=f?7:8;if(d.length>g)return!1;if("::"===b)return!0;"::"===b.substr(0,2)?(d.shift(),d.shift(),e=!0):"::"===b.substr(b.length-2)&&(d.pop(),d.pop(),e=!0);for(var h=0;h<d.length;++h)if(""===d[h]&&h>0&&h<d.length-1){if(e)return!1;e=!0}else if(f&&h==d.length-1);else if(!s.test(d[h]))return!1;return e?d.length>=1:d.length===g}return!1};var P={require_tld:!0,allow_underscores:!1,allow_trailing_dot:!1};a.isFQDN=function(a,b){b=e(b,P),b.allow_trailing_dot&&"."===a[a.length-1]&&(a=a.substring(0,a.length-1));var c=a.split(".");if(b.require_tld){var d=c.pop();if(!c.length||!/^([a-z\u00a1-\uffff]{2,}|xn[a-z0-9-]{2,})$/i.test(d))return!1}for(var f,g=0;g<c.length;g++){if(f=c[g],b.allow_underscores){if(f.indexOf("__")>=0)return!1;f=f.replace(/_/g,"")}if(!/^[a-z\u00a1-\uffff0-9-]+$/i.test(f))return!1;if(/[\uff01-\uff5e]/.test(f))return!1;if("-"===f[0]||"-"===f[f.length-1])return!1}return!0},a.isBoolean=function(a){return["true","false","1","0"].indexOf(a)>=0},a.isAlpha=function(a,b){if((b=b||"en-US")in u)return u[b].test(a);throw new Error("Invalid locale '"+b+"'")},a.isAlphanumeric=function(a,b){if((b=b||"en-US")in v)return v[b].test(a);throw new Error("Invalid locale '"+b+"'")},a.isNumeric=function(a){return y.test(a)},a.isDecimal=function(a){return""!==a&&C.test(a)},a.isHexadecimal=function(a){return B.test(a)},a.isHexColor=function(a){return D.test(a)},a.isLowercase=function(a){return a===a.toLowerCase()},a.isUppercase=function(a){return a===a.toUpperCase()},a.isInt=function(a,b){return b=b||{},z.test(a)&&(!b.hasOwnProperty("min")||a>=b.min)&&(!b.hasOwnProperty("max")||a<=b.max)},a.isFloat=function(a,b){return b=b||{},""!==a&&"."!==a&&(A.test(a)&&(!b.hasOwnProperty("min")||a>=b.min)&&(!b.hasOwnProperty("max")||a<=b.max))},a.isDivisibleBy=function(b,c){return a.toFloat(b)%parseInt(c,10)==0},a.isNull=function(a){return 0===a.length},a.isLength=function(a,b){var c,d;"object"==typeof b?(c=b.min||0,d=b.max):(c=arguments[1],d=arguments[2]);var e=a.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g)||[],f=a.length-e.length;return f>=c&&(void 0===d||f<=d)},a.isByteLength=function(a,b){var c,d;"object"==typeof b?(c=b.min||0,d=b.max):(c=arguments[1],d=arguments[2]);var e=encodeURI(a).split(/%..|./).length-1;return e>=c&&(void 0===d||e<=d)},a.isUUID=function(a,b){var c=t[b||"all"];return c&&c.test(a)},a.isDate=function(a){var b=new Date(Date.parse(a));if(isNaN(b))return!1;var c=d(a);if(null!==c){var e=b.getTimezoneOffset()-c;b=new Date(b.getTime()+6e4*e)}var f,g,h,i=String(b.getDate());return!(g=a.match(/(^|[^:\d])[23]\d([^:\d]|$)/g))||(f=g.map(function(a){return a.match(/\d+/g)[0]}).join("/"),h=String(b.getFullYear()).slice(-2),f===i||f===h||(f===i+"/"+h||f===h+"/"+i))},a.isAfter=function(b,c){var d=a.toDate(c||new Date),e=a.toDate(b);return!!(e&&d&&e>d)},a.isBefore=function(b,c){var d=a.toDate(c||new Date),e=a.toDate(b);return!!(e&&d&&e<d)},a.isIn=function(b,c){var d;if("[object Array]"===Object.prototype.toString.call(c)){var e=[];for(d in c)e[d]=a.toString(c[d]);return e.indexOf(b)>=0}return"object"==typeof c?c.hasOwnProperty(b):!(!c||"function"!=typeof c.indexOf)&&c.indexOf(b)>=0},a.isWhitelisted=function(a,b){for(var c=a.length-1;c>=0;c--)if(-1===b.indexOf(a[c]))return!1;return!0},a.isCreditCard=function(a){var b=a.replace(/[^0-9]+/g,"");if(!m.test(b))return!1;for(var c,d,e,f=0,g=b.length-1;g>=0;g--)c=b.substring(g,g+1),d=parseInt(c,10),e?(d*=2,f+=d>=10?d%10+1:d):f+=d,e=!e;return!(f%10!=0||!b)},a.isISIN=function(a){if(!n.test(a))return!1;for(var b,c,d=a.replace(/[A-Z]/g,function(a){return parseInt(a,36)}),e=0,f=!0,g=d.length-2;g>=0;g--)b=d.substring(g,g+1),c=parseInt(b,10),f?(c*=2,e+=c>=10?c+1:c):e+=c,f=!f;return parseInt(a.substr(a.length-1),10)===(1e4-e)%10},a.isISBN=function(b,c){if(!(c=c?c+"":""))return a.isISBN(b,10)||a.isISBN(b,13);var d,e=b.replace(/[\s-]+/g,""),f=0;if("10"===c){if(!o.test(e))return!1;for(d=0;d<9;d++)f+=(d+1)*e.charAt(d);if("X"===e.charAt(9)?f+=100:f+=10*e.charAt(9),f%11==0)return!!e}else if("13"===c){if(!p.test(e))return!1;var g=[1,3];for(d=0;d<12;d++)f+=g[d%2]*e.charAt(d);if(e.charAt(12)-(10-f%10)%10==0)return!!e}return!1},a.isMobilePhone=function(a,b){return b in K&&K[b].test(a)};var Q={symbol:"$",require_symbol:!1,allow_space_after_symbol:!1,symbol_after_digits:!1,allow_negatives:!0,parens_for_negatives:!1,negative_sign_before_digits:!1,negative_sign_after_digits:!1,allow_negative_sign_placeholder:!1,thousands_separator:",",decimal_separator:".",allow_space_after_digits:!1};a.isCurrency=function(a,b){return b=e(b,Q),f(b).test(a)},a.isJSON=function(a){try{var b=JSON.parse(a);return!!b&&"object"==typeof b}catch(a){}return!1},a.isMultibyte=function(a){return F.test(a)},a.isAscii=function(a){return E.test(a)},a.isFullWidth=function(a){return G.test(a)},a.isHalfWidth=function(a){return H.test(a)},a.isVariableWidth=function(a){return G.test(a)&&H.test(a)},a.isSurrogatePair=function(a){return I.test(a)},a.isBase64=function(a){return J.test(a)},a.isMongoId=function(b){return a.isHexadecimal(b)&&24===b.length},a.isISO8601=function(a){return L.test(a)},a.ltrim=function(a,b){var c=b?new RegExp("^["+b+"]+","g"):/^\s+/g;return a.replace(c,"")},a.rtrim=function(a,b){var c=b?new RegExp("["+b+"]+$","g"):/\s+$/g;return a.replace(c,"")},a.trim=function(a,b){var c=b?new RegExp("^["+b+"]+|["+b+"]+$","g"):/^\s+|\s+$/g;return a.replace(c,"")},a.escape=function(a){return a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#x2F;").replace(/\`/g,"&#96;")},a.stripLow=function(b,c){var d=c?"\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F":"\\x00-\\x1F\\x7F";return a.blacklist(b,d)},a.whitelist=function(a,b){return a.replace(new RegExp("[^"+b+"]+","g"),"")},a.blacklist=function(a,b){return a.replace(new RegExp("["+b+"]+","g"),"")};var R={lowercase:!0,remove_dots:!0,remove_extension:!0};return a.normalizeEmail=function(b,c){if(c=e(c,R),!a.isEmail(b))return!1;var d=b.split("@",2);if(d[1]=d[1].toLowerCase(),"gmail.com"===d[1]||"googlemail.com"===d[1]){if(c.remove_extension&&(d[0]=d[0].split("+")[0]),c.remove_dots&&(d[0]=d[0].replace(/\./g,"")),!d[0].length)return!1;d[0]=d[0].toLowerCase(),d[1]="gmail.com"}else c.lowercase&&(d[0]=d[0].toLowerCase());return d.join("@")},a.init(),a})},{83:83}]},{},[5])(5)});